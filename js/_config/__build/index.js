seajs.config({alias:{backbone:"backbone/0.5.3/backbone-debug",underscore:"underscore/1.2.2/underscore-debug",mu:"mustache/0.4.0/mu",less:"less/1.1.5/less-debug",zepto:"zepto/1.0.0/zepto",iscroll:"iscroll/4.1.9/iscroll-debug",uriBroker:"./../../../../../base/utils/server/uriBroker",cdn:"./../../../../../base/utils/server/cdn"},debug:1}),define("http://a.tbcdn.cn/mw/webapp/fav/online/index.js",["../router/favRouter"],function(require){require("../router/favRouter").START(),console.log("index")});
define("http://a.tbcdn.cn/mw/webapp/fav/router/favRouter.js",["underscore","zepto","backbone","../../../../base/utils/server/mtop_ajax","../module/server/fav_url","../model/goodslistModel","../view/goodslistView","../model/shoplistModel","../view/shoplistView","../model/paramModel","../view/paramView","../model/subparamModel","../view/subparamView","../module/initialize","../module/favScroll","../module/favSwipetop","../module/favlistDel","../module/loadingNormal"],function(require,exports,module){var _=require("underscore"),$=require("zepto"),Backbone=require("backbone"),mtopAjax=require("../../../../base/utils/server/mtop_ajax");return fav_url=require("../module/server/fav_url"),goodslistModel=require("../model/goodslistModel"),goodslistView=require("../view/goodslistView"),shoplistModel=require("../model/shoplistModel"),shoplistView=require("../view/shoplistView"),paramModel=require("../model/paramModel"),paramView=require("../view/paramView"),subparamModel=require("../model/subparamModel"),subparamView=require("../view/subparamView"),baseInit=require("../module/initialize"),favScroll=require("../module/favScroll"),swipeTopSingle=require("../module/favSwipetop"),listdelSingle=require("../module/favlistDel"),loadingNormal=require("../module/loadingNormal"),ROUTER={},ROUTER.Class=Backbone.Router.extend({routes:{"":"goods","!goods":"goods","!shop":"shops"},initialize:function(){var self=this;self.route(/^\!goods\/([^-]+)-([^-]+)(?:-([^-]+))?(?:-([^-]+))?$/,"goods",self.goods),self.route(/^\!shop\/([^-]+)-([^-]+)(?:-([^-]+))?(?:-([^-]+))?$/,"shops",self.shops),console.log("router 初始化 !"),favScroll.set("onScrollEnd",function(){var that=this;if(this.y<=this.maxScrollY){_.isEmpty(shoplistModel)?require.async("../model/shoplistModel",function(s){_.extend(shoplistModel,s)}):shoplistModel,_.isEmpty(goodslistModel)?require.async("../model/goodslistModel",function(s){_.extend(goodslistModel,s)}):goodslistModel;var params=paramModel.Instance.get("param");if(paramModel.Instance.get("nav")=="goods"&&goodslistModel.Instance.hasNextPage||shoplistModel.Instance.hasNextPage)params.currentPage++,paramModel.Instance.trigger("change:param"),console.log(paramModel.Instance)}}),listdelSingle.setClearExOps({postdata:function(){_.isEmpty(shoplistModel)?require.async("../model/shoplistModel",function(s){_.extend(shoplistModel,s)}):shoplistModel,_.isEmpty(goodslistModel)?require.async("../model/goodslistModel",function(s){_.extend(goodslistModel,s)}):goodslistModel;var params=paramModel.Instance.get("param");params.currentPage=1,paramModel.Instance.trigger("change:param")}}),baseInit()},loading:function(){console.log("页面加载中")},goods:function(queryMethod,cat,currentPage,startRow){_.isEmpty(goodslistModel)?require.async("../model/goodslistModel",function(s){_.extend(goodslistModel,s)}):goodslistModel,_.isEmpty(goodslistView)?require.async("../view/goodslistView",function(s){_.extend(goodslistView,s)}):goodslistView;var self=this,param={method:"queryColGood",pageSize:"8",currentPage:"1"},subparam={};param=this.getParam(param,queryMethod,cat,currentPage,startRow),subparam={method:param.method,nav:"goods",href:this.getHref(param)},param._3th=!_.isEmpty(queryMethod),paramModel.Instance.set({myTaobao:fav_url.getCommUrl().my,nav:"goods"}),subparamModel.Instance.set({subparam:subparam}),paramModel.Instance.set({param:param}),loadingNormal.show({target:"#content"}),swipeTopSingle.setClearExOpts({type:"goods",typeDesc:"宝贝分类",allType:cat||null}),listdelSingle.setClearExOps({type:"goods"}),favScroll.get("y")<=0&&swipeTopSingle.topCache.isSlip==1&&(swipeTopSingle.hideTop("noAnimate"),favScroll.scrollTo(0,0))},shops:function(queryMethod,cat,currentPage,startRow){var self=this;_.isEmpty(shoplistModel)?require.async("../model/shoplistModel",function(s){_.extend(shoplistModel,s)}):shoplistModel,_.isEmpty(shoplistView)?require.async("../view/shoplistView",function(s){_.extend(shoplistView,s)}):shoplistView;var param={method:"queryColShop",pageSize:"8",currentPage:"1",goodCount:"6"},subparam={};param=this.getParam(param,queryMethod,cat,currentPage,startRow),subparam={method:param.method,nav:"shop",href:this.getHref(param)},param._3th=!_.isEmpty(queryMethod),paramModel.Instance.set({myTaobao:fav_url.getCommUrl().my,nav:"shop"}),subparamModel.Instance.set({subparam:subparam}),paramModel.Instance.set({param:param}),swipeTopSingle.setClearExOpts({type:"shop",typeDesc:"店铺分类",allType:cat||null}),listdelSingle.setClearExOps({type:"shop"}),loadingNormal.show({target:"#content"}),favScroll.get("y")<=0&&swipeTopSingle.topCache.isSlip==1&&(swipeTopSingle.hideTop("noAnimate"),favScroll.scrollTo(0,0))},getHref:function(param){var href="";return param.cateId&&(href+="-cateId|"+param.cateId),param.tag&&(href+="-tag|"+param.tag),href+="-1",param.startRow&&(href+="-0"),href},getParam:function(param,p1,p2,p3,p4){if(p1&&p2){var mix=p2.split("|"),s=0;console.log("mix",mix);if(mix.length>1){var key=mix[0],value=mix[1];p4?s=p4:s,console.log(s),param={method:p1,pageSize:"8",startRow:s,currentPage:p3,goodCount:"6"},param[key]=value}else p3?s=p3:s,param={method:p1,pageSize:"8",startRow:s,currentPage:p2,goodCount:"6"}}return param}}),ROUTER.Instance=new ROUTER.Class,ROUTER.START=function(){mtopAjax.getFirstToken("1.0",function(res){ROUTER.Instance,Backbone.history.start()},function(res){console.log("FirstToken获取失败："+res)})},ROUTER});
(function(factory){typeof define=="function"?define("#underscore/1.2.2/underscore-debug",[],factory):typeof exports!="undefined"?factory(require,exports,module):factory()})(function(require,exports,module){(function(){function eq(a,b,stack){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(_.isFunction(a.isEqual))return a.isEqual(b);if(_.isFunction(b.isEqual))return b.isEqual(a);var className=toString.call(a);if(className!=toString.call(b))return!1;switch(className){case"[object String]":return String(a)==String(b);case"[object Number]":return a=+a,b=+b,a!=a?b!=b:a==0?1/a==1/b:a==b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;var length=stack.length;while(length--)if(stack[length]==a)return!0;stack.push(a);var size=0,result=!0;if(className=="[object Array]"){size=a.length,result=size==b.length;if(result)while(size--)if(!(result=size in a==size in b&&eq(a[size],b[size],stack)))break}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var key in a)if(hasOwnProperty.call(a,key)){size++;if(!(result=hasOwnProperty.call(b,key)&&eq(a[key],b[key],stack)))break}if(result){for(key in b)if(hasOwnProperty.call(b,key)&&!(size--))break;result=!size}}return stack.pop(),result}var root=this,previousUnderscore=root._,breaker={},ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,slice=ArrayProto.slice,unshift=ArrayProto.unshift,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,_=function(obj){return new wrapper(obj)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=_),exports._=_):typeof define=="function"&&define.amd?define("underscore",function(){return _}):root._=_,_.VERSION="1.2.2";var each=_.each=_.forEach=function(obj,iterator,context){if(obj==null)return;if(nativeForEach&&obj.forEach===nativeForEach)obj.forEach(iterator,context);else if(obj.length===+obj.length){for(var i=0,l=obj.length;i<l;i++)if(i in obj&&iterator.call(context,obj[i],i,obj)===breaker)return}else for(var key in obj)if(hasOwnProperty.call(obj,key)&&iterator.call(context,obj[key],key,obj)===breaker)return};_.map=function(obj,iterator,context){var results=[];return obj==null?results:nativeMap&&obj.map===nativeMap?obj.map(iterator,context):(each(obj,function(value,index,list){results[results.length]=iterator.call(context,value,index,list)}),results)},_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=memo!==void 0;obj==null&&(obj=[]);if(nativeReduce&&obj.reduce===nativeReduce)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduce(iterator,memo):obj.reduce(iterator);each(obj,function(value,index,list){initial?memo=iterator.call(context,memo,value,index,list):(memo=value,initial=!0)});if(!initial)throw new TypeError("Reduce of empty array with no initial value");return memo},_.reduceRight=_.foldr=function(obj,iterator,memo,context){obj==null&&(obj=[]);if(nativeReduceRight&&obj.reduceRight===nativeReduceRight)return context&&(iterator=_.bind(iterator,context)),memo!==void 0?obj.reduceRight(iterator,memo):obj.reduceRight(iterator);var reversed=(_.isArray(obj)?obj.slice():_.toArray(obj)).reverse();return _.reduce(reversed,iterator,memo,context)},_.find=_.detect=function(obj,iterator,context){var result;return any(obj,function(value,index,list){if(iterator.call(context,value,index,list))return result=value,!0}),result},_.filter=_.select=function(obj,iterator,context){var results=[];return obj==null?results:nativeFilter&&obj.filter===nativeFilter?obj.filter(iterator,context):(each(obj,function(value,index,list){iterator.call(context,value,index,list)&&(results[results.length]=value)}),results)},_.reject=function(obj,iterator,context){var results=[];return obj==null?results:(each(obj,function(value,index,list){iterator.call(context,value,index,list)||(results[results.length]=value)}),results)},_.every=_.all=function(obj,iterator,context){var result=!0;return obj==null?result:nativeEvery&&obj.every===nativeEvery?obj.every(iterator,context):(each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list)))return breaker}),result)};var any=_.some=_.any=function(obj,iterator,context){iterator=iterator||_.identity;var result=!1;return obj==null?result:nativeSome&&obj.some===nativeSome?obj.some(iterator,context):(each(obj,function(value,index,list){if(result||(result=iterator.call(context,value,index,list)))return breaker}),!!result)};_.include=_.contains=function(obj,target){var found=!1;return obj==null?found:nativeIndexOf&&obj.indexOf===nativeIndexOf?obj.indexOf(target)!=-1:(found=any(obj,function(value){return value===target}),found)},_.invoke=function(obj,method){var args=slice.call(arguments,2);return _.map(obj,function(value){return(method.call?method||value:value[method]).apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,function(value){return value[key]})},_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj))return Math.max.apply(Math,obj);if(!iterator&&_.isEmpty(obj))return-Infinity;var result={computed:-Infinity};return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>=result.computed&&(result={value:value,computed:computed})}),result.value},_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj))return Math.min.apply(Math,obj);if(!iterator&&_.isEmpty(obj))return Infinity;var result={computed:Infinity};return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed})}),result.value},_.shuffle=function(obj){var shuffled=[],rand;return each(obj,function(value,index,list){index==0?shuffled[0]=value:(rand=Math.floor(Math.random()*(index+1)),shuffled[index]=shuffled[rand],shuffled[rand]=value)}),shuffled},_.sortBy=function(obj,iterator,context){return _.pluck(_.map(obj,function(value,index,list){return{value:value,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0}),"value")},_.groupBy=function(obj,val){var result={},iterator=_.isFunction(val)?val:function(obj){return obj[val]};return each(obj,function(value,index){var key=iterator(value,index);(result[key]||(result[key]=[])).push(value)}),result},_.sortedIndex=function(array,obj,iterator){iterator||(iterator=_.identity);var low=0,high=array.length;while(low<high){var mid=low+high>>1;iterator(array[mid])<iterator(obj)?low=mid+1:high=mid}return low},_.toArray=function(iterable){return iterable?iterable.toArray?iterable.toArray():_.isArray(iterable)?slice.call(iterable):_.isArguments(iterable)?slice.call(iterable):_.values(iterable):[]},_.size=function(obj){return _.toArray(obj).length},_.first=_.head=function(array,n,guard){return n!=null&&!guard?slice.call(array,0,n):array[0]},_.initial=function(array,n,guard){return slice.call(array,0,array.length-(n==null||guard?1:n))},_.last=function(array,n,guard){return n!=null&&!guard?slice.call(array,Math.max(array.length-n,0)):array[array.length-1]},_.rest=_.tail=function(array,index,guard){return slice.call(array,index==null||guard?1:index)},_.compact=function(array){return _.filter(array,function(value){return!!value})},_.flatten=function(array,shallow){return _.reduce(array,function(memo,value){return _.isArray(value)?memo.concat(shallow?value:_.flatten(value)):(memo[memo.length]=value,memo)},[])},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.uniq=_.unique=function(array,isSorted,iterator){var initial=iterator?_.map(array,iterator):array,result=[];return _.reduce(initial,function(memo,el,i){if(0==i||(isSorted===!0?_.last(memo)!=el:!_.include(memo,el)))memo[memo.length]=el,result[result.length]=array[i];return memo},[]),result},_.union=function(){return _.uniq(_.flatten(arguments,!0))},_.intersection=_.intersect=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0})})},_.difference=function(array,other){return _.filter(array,function(value){return!_.include(other,value)})},_.zip=function(){var args=slice.call(arguments),length=_.max(_.pluck(args,"length")),results=new Array(length);for(var i=0;i<length;i++)results[i]=_.pluck(args,""+i);return results},_.indexOf=function(array,item,isSorted){if(array==null)return-1;var i,l;if(isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item);for(i=0,l=array.length;i<l;i++)if(array[i]===item)return i;return-1},_.lastIndexOf=function(array,item){if(array==null)return-1;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf)return array.lastIndexOf(item);var i=array.length;while(i--)if(array[i]===item)return i;return-1},_.range=function(start,stop,step){arguments.length<=1&&(stop=start||0,start=0),step=arguments[2]||1;var len=Math.max(Math.ceil((stop-start)/step),0),idx=0,range=new Array(len);while(idx<len)range[idx++]=start,start+=step;return range};var ctor=function(){};_.bind=function(func,context){var bound,args;if(func.bind===nativeBind&&nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;return args=slice.call(arguments,2),bound=function(){if(this instanceof bound){ctor.prototype=func.prototype;var self=new ctor,result=func.apply(self,args.concat(slice.call(arguments)));return Object(result)===result?result:self}return func.apply(context,args.concat(slice.call(arguments)))}},_.bindAll=function(obj){var funcs=slice.call(arguments,1);return funcs.length==0&&(funcs=_.functions(obj)),each(funcs,function(f){obj[f]=_.bind(obj[f],obj)}),obj},_.memoize=function(func,hasher){var memo={};return hasher||(hasher=_.identity),function(){var key=hasher.apply(this,arguments);return hasOwnProperty.call(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(func,args)},wait)},_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))},_.throttle=function(func,wait){var context,args,timeout,throttling,more,whenDone=_.debounce(function(){more=throttling=!1},wait);return function(){context=this,args=arguments;var later=function(){timeout=null,more&&func.apply(context,args),whenDone()};timeout||(timeout=setTimeout(later,wait)),throttling?more=!0:func.apply(context,args),whenDone(),throttling=!0}},_.debounce=function(func,wait){var timeout;return function(){var context=this,args=arguments,later=function(){timeout=null,func.apply(context,args)};clearTimeout(timeout),timeout=setTimeout(later,wait)}},_.once=function(func){var ran=!1,memo;return function(){return ran?memo:(ran=!0,memo=func.apply(this,arguments))}},_.wrap=function(func,wrapper){return function(){var args=[func].concat(slice.call(arguments));return wrapper.apply(this,args)}},_.compose=function(){var funcs=slice.call(arguments);return function(){var args=slice.call(arguments);for(var i=funcs.length-1;i>=0;i--)args=[funcs[i].apply(this,args)];return args[0]}},_.after=function(times,func){return times<=0?func():function(){if(--times<1)return func.apply(this,arguments)}},_.keys=nativeKeys||function(obj){if(obj!==Object(obj))throw new TypeError("Invalid object");var keys=[];for(var key in obj)hasOwnProperty.call(obj,key)&&(keys[keys.length]=key);return keys},_.values=function(obj){return _.map(obj,_.identity)},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=function(obj){return each(slice.call(arguments,1),function(source){for(var prop in source)source[prop]!==void 0&&(obj[prop]=source[prop])}),obj},_.defaults=function(obj){return each(slice.call(arguments,1),function(source){for(var prop in source)obj[prop]==null&&(obj[prop]=source[prop])}),obj},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj},_.isEqual=function(a,b){return eq(a,b,[])},_.isEmpty=function(obj){if(_.isArray(obj)||_.isString(obj))return obj.length===0;for(var key in obj)if(hasOwnProperty.call(obj,key))return!1;return!0},_.isElement=function(obj){return!!obj&&obj.nodeType==1},_.isArray=nativeIsArray||function(obj){return toString.call(obj)=="[object Array]"},_.isObject=function(obj){return obj===Object(obj)},toString.call(arguments)=="[object Arguments]"?_.isArguments=function(obj){return toString.call(obj)=="[object Arguments]"}:_.isArguments=function(obj){return!!obj&&!!hasOwnProperty.call(obj,"callee")},_.isFunction=function(obj){return toString.call(obj)=="[object Function]"},_.isString=function(obj){return toString.call(obj)=="[object String]"},_.isNumber=function(obj){return toString.call(obj)=="[object Number]"},_.isNaN=function(obj){return obj!==obj},_.isBoolean=function(obj){return obj===!0||obj===!1||toString.call(obj)=="[object Boolean]"},_.isDate=function(obj){return toString.call(obj)=="[object Date]"},_.isRegExp=function(obj){return toString.call(obj)=="[object RegExp]"},_.isNull=function(obj){return obj===null},_.isUndefined=function(obj){return obj===void 0},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.times=function(n,iterator,context){for(var i=0;i<n;i++)iterator.call(context,i)},_.escape=function(string){return(""+string).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},_.mixin=function(obj){each(_.functions(obj),function(name){addToWrapper(name,_[name]=obj[name])})};var idCounter=0;_.uniqueId=function(prefix){var id=idCounter++;return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},_.template=function(str,data){var c=_.templateSettings,tmpl="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+str.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape,function(match,code){return"',_.escape("+code.replace(/\\'/g,"'")+"),'"}).replace(c.interpolate,function(match,code){return"',"+code.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(match,code){return"');"+code.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",func=new Function("obj","_",tmpl);return data?func(data,_):function(data){return func(data,_)}};var wrapper=function(obj){this._wrapped=obj};_.prototype=wrapper.prototype;var result=function(obj,chain){return chain?_(obj).chain():obj},addToWrapper=function(name,func){wrapper.prototype[name]=function(){var args=slice.call(arguments);return unshift.call(args,this._wrapped),result(func.apply(_,args),this._chain)}};_.mixin(_),each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];wrapper.prototype[name]=function(){return method.apply(this._wrapped,arguments),result(this._wrapped,this._chain)}}),each(["concat","join","slice"],function(name){var method=ArrayProto[name];wrapper.prototype[name]=function(){return result(method.apply(this._wrapped,arguments),this._chain)}}),wrapper.prototype.chain=function(){return this._chain=!0,this},wrapper.prototype.value=function(){return this._wrapped}}).call(this)});
(function(a){typeof define=="function"?define("#zepto/1.0.0/zepto",[],a):a(null,window)})(function(require,exports){(function(undefined){String.prototype.trim===undefined&&(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),Array.prototype.reduce===undefined&&(Array.prototype.reduce=function(fun){if(this===void 0||this===null)throw new TypeError;var t=Object(this),len=t.length>>>0,k=0,accumulator;if(typeof fun!="function")throw new TypeError;if(len==0&&arguments.length==1)throw new TypeError;if(arguments.length>=2)accumulator=arguments[1];else do{if(k in t){accumulator=t[k++];break}if(++k>=len)throw new TypeError}while(!0);while(k<len)k in t&&(accumulator=fun.call(undefined,accumulator,t[k],k,t)),k++;return accumulator})})();var Zepto=function(){function isFunction(value){return toString.call(value)=="[object Function]"}function isObject(value){return value instanceof Object}function isPlainObject(value){var key,ctor;if(toString.call(value)!=="[object Object]")return!1;ctor=isFunction(value.constructor)&&value.constructor.prototype;if(!ctor||!hasOwnProperty.call(ctor,"isPrototypeOf"))return!1;for(key in value);return key===undefined||hasOwnProperty.call(value,key)}function isArray(value){return value instanceof Array}function likeArray(obj){return typeof obj.length=="number"}function compact(array){return array.filter(function(item){return item!==undefined&&item!==null})}function flatten(array){return array.length>0?[].concat.apply([],array):array}function dasherize(str){return str.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function classRE(name){return name in classCache?classCache[name]:classCache[name]=new RegExp("(^|\\s)"+name+"(\\s|$)")}function maybeAddPx(name,value){return typeof value=="number"&&!cssNumber[dasherize(name)]?value+"px":value}function defaultDisplay(nodeName){var element,display;return elementDisplay[nodeName]||(element=document.createElement(nodeName),document.body.appendChild(element),display=getComputedStyle(element,"").getPropertyValue("display"),element.parentNode.removeChild(element),display=="none"&&(display="block"),elementDisplay[nodeName]=display),elementDisplay[nodeName]}function filtered(nodes,selector){return selector===undefined?$(nodes):$(nodes).filter(selector)}function funcArg(context,arg,idx,payload){return isFunction(arg)?arg.call(context,idx,payload):arg}function insert(operator,target,node){var parent=operator%2?target:target.parentNode;parent?parent.insertBefore(node,operator?operator==1?parent.firstChild:operator==2?target:null:target.nextSibling):$(node).remove()}function traverseNode(node,fun){fun(node);for(var key in node.childNodes)traverseNode(node.childNodes[key],fun)}var undefined,key,$,classList,emptyArray=[],slice=emptyArray.slice,document=window.document,elementDisplay={},classCache={},getComputedStyle=document.defaultView.getComputedStyle,cssNumber={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},fragmentRE=/^\s*<(\w+|!)[^>]*>/,elementTypes=[1,3,8,9,11],adjacencyOperators=["after","prepend","before","append"],table=document.createElement("table"),tableRow=document.createElement("tr"),containers={tr:document.createElement("tbody"),tbody:table,thead:table,tfoot:table,td:tableRow,th:tableRow,"*":document.createElement("div")},readyRE=/complete|loaded|interactive/,classSelectorRE=/^\.([\w-]+)$/,idSelectorRE=/^#([\w-]+)$/,tagSelectorRE=/^[\w-]+$/,toString={}.toString,zepto={},camelize,uniq,tempParent=document.createElement("div");return zepto.matches=function(element,selector){if(!element||element.nodeType!==1)return!1;var matchesSelector=element.webkitMatchesSelector||element.mozMatchesSelector||element.oMatchesSelector||element.matchesSelector;if(matchesSelector)return matchesSelector.call(element,selector);var match,parent=element.parentNode,temp=!parent;return temp&&(parent=tempParent).appendChild(element),match=~zepto.qsa(parent,selector).indexOf(element),temp&&tempParent.removeChild(element),match},camelize=function(str){return str.replace(/-+(.)?/g,function(match,chr){return chr?chr.toUpperCase():""})},uniq=function(array){return array.filter(function(item,idx){return array.indexOf(item)==idx})},zepto.fragment=function(html,name){name===undefined&&(name=fragmentRE.test(html)&&RegExp.$1),name in containers||(name="*");var container=containers[name];return container.innerHTML=""+html,$.each(slice.call(container.childNodes),function(){container.removeChild(this)})},zepto.Z=function(dom,selector){return dom=dom||[],dom.__proto__=arguments.callee.prototype,dom.selector=selector||"",dom},zepto.isZ=function(object){return object instanceof zepto.Z},zepto.init=function(selector,context){if(!selector)return zepto.Z();if(isFunction(selector))return $(document).ready(selector);if(zepto.isZ(selector))return selector;var dom;if(isArray(selector))dom=compact(selector);else if(isPlainObject(selector))dom=[$.extend({},selector)],selector=null;else if(elementTypes.indexOf(selector.nodeType)>=0||selector===window)dom=[selector],selector=null;else if(fragmentRE.test(selector))dom=zepto.fragment(selector.trim(),RegExp.$1),selector=null;else{if(context!==undefined)return $(context).find(selector);dom=zepto.qsa(document,selector)}return zepto.Z(dom,selector)},$=function(selector,context){return zepto.init(selector,context)},$.extend=function(target){return slice.call(arguments,1).forEach(function(source){for(key in source)source[key]!==undefined&&(target[key]=source[key])}),target},zepto.qsa=function(element,selector){var found;return element===document&&idSelectorRE.test(selector)?(found=element.getElementById(RegExp.$1))?[found]:emptyArray:element.nodeType!==1&&element.nodeType!==9?emptyArray:slice.call(classSelectorRE.test(selector)?element.getElementsByClassName(RegExp.$1):tagSelectorRE.test(selector)?element.getElementsByTagName(selector):element.querySelectorAll(selector))},$.isFunction=isFunction,$.isObject=isObject,$.isArray=isArray,$.isPlainObject=isPlainObject,$.inArray=function(elem,array,i){return emptyArray.indexOf.call(array,elem,i)},$.trim=function(str){return str.trim()},$.uuid=0,$.map=function(elements,callback){var value,values=[],i,key;if(likeArray(elements))for(i=0;i<elements.length;i++)value=callback(elements[i],i),value!=null&&values.push(value);else for(key in elements)value=callback(elements[key],key),value!=null&&values.push(value);return flatten(values)},$.each=function(elements,callback){var i,key;if(likeArray(elements)){for(i=0;i<elements.length;i++)if(callback.call(elements[i],i,elements[i])===!1)return elements}else for(key in elements)if(callback.call(elements[key],key,elements[key])===!1)return elements;return elements},$.fn={forEach:emptyArray.forEach,reduce:emptyArray.reduce,push:emptyArray.push,indexOf:emptyArray.indexOf,concat:emptyArray.concat,map:function(fn){return $.map(this,function(el,i){return fn.call(el,i,el)})},slice:function(){return $(slice.apply(this,arguments))},ready:function(callback){return readyRE.test(document.readyState)?callback($):document.addEventListener("DOMContentLoaded",function(){callback($)},!1),this},get:function(idx){return idx===undefined?slice.call(this):this[idx]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){this.parentNode!=null&&this.parentNode.removeChild(this)})},each:function(callback){return this.forEach(function(el,idx){callback.call(el,idx,el)}),this},filter:function(selector){return $([].filter.call(this,function(element){return zepto.matches(element,selector)}))},add:function(selector,context){return $(uniq(this.concat($(selector,context))))},is:function(selector){return this.length>0&&zepto.matches(this[0],selector)},not:function(selector){var nodes=[];if(isFunction(selector)&&selector.call!==undefined)this.each(function(idx){selector.call(this,idx)||nodes.push(this)});else{var excludes=typeof selector=="string"?this.filter(selector):likeArray(selector)&&isFunction(selector.item)?slice.call(selector):$(selector);this.forEach(function(el){excludes.indexOf(el)<0&&nodes.push(el)})}return $(nodes)},eq:function(idx){return idx===-1?this.slice(idx):this.slice(idx,+idx+1)},first:function(){var el=this[0];return el&&!isObject(el)?el:$(el)},last:function(){var el=this[this.length-1];return el&&!isObject(el)?el:$(el)},find:function(selector){var result;return this.length==1?result=zepto.qsa(this[0],selector):result=this.map(function(){return zepto.qsa(this,selector)}),$(result)},closest:function(selector,context){var node=this[0];while(node&&!zepto.matches(node,selector))node=node!==context&&node!==document&&node.parentNode;return $(node)},parents:function(selector){var ancestors=[],nodes=this;while(nodes.length>0)nodes=$.map(nodes,function(node){if((node=node.parentNode)&&node!==document&&ancestors.indexOf(node)<0)return ancestors.push(node),node});return filtered(ancestors,selector)},parent:function(selector){return filtered(uniq(this.pluck("parentNode")),selector)},children:function(selector){return filtered(this.map(function(){return slice.call(this.children)}),selector)},siblings:function(selector){return filtered(this.map(function(i,el){return slice.call(el.parentNode.children).filter(function(child){return child!==el})}),selector)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(property){return this.map(function(){return this[property]})},show:function(){return this.each(function(){this.style.display=="none"&&(this.style.display=null),getComputedStyle(this,"").getPropertyValue("display")=="none"&&(this.style.display=defaultDisplay(this.nodeName))})},replaceWith:function(newContent){return this.before(newContent).remove()},wrap:function(newContent){return this.each(function(){$(this).wrapAll($(newContent)[0].cloneNode(!1))})},wrapAll:function(newContent){return this[0]&&($(this[0]).before(newContent=$(newContent)),newContent.append(this)),this},unwrap:function(){return this.parent().each(function(){$(this).replaceWith($(this).children())}),this},clone:function(){return $(this.map(function(){return this.cloneNode(!0)}))},hide:function(){return this.css("display","none")},toggle:function(setting){return(setting===undefined?this.css("display")=="none":setting)?this.show():this.hide()},prev:function(){return $(this.pluck("previousElementSibling"))},next:function(){return $(this.pluck("nextElementSibling"))},html:function(html){return html===undefined?this.length>0?this[0].innerHTML:null:this.each(function(idx){var originHtml=this.innerHTML;$(this).empty().append(funcArg(this,html,idx,originHtml))})},text:function(text){return text===undefined?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=text})},attr:function(name,value){var result;return typeof name=="string"&&value===undefined?this.length==0||this[0].nodeType!==1?undefined:name=="value"&&this[0].nodeName=="INPUT"?this.val():!(result=this[0].getAttribute(name))&&name in this[0]?this[0][name]:result:this.each(function(idx){if(this.nodeType!==1)return;if(isObject(name))for(key in name)this.setAttribute(key,name[key]);else this.setAttribute(name,funcArg(this,value,idx,this.getAttribute(name)))})},removeAttr:function(name){return this.each(function(){this.nodeType===1&&this.removeAttribute(name)})},prop:function(name,value){return value===undefined?this[0]?this[0][name]:undefined:this.each(function(idx){this[name]=funcArg(this,value,idx,this[name])})},data:function(name,value){var data=this.attr("data-"+dasherize(name),value);return data!==null?data:undefined},val:function(value){return value===undefined?this.length>0?this[0].value:undefined:this.each(function(idx){this.value=funcArg(this,value,idx,this.value)})},offset:function(){if(this.length==0)return null;var obj=this[0].getBoundingClientRect();return{left:obj.left+window.pageXOffset,top:obj.top+window.pageYOffset,width:obj.width,height:obj.height}},css:function(property,value){if(value===undefined&&typeof property=="string")return this.length==0?undefined:this[0].style[camelize(property)]||getComputedStyle(this[0],"").getPropertyValue(property);var css="";for(key in property)typeof property[key]=="string"&&property[key]==""?this.each(function(){this.style.removeProperty(dasherize(key))}):css+=dasherize(key)+":"+maybeAddPx(key,property[key])+";";return typeof property=="string"&&(value==""?this.each(function(){this.style.removeProperty(dasherize(property))}):css=dasherize(property)+":"+maybeAddPx(property,value)),this.each(function(){this.style.cssText+=";"+css})},index:function(element){return element?this.indexOf($(element)[0]):this.parent().children().indexOf(this[0])},hasClass:function(name){return this.length<1?!1:classRE(name).test(this[0].className)},addClass:function(name){return this.each(function(idx){classList=[];var cls=this.className,newName=funcArg(this,name,idx,cls);newName.split(/\s+/g).forEach(function(klass){$(this).hasClass(klass)||classList.push(klass)},this),classList.length&&(this.className+=(cls?" ":"")+classList.join(" "))})},removeClass:function(name){return this.each(function(idx){if(name===undefined)return this.className="";classList=this.className,funcArg(this,name,idx,classList).split(/\s+/g).forEach(function(klass){classList=classList.replace(classRE(klass)," ")}),this.className=classList.trim()})},toggleClass:function(name,when){return this.each(function(idx){var newName=funcArg(this,name,idx,this.className);(when===undefined?!$(this).hasClass(newName):when)?$(this).addClass(newName):$(this).removeClass(newName)})}},["width","height"].forEach(function(dimension){$.fn[dimension]=function(value){var offset,Dimension=dimension.replace(/./,function(m){return m[0].toUpperCase()});return value===undefined?this[0]==window?window["inner"+Dimension]:this[0]==document?document.documentElement["offset"+Dimension]:(offset=this.offset())&&offset[dimension]:this.each(function(idx){var el=$(this);el.css(dimension,funcArg(this,value,idx,el[dimension]()))})}}),adjacencyOperators.forEach(function(key,operator){$.fn[key]=function(){var nodes=$.map(arguments,function(n){return isObject(n)?n:zepto.fragment(n)});if(nodes.length<1)return this;var size=this.length,copyByClone=size>1,inReverse=operator<2;return this.each(function(index,target){for(var i=0;i<nodes.length;i++){var node=nodes[inReverse?nodes.length-i-1:i];traverseNode(node,function(node){node.nodeName!=null&&node.nodeName.toUpperCase()==="SCRIPT"&&(!node.type||node.type==="text/javascript")&&window.eval.call(window,node.innerHTML)}),copyByClone&&index<size-1&&(node=node.cloneNode(!0)),insert(operator,target,node)}})},$.fn[operator%2?key+"To":"insert"+(operator?"Before":"After")]=function(html){return $(html)[key](this),this}}),zepto.Z.prototype=$.fn,zepto.camelize=camelize,zepto.uniq=uniq,$.zepto=zepto,$}();return exports.Zepto=Zepto,"$"in exports||(exports.$=Zepto),function($){function zid(element){return element._zid||(element._zid=_zid++)}function findHandlers(element,event,fn,selector){event=parse(event);if(event.ns)var matcher=matcherFor(event.ns);return(handlers[zid(element)]||[]).filter(function(handler){return handler&&(!event.e||handler.e==event.e)&&(!event.ns||matcher.test(handler.ns))&&(!fn||zid(handler.fn)===zid(fn))&&(!selector||handler.sel==selector)})}function parse(event){var parts=(""+event).split(".");return{e:parts[0],ns:parts.slice(1).sort().join(" ")}}function matcherFor(ns){return new RegExp("(?:^| )"+ns.replace(" "," .* ?")+"(?: |$)")}function eachEvent(events,fn,iterator){$.isObject(events)?$.each(events,iterator):events.split(/\s/).forEach(function(type){iterator(type,fn)})}function add(element,events,fn,selector,getDelegate,capture){capture=!!capture;var id=zid(element),set=handlers[id]||(handlers[id]=[]);eachEvent(events,fn,function(event,fn){var delegate=getDelegate&&getDelegate(fn,event),callback=delegate||fn,proxyfn=function(event){var result=callback.apply(element,[event].concat(event.data));return result===!1&&event.preventDefault(),result},handler=$.extend(parse(event),{fn:fn,proxy:proxyfn,sel:selector,del:delegate,i:set.length});set.push(handler),element.addEventListener(handler.e,proxyfn,capture)})}function remove(element,events,fn,selector){var id=zid(element);eachEvent(events||"",fn,function(event,fn){findHandlers(element,event,fn,selector).forEach(function(handler){delete handlers[id][handler.i],element.removeEventListener(handler.e,handler.proxy,!1)})})}function createProxy(event){var proxy=$.extend({originalEvent:event},event);return $.each(eventMethods,function(name,predicate){proxy[name]=function(){return this[predicate]=returnTrue,event[name].apply(event,arguments)},proxy[predicate]=returnFalse}),proxy}function fix(event){if(!("defaultPrevented"in event)){event.defaultPrevented=!1;var prevent=event.preventDefault;event.preventDefault=function(){this.defaultPrevented=!0,prevent.call(this)}}}var $$=$.zepto.qsa,handlers={},_zid=1,specialEvents={};specialEvents.click=specialEvents.mousedown=specialEvents.mouseup=specialEvents.mousemove="MouseEvents",$.event={add:add,remove:remove},$.proxy=function(fn,context){if($.isFunction(fn)){var proxyFn=function(){return fn.apply(context,arguments)};return proxyFn._zid=zid(fn),proxyFn}if(typeof context=="string")return $.proxy(fn[context],fn);throw new TypeError("expected function")},$.fn.bind=function(event,callback){return this.each(function(){add(this,event,callback)})},$.fn.unbind=function(event,callback){return this.each(function(){remove(this,event,callback)})},$.fn.one=function(event,callback){return this.each(function(i,element){add(this,event,callback,null,function(fn,type){return function(){var result=fn.apply(element,arguments);return remove(element,type,fn),result}})})};var returnTrue=function(){return!0},returnFalse=function(){return!1},eventMethods={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};$.fn.delegate=function(selector,event,callback){var capture=!1;if(event=="blur"||event=="focus")$.iswebkit?event=event=="blur"?"focusout":event=="focus"?"focusin":event:capture=!0;return this.each(function(i,element){add(element,event,callback,selector,function(fn){return function(e){var evt,match=$(e.target).closest(selector,element).get(0);if(match)return evt=$.extend(createProxy(e),{currentTarget:match,liveFired:element}),fn.apply(match,[evt].concat([].slice.call(arguments,1)))}},capture)})},$.fn.undelegate=function(selector,event,callback){return this.each(function(){remove(this,event,callback,selector)})},$.fn.live=function(event,callback){return $(document.body).delegate(this.selector,event,callback),this},$.fn.die=function(event,callback){return $(document.body).undelegate(this.selector,event,callback),this},$.fn.on=function(event,selector,callback){return selector==undefined||$.isFunction(selector)?this.bind(event,selector):this.delegate(selector,event,callback)},$.fn.off=function(event,selector,callback){return selector==undefined||$.isFunction(selector)?this.unbind(event,selector):this.undelegate(selector,event,callback)},$.fn.trigger=function(event,data){return typeof event=="string"&&(event=$.Event(event)),fix(event),event.data=data,this.each(function(){"dispatchEvent"in this&&this.dispatchEvent(event)})},$.fn.triggerHandler=function(event,data){var e,result;return this.each(function(i,element){e=createProxy(typeof event=="string"?$.Event(event):event),e.data=data,e.target=element,$.each(findHandlers(element,event.type||event),function(i,handler){result=handler.proxy(e);if(e.isImmediatePropagationStopped())return!1})}),result},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout change select keydown keypress keyup error".split(" ").forEach(function(event){$.fn[event]=function(callback){return this.bind(event,callback)}}),["focus","blur"].forEach(function(name){$.fn[name]=function(callback){if(callback)this.bind(name,callback);else if(this.length)try{this.get(0)[name]()}catch(e){}return this}}),$.Event=function(type,props){var event=document.createEvent(specialEvents[type]||"Events"),bubbles=!0;if(props)for(var name in props)name=="bubbles"?bubbles=!!props[name]:event[name]=props[name];return event.initEvent(type,bubbles,!0,null,null,null,null,null,null,null,null,null,null,null,null),event}}(Zepto),function($){function detect(ua){var os=this.os={},browser=this.browser={},webkit=ua.match(/WebKit\/([\d.]+)/),android=ua.match(/(Android)\s+([\d.]+)/),ipad=ua.match(/(iPad).*OS\s([\d_]+)/),iphone=!ipad&&ua.match(/(iPhone\sOS)\s([\d_]+)/),webos=ua.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),touchpad=webos&&ua.match(/TouchPad/),kindle=ua.match(/Kindle\/([\d.]+)/),silk=ua.match(/Silk\/([\d._]+)/),blackberry=ua.match(/(BlackBerry).*Version\/([\d.]+)/);if(browser.webkit=!!webkit)browser.version=webkit[1];android&&(os.android=!0,os.version=android[2]),iphone&&(os.ios=os.iphone=!0,os.version=iphone[2].replace(/_/g,".")),ipad&&(os.ios=os.ipad=!0,os.version=ipad[2].replace(/_/g,".")),webos&&(os.webos=!0,os.version=webos[2]),touchpad&&(os.touchpad=!0),blackberry&&(os.blackberry=!0,os.version=blackberry[2]),kindle&&(os.kindle=!0,os.version=kindle[1]),silk&&(browser.silk=!0,browser.version=silk[1]),!silk&&os.android&&ua.match(/Kindle Fire/)&&(browser.silk=!0)}detect.call($,navigator.userAgent),$.__detect=detect}(Zepto),function($,undefined){function downcase(str){return str.toLowerCase()}function normalizeEvent(name){return eventPrefix?eventPrefix+name:downcase(name)}var prefix="",eventPrefix,endEventName,endAnimationName,vendors={Webkit:"webkit",Moz:"",O:"o",ms:"MS"},document=window.document,testEl=document.createElement("div"),supportedTransforms=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,clearProperties={};$.each(vendors,function(vendor,event){if(testEl.style[vendor+"TransitionProperty"]!==undefined)return prefix="-"+downcase(vendor)+"-",eventPrefix=event,!1}),clearProperties[prefix+"transition-property"]=clearProperties[prefix+"transition-duration"]=clearProperties[prefix+"transition-timing-function"]=clearProperties[prefix+"animation-name"]=clearProperties[prefix+"animation-duration"]="",$.fx={off:eventPrefix===undefined&&testEl.style.transitionProperty===undefined,cssPrefix:prefix,transitionEnd:normalizeEvent("TransitionEnd"),animationEnd:normalizeEvent("AnimationEnd")},$.fn.animate=function(properties,duration,ease,callback){return $.isObject(duration)&&(ease=duration.easing,callback=duration.complete,duration=duration.duration),duration&&(duration/=1e3),this.anim(properties,duration,ease,callback)},$.fn.anim=function(properties,duration,ease,callback){var transforms,cssProperties={},key,that=this,wrappedCallback,endEvent=$.fx.transitionEnd;duration===undefined&&(duration=.4),$.fx.off&&(duration=0);if(typeof properties=="string")cssProperties[prefix+"animation-name"]=properties,cssProperties[prefix+"animation-duration"]=duration+"s",endEvent=$.fx.animationEnd;else{for(key in properties)supportedTransforms.test(key)?(transforms||(transforms=[]),transforms.push(key+"("+properties[key]+")")):cssProperties[key]=properties[key];transforms&&(cssProperties[prefix+"transform"]=transforms.join(" ")),!$.fx.off&&typeof properties=="object"&&(cssProperties[prefix+"transition-property"]=Object.keys(properties).join(", "),cssProperties[prefix+"transition-duration"]=duration+"s",cssProperties[prefix+"transition-timing-function"]=ease||"linear")}return wrappedCallback=function(event){if(typeof event!="undefined"){if(event.target!==event.currentTarget)return;$(event.target).unbind(endEvent,arguments.callee)}$(this).css(clearProperties),callback&&callback.call(this)},duration>0&&this.bind(endEvent,wrappedCallback),setTimeout(function(){that.css(cssProperties),duration<=0&&setTimeout(function(){that.each(function(){wrappedCallback.call(this)})},0)},0),this},testEl=null}(Zepto),function($){function triggerAndReturn(context,eventName,data){var event=$.Event(eventName);return $(context).trigger(event,data),!event.defaultPrevented}function triggerGlobal(settings,context,eventName,data){if(settings.global)return triggerAndReturn(context||document,eventName,data)}function ajaxStart(settings){settings.global&&$.active++===0&&triggerGlobal(settings,null,"ajaxStart")}function ajaxStop(settings){settings.global&&!--$.active&&triggerGlobal(settings,null,"ajaxStop")}function ajaxBeforeSend(xhr,settings){var context=settings.context;if(settings.beforeSend.call(context,xhr,settings)===!1||triggerGlobal(settings,context,"ajaxBeforeSend",[xhr,settings])===!1)return!1;triggerGlobal(settings,context,"ajaxSend",[xhr,settings])}function ajaxSuccess(data,xhr,settings){var context=settings.context,status="success";settings.success.call(context,data,status,xhr),triggerGlobal(settings,context,"ajaxSuccess",[xhr,settings,data]),ajaxComplete(status,xhr,settings)}function ajaxError(error,type,xhr,settings){var context=settings.context;settings.error.call(context,xhr,type,error),triggerGlobal(settings,context,"ajaxError",[xhr,settings,error]),ajaxComplete(type,xhr,settings)}function ajaxComplete(status,xhr,settings){var context=settings.context;settings.complete.call(context,xhr,status),triggerGlobal(settings,context,"ajaxComplete",[xhr,settings]),ajaxStop(settings)}function empty(){}function mimeToDataType(mime){return mime&&(mime==htmlType?"html":mime==jsonType?"json":scriptTypeRE.test(mime)?"script":xmlTypeRE.test(mime)&&"xml")||"text"}function appendQuery(url,query){return(url+"&"+query).replace(/[&?]{1,2}/,"?")}function serializeData(options){isObject(options.data)&&(options.data=$.param(options.data)),options.data&&(!options.type||options.type.toUpperCase()=="GET")&&(options.url=appendQuery(options.url,options.data))}function serialize(params,obj,traditional,scope){var array=$.isArray(obj);$.each(obj,function(key,value){scope&&(key=traditional?scope:scope+"["+(array?"":key)+"]"),!scope&&array?params.add(value.name,value.value):(traditional?$.isArray(value):isObject(value))?serialize(params,value,traditional,key):params.add(key,value)})}var jsonpID=0,isObject=$.isObject,document=window.document,key,name,rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,scriptTypeRE=/^(?:text|application)\/javascript/i,xmlTypeRE=/^(?:text|application)\/xml/i,jsonType="application/json",htmlType="text/html",blankRE=/^\s*$/;$.active=0,$.ajaxJSONP=function(options){var callbackName="jsonp"+ ++jsonpID,script=document.createElement("script"),abort=function(){$(script).remove(),callbackName in window&&(window[callbackName]=empty),ajaxComplete("abort",xhr,options)},xhr={abort:abort},abortTimeout;return options.error&&(script.onerror=function(){xhr.abort(),options.error()}),window[callbackName]=function(data){clearTimeout(abortTimeout),$(script).remove(),delete window[callbackName],ajaxSuccess(data,xhr,options)},serializeData(options),script.src=options.url.replace(/=\?/,"="+callbackName),$("head").append(script),options.timeout>0&&(abortTimeout=setTimeout(function(){xhr.abort(),ajaxComplete("timeout",xhr,options)},options.timeout)),xhr},$.ajaxSettings={type:"GET",beforeSend:empty,success:empty,error:empty,complete:empty,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:jsonType,xml:"application/xml, text/xml",html:htmlType,text:"text/plain"},crossDomain:!1,timeout:0},$.ajax=function(options){var settings=$.extend({},options||{});for(key in $.ajaxSettings)settings[key]===undefined&&(settings[key]=$.ajaxSettings[key]);ajaxStart(settings),settings.crossDomain||(settings.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(settings.url)&&RegExp.$2!=window.location.host);var dataType=settings.dataType,hasPlaceholder=/=\?/.test(settings.url);if(dataType=="jsonp"||hasPlaceholder)return hasPlaceholder||(settings.url=appendQuery(settings.url,"callback=?")),$.ajaxJSONP(settings);settings.url||(settings.url=window.location.toString()),serializeData(settings);var mime=settings.accepts[dataType],baseHeaders={},protocol=/^([\w-]+:)\/\//.test(settings.url)?RegExp.$1:window.location.protocol,xhr=$.ajaxSettings.xhr(),abortTimeout;settings.crossDomain||(baseHeaders["X-Requested-With"]="XMLHttpRequest"),mime&&(baseHeaders.Accept=mime,mime.indexOf(",")>-1&&(mime=mime.split(",",2)[0]),xhr.overrideMimeType&&xhr.overrideMimeType(mime));if(settings.contentType||settings.data&&settings.type.toUpperCase()!="GET")baseHeaders["Content-Type"]=settings.contentType||"application/x-www-form-urlencoded";settings.headers=$.extend(baseHeaders,settings.headers||{}),xhr.onreadystatechange=function(){if(xhr.readyState==4){clearTimeout(abortTimeout);var result,error=!1;if(xhr.status>=200&&xhr.status<300||xhr.status==304||xhr.status==0&&protocol=="file:"){dataType=dataType||mimeToDataType(xhr.getResponseHeader("content-type")),result=xhr.responseText;try{dataType=="script"?(1,eval)(result):dataType=="xml"?result=xhr.responseXML:dataType=="json"&&(result=blankRE.test(result)?null:JSON.parse(result))}catch(e){error=e}error?ajaxError(error,"parsererror",xhr,settings):ajaxSuccess(result,xhr,settings)}else ajaxError(null,"error",xhr,settings)}};var async="async"in settings?settings.async:!0;xhr.open(settings.type,settings.url,async);for(name in settings.headers)xhr.setRequestHeader(name,settings.headers[name]);return ajaxBeforeSend(xhr,settings)===!1?(xhr.abort(),!1):(settings.timeout>0&&(abortTimeout=setTimeout(function(){xhr.onreadystatechange=empty,xhr.abort(),ajaxError(null,"timeout",xhr,settings)},settings.timeout)),xhr.send(settings.data?settings.data:null),xhr)},$.get=function(url,success){return $.ajax({url:url,success:success})},$.post=function(url,data,success,dataType){return $.isFunction(data)&&(dataType=dataType||success,success=data,data=null),$.ajax({type:"POST",url:url,data:data,success:success,dataType:dataType})},$.getJSON=function(url,success){return $.ajax({url:url,success:success,dataType:"json"})},$.fn.load=function(url,success){if(!this.length)return this;var self=this,parts=url.split(/\s/),selector;return parts.length>1&&(url=parts[0],selector=parts[1]),$.get(url,function(response){self.html(selector?$(document.createElement("div")).html(response.replace(rscript,"")).find(selector).html():response),success&&success.call(self)}),this};var escape=encodeURIComponent;$.param=function(obj,traditional){var params=[];return params.add=function(k,v){this.push(escape(k)+"="+escape(v))},serialize(params,obj,traditional),params.join("&").replace("%20","+")}}(Zepto),function($){$.fn.serializeArray=function(){var result=[],el;return $(Array.prototype.slice.call(this.get(0).elements)).each(function(){el=$(this);var type=el.attr("type");this.nodeName.toLowerCase()!="fieldset"&&!this.disabled&&type!="submit"&&type!="reset"&&type!="button"&&(type!="radio"&&type!="checkbox"||this.checked)&&result.push({name:el.attr("name"),value:el.val()})}),result},$.fn.serialize=function(){var result=[];return this.serializeArray().forEach(function(elm){result.push(encodeURIComponent(elm.name)+"="+encodeURIComponent(elm.value))}),result.join("&")},$.fn.submit=function(callback){if(callback)this.bind("submit",callback);else if(this.length){var event=$.Event("submit");this.eq(0).trigger(event),event.defaultPrevented||this.get(0).submit()}return this}}(Zepto),function($){function parentIfText(node){return"tagName"in node?node:node.parentNode}function swipeDirection(x1,x2,y1,y2){var xDelta=Math.abs(x1-x2),yDelta=Math.abs(y1-y2);return xDelta>=yDelta?x1-x2>0?"Left":"Right":y1-y2>0?"Up":"Down"}function longTap(){longTapTimeout=null,touch.last&&(touch.el.trigger("longTap"),touch={})}function cancelLongTap(){longTapTimeout&&clearTimeout(longTapTimeout),longTapTimeout=null}var touch={},touchTimeout,longTapDelay=750,longTapTimeout;$(document).ready(function(){var now,delta;$(document.body).bind("touchstart",function(e){now=Date.now(),delta=now-(touch.last||now),touch.el=$(parentIfText(e.touches[0].target)),touchTimeout&&clearTimeout(touchTimeout),touch.x1=e.touches[0].pageX,touch.y1=e.touches[0].pageY,delta>0&&delta<=250&&(touch.isDoubleTap=!0),touch.last=now,longTapTimeout=setTimeout(longTap,longTapDelay)}).bind("touchmove",function(e){cancelLongTap(),touch.x2=e.touches[0].pageX,touch.y2=e.touches[0].pageY}).bind("touchend",function(e){cancelLongTap(),touch.isDoubleTap?(touch.el.trigger("doubleTap"),touch={}):touch.x2&&Math.abs(touch.x1-touch.x2)>30||touch.y2&&Math.abs(touch.y1-touch.y2)>30?(touch.el.trigger("swipe")&&touch.el.trigger("swipe"+swipeDirection(touch.x1,touch.x2,touch.y1,touch.y2)),touch={}):"last"in touch&&(touch.el.trigger("tap"),touchTimeout=setTimeout(function(){touchTimeout=null,touch.el.trigger("singleTap"),touch={}},250))}).bind("touchcancel",function(){touchTimeout&&clearTimeout(touchTimeout),longTapTimeout&&clearTimeout(longTapTimeout),longTapTimeout=touchTimeout=null,touch={}})}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(m){$.fn[m]=function(callback){return this.bind(m,callback)}})}(Zepto),Zepto});
(function(factory){typeof define=="function"?define("#backbone/0.5.3/backbone-debug",["underscore","zepto"],factory):typeof exports!="undefined"?factory(require,exports):factory()})(function(require,exports){var previousUnderscore=this._,previousZepto=this.Zepto;this._=require("underscore"),this.Zepto=require("zepto"),function(){var root=this,previousBackbone=root.Backbone,Backbone;typeof exports!="undefined"?Backbone=exports:Backbone=root.Backbone={},Backbone.VERSION="0.5.3";var _=root._;!_&&typeof require!="undefined"&&(_=require("underscore")._);var $=root.jQuery||root.Zepto;Backbone.noConflict=function(){return root.Backbone=previousBackbone,this},Backbone.emulateHTTP=!1,Backbone.emulateJSON=!1,Backbone.Events={bind:function(ev,callback,context){var calls=this._callbacks||(this._callbacks={}),list=calls[ev]||(calls[ev]=[]);return list.push([callback,context]),this},unbind:function(ev,callback){var calls;if(!ev)this._callbacks={};else if(calls=this._callbacks)if(!callback)calls[ev]=[];else{var list=calls[ev];if(!list)return this;for(var i=0,l=list.length;i<l;i++)if(list[i]&&callback===list[i][0]){list[i]=null;break}}return this},trigger:function(eventName){var list,calls,ev,callback,args,both=2;if(!(calls=this._callbacks))return this;while(both--){ev=both?eventName:"all";if(list=calls[ev])for(var i=0,l=list.length;i<l;i++)(callback=list[i])?(args=both?Array.prototype.slice.call(arguments,1):arguments,callback[0].apply(callback[1]||this,args)):(list.splice(i,1),i--,l--)}return this}},Backbone.Model=function(attributes,options){var defaults;attributes||(attributes={});if(defaults=this.defaults)_.isFunction(defaults)&&(defaults=defaults.call(this)),attributes=_.extend({},defaults,attributes);this.attributes={},this._escapedAttributes={},this.cid=_.uniqueId("c"),this.set(attributes,{silent:!0}),this._changed=!1,this._previousAttributes=_.clone(this.attributes),options&&options.collection&&(this.collection=options.collection),this.initialize(attributes,options)},_.extend(Backbone.Model.prototype,Backbone.Events,{_previousAttributes:null,_changed:!1,idAttribute:"id",initialize:function(){},toJSON:function(){return _.clone(this.attributes)},get:function(attr){return this.attributes[attr]},escape:function(attr){var html;if(html=this._escapedAttributes[attr])return html;var val=this.attributes[attr];return this._escapedAttributes[attr]=escapeHTML(val==null?"":""+val)},has:function(attr){return this.attributes[attr]!=null},set:function(attrs,options){options||(options={});if(!attrs)return this;attrs.attributes&&(attrs=attrs.attributes);var now=this.attributes,escaped=this._escapedAttributes;if(!options.silent&&this.validate&&!this._performValidation(attrs,options))return!1;this.idAttribute in attrs&&(this.id=attrs[this.idAttribute]);var alreadyChanging=this._changing;this._changing=!0;for(var attr in attrs){var val=attrs[attr];_.isEqual(now[attr],val)||(now[attr]=val,delete escaped[attr],this._changed=!0,options.silent||this.trigger("change:"+attr,this,val,options))}return!alreadyChanging&&!options.silent&&this._changed&&this.change(options),this._changing=!1,this},unset:function(attr,options){if(attr in this.attributes){options||(options={});var value=this.attributes[attr],validObj={};return validObj[attr]=void 0,!options.silent&&this.validate&&!this._performValidation(validObj,options)?!1:(delete this.attributes[attr],delete this._escapedAttributes[attr],attr==this.idAttribute&&delete this.id,this._changed=!0,options.silent||(this.trigger("change:"+attr,this,void 0,options),this.change(options)),this)}return this},clear:function(options){options||(options={});var attr,old=this.attributes,validObj={};for(attr in old)validObj[attr]=void 0;if(!options.silent&&this.validate&&!this._performValidation(validObj,options))return!1;this.attributes={},this._escapedAttributes={},this._changed=!0;if(!options.silent){for(attr in old)this.trigger("change:"+attr,this,void 0,options);this.change(options)}return this},fetch:function(options){options||(options={});var model=this,success=options.success;return options.success=function(resp,status,xhr){if(!model.set(model.parse(resp,xhr),options))return!1;success&&success(model,resp)},options.error=wrapError(options.error,model,options),(this.sync||Backbone.sync).call(this,"read",this,options)},save:function(attrs,options){options||(options={});if(attrs&&!this.set(attrs,options))return!1;var model=this,success=options.success;options.success=function(resp,status,xhr){if(!model.set(model.parse(resp,xhr),options))return!1;success&&success(model,resp,xhr)},options.error=wrapError(options.error,model,options);var method=this.isNew()?"create":"update";return(this.sync||Backbone.sync).call(this,method,this,options)},destroy:function(options){options||(options={});if(this.isNew())return this.trigger("destroy",this,this.collection,options);var model=this,success=options.success;return options.success=function(resp){model.trigger("destroy",model,model.collection,options),success&&success(model,resp)},options.error=wrapError(options.error,model,options),(this.sync||Backbone.sync).call(this,"delete",this,options)},url:function(){var base=getUrl(this.collection)||this.urlRoot||urlError();return this.isNew()?base:base+(base.charAt(base.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(resp,xhr){return resp},clone:function(){return new this.constructor(this)},isNew:function(){return this.id==null},change:function(options){this.trigger("change",this,options),this._previousAttributes=_.clone(this.attributes),this._changed=!1},hasChanged:function(attr){return attr?this._previousAttributes[attr]!=this.attributes[attr]:this._changed},changedAttributes:function(now){now||(now=this.attributes);var old=this._previousAttributes,changed=!1;for(var attr in now)_.isEqual(old[attr],now[attr])||(changed=changed||{},changed[attr]=now[attr]);return changed},previous:function(attr){return!attr||!this._previousAttributes?null:this._previousAttributes[attr]},previousAttributes:function(){return _.clone(this._previousAttributes)},_performValidation:function(attrs,options){var error=this.validate(attrs);return error?(options.error?options.error(this,error,options):this.trigger("error",this,error,options),!1):!0}}),Backbone.Collection=function(models,options){options||(options={}),options.comparator&&(this.comparator=options.comparator),_.bindAll(this,"_onModelEvent","_removeReference"),this._reset(),models&&this.reset(models,{silent:!0}),this.initialize.apply(this,arguments)},_.extend(Backbone.Collection.prototype,Backbone.Events,{model:Backbone.Model,initialize:function(){},toJSON:function(){return this.map(function(model){return model.toJSON()})},add:function(models,options){if(_.isArray(models))for(var i=0,l=models.length;i<l;i++)this._add(models[i],options);else this._add(models,options);return this},remove:function(models,options){if(_.isArray(models))for(var i=0,l=models.length;i<l;i++)this._remove(models[i],options);else this._remove(models,options);return this},get:function(id){return id==null?null:this._byId[id.id!=null?id.id:id]},getByCid:function(cid){return cid&&this._byCid[cid.cid||cid]},at:function(index){return this.models[index]},sort:function(options){options||(options={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return this.models=this.sortBy(this.comparator),options.silent||this.trigger("reset",this,options),this},pluck:function(attr){return _.map(this.models,function(model){return model.get(attr)})},reset:function(models,options){return models||(models=[]),options||(options={}),this.each(this._removeReference),this._reset(),this.add(models,{silent:!0}),options.silent||this.trigger("reset",this,options),this},fetch:function(options){options||(options={});var collection=this,success=options.success;return options.success=function(resp,status,xhr){collection[options.add?"add":"reset"](collection.parse(resp,xhr),options),success&&success(collection,resp)},options.error=wrapError(options.error,collection,options),(this.sync||Backbone.sync).call(this,"read",this,options)},create:function(model,options){var coll=this;options||(options={}),model=this._prepareModel(model,options);if(!model)return!1;var success=options.success;return options.success=function(nextModel,resp,xhr){coll.add(nextModel,options),success&&success(nextModel,resp,xhr)},model.save(null,options),model},parse:function(resp,xhr){return resp},chain:function(){return _(this.models).chain()},_reset:function(options){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(model,options){if(model instanceof Backbone.Model)model.collection||(model.collection=this);else{var attrs=model;model=new this.model(attrs,{collection:this}),model.validate&&!model._performValidation(attrs,options)&&(model=!1)}return model},_add:function(model,options){options||(options={}),model=this._prepareModel(model,options);if(!model)return!1;var already=this.getByCid(model);if(already)throw new Error(["Can't add the same model to a set twice",already.id]);this._byId[model.id]=model,this._byCid[model.cid]=model;var index=options.at!=null?options.at:this.comparator?this.sortedIndex(model,this.comparator):this.length;return this.models.splice(index,0,model),model.bind("all",this._onModelEvent),this.length++,options.silent||model.trigger("add",model,this,options),model},_remove:function(model,options){return options||(options={}),model=this.getByCid(model)||this.get(model),model?(delete this._byId[model.id],delete this._byCid[model.cid],this.models.splice(this.indexOf(model),1),this.length--,options.silent||model.trigger("remove",model,this,options),this._removeReference(model),model):null},_removeReference:function(model){this==model.collection&&delete model.collection,model.unbind("all",this._onModelEvent)},_onModelEvent:function(ev,model,collection,options){if((ev=="add"||ev=="remove")&&collection!=this)return;ev=="destroy"&&this._remove(model,options),model&&ev==="change:"+model.idAttribute&&(delete this._byId[model.previous(model.idAttribute)],this._byId[model.id]=model),this.trigger.apply(this,arguments)}});var methods=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty","groupBy"];_.each(methods,function(method){Backbone.Collection.prototype[method]=function(){return _[method].apply(_,[this.models].concat(_.toArray(arguments)))}}),Backbone.Router=function(options){options||(options={}),options.routes&&(this.routes=options.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};var namedParam=/:([\w\d]+)/g,splatParam=/\*([\w\d]+)/g,escapeRegExp=/[-[\]{}()+?.,\\^$|#\s]/g;_.extend(Backbone.Router.prototype,Backbone.Events,{initialize:function(){},route:function(route,name,callback){Backbone.history||(Backbone.history=new Backbone.History),_.isRegExp(route)||(route=this._routeToRegExp(route)),Backbone.history.route(route,_.bind(function(fragment){var args=this._extractParameters(route,fragment);callback.apply(this,args),this.trigger.apply(this,["route:"+name].concat(args))},this))},navigate:function(fragment,triggerRoute){Backbone.history.navigate(fragment,triggerRoute)},_bindRoutes:function(){if(!this.routes)return;var routes=[];for(var route in this.routes)routes.unshift([route,this.routes[route]]);for(var i=0,l=routes.length;i<l;i++)this.route(routes[i][0],routes[i][1],this[routes[i][1]])},_routeToRegExp:function(route){return route=route.replace(escapeRegExp,"\\$&").replace(namedParam,"([^/]*)").replace(splatParam,"(.*?)"),new RegExp("^"+route+"$")},_extractParameters:function(route,fragment){return route.exec(fragment).slice(1)}}),Backbone.History=function(){this.handlers=[],_.bindAll(this,"checkUrl")};var hashStrip=/^#*/,isExplorer=/msie [\w.]+/,historyStarted=!1;_.extend(Backbone.History.prototype,{interval:50,getFragment:function(fragment,forcePushState){if(fragment==null)if(this._hasPushState||forcePushState){fragment=window.location.pathname;var search=window.location.search;search&&(fragment+=search),fragment.indexOf(this.options.root)==0&&(fragment=fragment.substr(this.options.root.length))}else fragment=window.location.hash;return decodeURIComponent(fragment.replace(hashStrip,""))},start:function(options){if(historyStarted)throw new Error("Backbone.history has already been started");this.options=_.extend({},{root:"/"},this.options,options),this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var fragment=this.getFragment(),docMode=document.documentMode,oldIE=isExplorer.exec(navigator.userAgent.toLowerCase())&&(!docMode||docMode<=7);oldIE&&(this.iframe=$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(fragment)),this._hasPushState?$(window).bind("popstate",this.checkUrl):"onhashchange"in window&&!oldIE?$(window).bind("hashchange",this.checkUrl):setInterval(this.checkUrl,this.interval),this.fragment=fragment,historyStarted=!0;var loc=window.location,atRoot=loc.pathname==this.options.root;if(this._wantsPushState&&!this._hasPushState&&!atRoot)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&atRoot&&loc.hash&&(this.fragment=loc.hash.replace(hashStrip,""),window.history.replaceState({},document.title,loc.protocol+"//"+loc.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},route:function(route,callback){this.handlers.unshift({route:route,callback:callback})},checkUrl:function(e){var current=this.getFragment();current==this.fragment&&this.iframe&&(current=this.getFragment(this.iframe.location.hash));if(current==this.fragment||current==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(current),this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(fragmentOverride){var fragment=this.fragment=this.getFragment(fragmentOverride),matched=_.any(this.handlers,function(handler){if(handler.route.test(fragment))return handler.callback(fragment),!0});return matched},navigate:function(fragment,triggerRoute){var frag=(fragment||"").replace(hashStrip,"");if(this.fragment==frag||this.fragment==decodeURIComponent(frag))return;if(this._hasPushState){var loc=window.location;frag.indexOf(this.options.root)!=0&&(frag=this.options.root+frag),this.fragment=frag,window.history.pushState({},document.title,loc.protocol+"//"+loc.host+frag)}else window.location.hash=this.fragment=frag,this.iframe&&frag!=this.getFragment(this.iframe.location.hash)&&(this.iframe.document.open().close(),this.iframe.location.hash=frag);triggerRoute&&this.loadUrl(fragment)}}),Backbone.View=function(options){this.cid=_.uniqueId("view"),this._configure(options||{}),this._ensureElement(),this.delegateEvents(),this.initialize.apply(this,arguments)};var selectorDelegate=function(selector){return $(selector,this.el)},eventSplitter=/^(\S+)\s*(.*)$/,viewOptions=["model","collection","el","id","attributes","className","tagName"];_.extend(Backbone.View.prototype,Backbone.Events,{tagName:"div",$:selectorDelegate,initialize:function(){},render:function(){return this},remove:function(){return $(this.el).remove(),this},make:function(tagName,attributes,content){var el=document.createElement(tagName);return attributes&&$(el).attr(attributes),content&&$(el).html(content),el},delegateEvents:function(events){if(!events&&!(events=this.events))return;_.isFunction(events)&&(events=events.call(this)),$(this.el).unbind(".delegateEvents"+this.cid);for(var key in events){var method=this[events[key]];if(!method)throw new Error('Event "'+events[key]+'" does not exist');var match=key.match(eventSplitter),eventName=match[1],selector=match[2];method=_.bind(method,this),eventName+=".delegateEvents"+this.cid,selector===""?$(this.el).bind(eventName,method):$(this.el).delegate(selector,eventName,method)}},_configure:function(options){this.options&&(options=_.extend({},this.options,options));for(var i=0,l=viewOptions.length;i<l;i++){var attr=viewOptions[i];options[attr]&&(this[attr]=options[attr])}this.options=options},_ensureElement:function(){if(!this.el){var attrs=this.attributes||{};this.id&&(attrs.id=this.id),this.className&&(attrs["class"]=this.className),this.el=this.make(this.tagName,attrs)}else _.isString(this.el)&&(this.el=$(this.el).get(0))}});var extend=function(protoProps,classProps){var child=inherits(this,protoProps,classProps);return child.extend=this.extend,child};Backbone.Model.extend=Backbone.Collection.extend=Backbone.Router.extend=Backbone.View.extend=extend;var methodMap={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};Backbone.sync=function(method,model,options){var type=methodMap[method],params=_.extend({type:type,dataType:"json"},options);return params.url||(params.url=getUrl(model)||urlError()),!params.data&&model&&(method=="create"||method=="update")&&(params.contentType="application/json",params.data=JSON.stringify(model.toJSON())),Backbone.emulateJSON&&(params.contentType="application/x-www-form-urlencoded",params.data=params.data?{model:params.data}:{}),Backbone.emulateHTTP&&(type==="PUT"||type==="DELETE")&&(Backbone.emulateJSON&&(params.data._method=type),params.type="POST",params.beforeSend=function(xhr){xhr.setRequestHeader("X-HTTP-Method-Override",type)}),params.type!=="GET"&&!Backbone.emulateJSON&&(params.processData=!1),$.ajax(params)};var ctor=function(){},inherits=function(parent,protoProps,staticProps){var child;return protoProps&&protoProps.hasOwnProperty("constructor")?child=protoProps.constructor:child=function(){return parent.apply(this,arguments)},_.extend(child,parent),ctor.prototype=parent.prototype,child.prototype=new ctor,protoProps&&_.extend(child.prototype,protoProps),staticProps&&_.extend(child,staticProps),child.prototype.constructor=child,child.__super__=parent.prototype,child},getUrl=function(object){return!object||!object.url?null:_.isFunction(object.url)?object.url():object.url},urlError=function(){throw new Error('A "url" property or function must be specified')},wrapError=function(onError,model,options){return function(resp){onError?onError(model,resp,options):model.trigger("error",model,resp,options)}},escapeHTML=function(string){return string.replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}}.call(this),this._=previousUnderscore,this.Zepto=previousZepto});
define("http://a.tbcdn.cn/base/utils/server/mtop_ajax.js",["zepto","./h5_base","./config","./uri"],function(require,exports,module){var $=require("zepto"),tbh5=require("./h5_base"),config=require("./config"),uri=require("./uri"),app_key=tbh5.get(tbh5.appKey),apiType="h5Api.do";exports.getFirstToken=function(v,successback,errorback){var extParam={};extParam.api="mtop.auth.h5.getFirstToken2",extParam.v=v||"1.0",extParam.appKey=app_key,extParam.t=(new Date).getTime(),console.log("getFirstToken");var firstTokenUrl=_addJsonParam(uri.renderURI(uri.createURI("api"),apiType,extParam,"rest"));if(-1==firstTokenUrl.indexOf("/rest/"+apiType)){console.log("use api v2. No need first token.",firstTokenUrl);return}if(!app_key){console.log("no app_key for first token.");return}var errTimeKey="fst_token_err_time",errTime=parseInt(tbh5.get(errTimeKey)||"0");if(errTime>=3){_toErrorPage();return}firstTokenUrl=_removeSid(firstTokenUrl),$.ajax({type:"GET",url:firstTokenUrl,success:function(result){var ret=(result.ret?result.ret:"").toString();-1!=ret.indexOf("SUCCESS::")&&(_saveNewToken(result),tbh5.set(errTimeKey,0),console.log("getFirstToken success.")),successback&&successback(result)},error:function(error){console.log("getFirstToken ajax error.");if(!errorback){tbh5.set(errTimeKey,errTime+1),window.location.href=tbh5.get(tbh5.targetUrl)||"http://m.taobao.com";return}errorback(error)}})},exports.getApi=function(api,v,data,extParam,callback,errorback){if(tbh5.checkIsBlank(api)){errorback&&errorback({ret:["PARAM_ILLEGAL::API_NULL"]});return}extParam.api=api,extParam.v=v||"*",extParam.data=JSON.stringify(data);var updateTokenUrl=uri.renderURI(uri.createURI("api"),apiType,extParam,"rest");return exports.get(updateTokenUrl,data,callback,errorback)},exports.get=function(url,data,callback,errorback){if(tbh5.checkIsBlank(url)){errorback&&errorback({ret:["PARAM_ILLEGAL::URL_NULL"]});return}var defaultParams=JSON.parse(tbh5.get(tbh5.userInfoKey)||"{}")||{},sid=defaultParams.sid;if(-1==url.indexOf("/rest/"+apiType)){console.log("use api v2.",url),_send(!1,!0,url,"no_app_key","no_app_token",data,sid,callback,errorback);return}console.log("use api v5.");var app_token=tbh5.get(tbh5.appToken),app_token_expired=tbh5.get(tbh5.appTokenExpired)||0,app_token_between=tbh5.get(tbh5.appTokenBetween)||0,app_token_ready=!1;if(tbh5.checkIsBlank(app_token)||tbh5.checkIsBlank(app_key)){console.log("no app_token or app_key",app_token,app_key),_toErrorPage();return}var currentTime=(new Date).getTime()-app_token_between,needUpdate=!1;currentTime>=app_token_expired?needUpdate=!0:app_token_expired-currentTime<1e4&&(needUpdate=!0),needUpdate?_updateToken(url,app_key,data,sid,callback,errorback):_send(!0,!0,url,app_key,app_token,data,sid,callback,errorback)};var _send=function(isApi5,app_token_ready,url,app_key,app_token,data,sid,callback,errorback){if(!app_token_ready){_toErrorPage();return}url=_createSignUrl(url,app_key,app_token,data,sid),isApi5&&(url=_removeSid(url)),console.log("use token send : "+app_token);if(tbh5.checkIsBlank(url)){_toErrorPage();return}$.ajax({type:"GET",url:url,success:function(result){var ret=(result.ret?result.ret:"").toString();if(-1!=ret.indexOf("TOKEN_EXOIRED::")){_toErrorPage();return}-1!=ret.indexOf("SUCCESS::")&&tbh5.set(tbh5.appRequestFailed,0),callback&&callback(result)},error:function(error){errorback&&errorback(error)}})},_removeSid=function(url){return url=_replaceAll(url,"&sid","&_nsid"),url},_replaceAll=function(src,AFindText,ARepText){return raRegExp=new RegExp(AFindText,"g"),src.replace(raRegExp,ARepText)},_createSignUrl=function(url,app_key,app_token,data,sid){var t=(new Date).getTime();return _addJsonParam(url)+"&appKey="+app_key+"&sign="+_sign(app_key,app_token,t,data)+"&t="+t+"&sid="+sid},_addJsonParam=function(url){if(-1==url.indexOf("callback=")){var index=url.indexOf("?");return url.substr(0,index)+"?callback=?&type=jsonp&"+url.substr(index+1,url.length)}return url},_sign=function(app_key,app_token,t,data){var signTemp=app_token+"&"+t+"&"+app_key+"&"+JSON.stringify(data);return MD5(signTemp)},_updateToken=function(url,app_key,data,sid,callback,errorback){var refreshToken=tbh5.get(tbh5.appRefreshToken);console.log("use rf_token refresh token : "+refreshToken);if(tbh5.checkIsBlank(refreshToken)){_toErrorPage();return}var queryParam={t:(new Date).getTime(),api:"mtop.auth.h5.getNextToken2",v:"1.0",appKey:app_key,data:JSON.stringify({refreshToken:refreshToken})},updateTokenUrl=_addJsonParam(uri.renderURI(uri.createURI("api"),apiType,queryParam,"rest"));$.ajax({type:"GET",url:updateTokenUrl,success:function(result){if(!result.ret||-1==result.ret.toString().indexOf("SUCCESS")){_toErrorPage();return}var newToken=_saveNewToken(result);newToken&&_send(!0,!0,url,app_key,newToken,data,sid,callback,errorback)},error:function(error){_toErrorPage();return}});return},_saveNewToken=function(r){var newToken=r.data.token.token,newTokenExpired=parseInt(r.data.token.createTime||"0")+parseInt(r.data.token.lifetime||"0")*1e3,newTokenCreate=parseInt(r.data.token.createTime||"0"),refreToken=r.data.token.refreshToken,currentTime=(new Date).getTime(),newTokenBetween=tbh5.getBetweenTime(newTokenCreate);if(!(!tbh5.checkIsBlank(newToken)&&newTokenExpired>currentTime-newTokenBetween))return null;try{tbh5.set(tbh5.appToken,newToken),tbh5.set(tbh5.appRefreshToken,refreToken),tbh5.set(tbh5.appTokenExpired,newTokenExpired),tbh5.set(tbh5.appTokenBetween,newTokenBetween);if(tbh5.get(tbh5.appToken)==newToken)return newToken}catch(e){return null}},_toErrorPage=function(){window.location.href=config.errorPage||"http://m.taobao.com"},_toIndexPage=function(){window.location.href=config.indexPage||"http://m.taobao.com"},MD5=function(string){function RotateLeft(lValue,iShiftBits){return lValue<<iShiftBits|lValue>>>32-iShiftBits}function AddUnsigned(lX,lY){var lX4,lY4,lX8,lY8,lResult;return lX8=lX&2147483648,lY8=lY&2147483648,lX4=lX&1073741824,lY4=lY&1073741824,lResult=(lX&1073741823)+(lY&1073741823),lX4&lY4?lResult^2147483648^lX8^lY8:lX4|lY4?lResult&1073741824?lResult^3221225472^lX8^lY8:lResult^1073741824^lX8^lY8:lResult^lX8^lY8}function F(x,y,z){return x&y|~x&z}function G(x,y,z){return x&z|y&~z}function H(x,y,z){return x^y^z}function I(x,y,z){return y^(x|~z)}function FF(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(F(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function GG(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(G(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function HH(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(H(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function II(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(I(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function ConvertToWordArray(string){var lWordCount,lMessageLength=string.length,lNumberOfWords_temp1=lMessageLength+8,lNumberOfWords_temp2=(lNumberOfWords_temp1-lNumberOfWords_temp1%64)/64,lNumberOfWords=(lNumberOfWords_temp2+1)*16,lWordArray=Array(lNumberOfWords-1),lBytePosition=0,lByteCount=0;while(lByteCount<lMessageLength)lWordCount=(lByteCount-lByteCount%4)/4,lBytePosition=lByteCount%4*8,lWordArray[lWordCount]=lWordArray[lWordCount]|string.charCodeAt(lByteCount)<<lBytePosition,lByteCount++;return lWordCount=(lByteCount-lByteCount%4)/4,lBytePosition=lByteCount%4*8,lWordArray[lWordCount]=lWordArray[lWordCount]|128<<lBytePosition,lWordArray[lNumberOfWords-2]=lMessageLength<<3,lWordArray[lNumberOfWords-1]=lMessageLength>>>29,lWordArray}function WordToHex(lValue){var WordToHexValue="",WordToHexValue_temp="",lByte,lCount;for(lCount=0;lCount<=3;lCount++)lByte=lValue>>>lCount*8&255,WordToHexValue_temp="0"+lByte.toString(16),WordToHexValue+=WordToHexValue_temp.substr(WordToHexValue_temp.length-2,2);return WordToHexValue}function Utf8Encode(string){string=string.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);c<128?utftext+=String.fromCharCode(c):c>127&&c<2048?(utftext+=String.fromCharCode(c>>6|192),utftext+=String.fromCharCode(c&63|128)):(utftext+=String.fromCharCode(c>>12|224),utftext+=String.fromCharCode(c>>6&63|128),utftext+=String.fromCharCode(c&63|128))}return utftext}var x=Array(),k,AA,BB,CC,DD,a,b,c,d,S11=7,S12=12,S13=17,S14=22,S21=5,S22=9,S23=14,S24=20,S31=4,S32=11,S33=16,S34=23,S41=6,S42=10,S43=15,S44=21;string=Utf8Encode(string),x=ConvertToWordArray(string),a=1732584193,b=4023233417,c=2562383102,d=271733878;for(k=0;k<x.length;k+=16)AA=a,BB=b,CC=c,DD=d,a=FF(a,b,c,d,x[k+0],S11,3614090360),d=FF(d,a,b,c,x[k+1],S12,3905402710),c=FF(c,d,a,b,x[k+2],S13,606105819),b=FF(b,c,d,a,x[k+3],S14,3250441966),a=FF(a,b,c,d,x[k+4],S11,4118548399),d=FF(d,a,b,c,x[k+5],S12,1200080426),c=FF(c,d,a,b,x[k+6],S13,2821735955),b=FF(b,c,d,a,x[k+7],S14,4249261313),a=FF(a,b,c,d,x[k+8],S11,1770035416),d=FF(d,a,b,c,x[k+9],S12,2336552879),c=FF(c,d,a,b,x[k+10],S13,4294925233),b=FF(b,c,d,a,x[k+11],S14,2304563134),a=FF(a,b,c,d,x[k+12],S11,1804603682),d=FF(d,a,b,c,x[k+13],S12,4254626195),c=FF(c,d,a,b,x[k+14],S13,2792965006),b=FF(b,c,d,a,x[k+15],S14,1236535329),a=GG(a,b,c,d,x[k+1],S21,4129170786),d=GG(d,a,b,c,x[k+6],S22,3225465664),c=GG(c,d,a,b,x[k+11],S23,643717713),b=GG(b,c,d,a,x[k+0],S24,3921069994),a=GG(a,b,c,d,x[k+5],S21,3593408605),d=GG(d,a,b,c,x[k+10],S22,38016083),c=GG(c,d,a,b,x[k+15],S23,3634488961),b=GG(b,c,d,a,x[k+4],S24,3889429448),a=GG(a,b,c,d,x[k+9],S21,568446438),d=GG(d,a,b,c,x[k+14],S22,3275163606),c=GG(c,d,a,b,x[k+3],S23,4107603335),b=GG(b,c,d,a,x[k+8],S24,1163531501),a=GG(a,b,c,d,x[k+13],S21,2850285829),d=GG(d,a,b,c,x[k+2],S22,4243563512),c=GG(c,d,a,b,x[k+7],S23,1735328473),b=GG(b,c,d,a,x[k+12],S24,2368359562),a=HH(a,b,c,d,x[k+5],S31,4294588738),d=HH(d,a,b,c,x[k+8],S32,2272392833),c=HH(c,d,a,b,x[k+11],S33,1839030562),b=HH(b,c,d,a,x[k+14],S34,4259657740),a=HH(a,b,c,d,x[k+1],S31,2763975236),d=HH(d,a,b,c,x[k+4],S32,1272893353),c=HH(c,d,a,b,x[k+7],S33,4139469664),b=HH(b,c,d,a,x[k+10],S34,3200236656),a=HH(a,b,c,d,x[k+13],S31,681279174),d=HH(d,a,b,c,x[k+0],S32,3936430074),c=HH(c,d,a,b,x[k+3],S33,3572445317),b=HH(b,c,d,a,x[k+6],S34,76029189),a=HH(a,b,c,d,x[k+9],S31,3654602809),d=HH(d,a,b,c,x[k+12],S32,3873151461),c=HH(c,d,a,b,x[k+15],S33,530742520),b=HH(b,c,d,a,x[k+2],S34,3299628645),a=II(a,b,c,d,x[k+0],S41,4096336452),d=II(d,a,b,c,x[k+7],S42,1126891415),c=II(c,d,a,b,x[k+14],S43,2878612391),b=II(b,c,d,a,x[k+5],S44,4237533241),a=II(a,b,c,d,x[k+12],S41,1700485571),d=II(d,a,b,c,x[k+3],S42,2399980690),c=II(c,d,a,b,x[k+10],S43,4293915773),b=II(b,c,d,a,x[k+1],S44,2240044497),a=II(a,b,c,d,x[k+8],S41,1873313359),d=II(d,a,b,c,x[k+15],S42,4264355552),c=II(c,d,a,b,x[k+6],S43,2734768916),b=II(b,c,d,a,x[k+13],S44,1309151649),a=II(a,b,c,d,x[k+4],S41,4149444226),d=II(d,a,b,c,x[k+11],S42,3174756917),c=II(c,d,a,b,x[k+2],S43,718787259),b=II(b,c,d,a,x[k+9],S44,3951481745),a=AddUnsigned(a,AA),b=AddUnsigned(b,BB),c=AddUnsigned(c,CC),d=AddUnsigned(d,DD);var temp=WordToHex(a)+WordToHex(b)+WordToHex(c)+WordToHex(d);return temp.toLowerCase()}});
define("http://a.tbcdn.cn/base/utils/server/h5_base.js",["underscore"],function(require,exports,module){var _=require("underscore");exports.paramKey="paramKey",exports.targetUrl="targetUrl",exports.userInfoKey="userInfoKey",exports.hrefHash="hrefHashKey",exports.appKey="app_key",exports.appToken="app_token",exports.appRefreshToken="app_ref_token",exports.appTokenExpired="app_token_expired",exports.appTokenBetween="app_token_between",exports.appRequestFailed="app_request_failed_tag",exports.useLocalstorage=useLocalstorage=window.localStorage!=null,exports.set=function(key,value){return useLocalstorage?(typeof value!="string"&&(value=JSON.stringify(value)),window.localStorage.setItem(key,value),!0):!1},exports.add=function(key,value){if(useLocalstorage){if(typeof value=="string")value=JSON.parse(value);else{try{_.extend(value,JSON.parse(getValue(key)))}catch(e){console.log(e)}value=JSON.stringify(value)}return window.localStorage.setItem(key,value),!0}return!1},exports.get=getValue=function(key){return useLocalstorage?window.localStorage.getItem(key):null},exports.clearAll=function(){if(useLocalstorage)return window.localStorage.clear()},exports.getParamFromStorage=function(key){try{return JSON.parse(this.get(this.paramKey))[key]}catch(ex){}return null},exports.getUserProFromStorage=function(pro){try{return JSON.parse(this.get(this.userInfoKey))[pro]}catch(ex){}return null},exports.getBetweenTime=function(currentSeverTime){return(new Date).getTime()-currentSeverTime},exports.checkIsBlank=function(s){return null==s||""==s},exports.isLogin=function(){var nick=this.getUserProFromStorage("nick");return nick==""||nick==null?!1:!0}});
define("http://a.tbcdn.cn/base/utils/server/config.js",[],function(require,exports,module){var _checkSysType="m";window.location.host=="localhost"||window.location.host.match(".*\\.waptest\\.(taobao|tmall|etao|alibaba|alipay|aliyun)\\.com.*")?_checkSysType="waptest":window.location.host.match(".*\\.wapa\\.(taobao|tmall|etao|alibaba|alipay|aliyun)\\.com.*")&&(_checkSysType="wapa"),exports.sysType="wapa",exports.indexPage="http://fav."+exports.sysType+".taobao.com/h5proxy-fav.htm",exports.errorPage="http://fav."+exports.sysType+".taobao.com/fav_error.htm"});
define("http://a.tbcdn.cn/base/utils/server/uri.js",["zepto","./config","./h5_base"],function(require,exports,module){function _render(url){if(null!=exports.ttQueryStr&&""!=exports.ttQueryStr){var m=url.match("\\.[a-zA-Z]+\\?");null!=m&&0<m.length?url.indexOf("?")==url.length-1?url+=exports.ttQueryStr:url=url+"&"+exports.ttQueryStr:url=url+"?"+exports.ttQueryStr}return url}function buildUrl(base,target,param,folder){_checkIsBlank(folder)||(base+="/"+folder),_checkIsBlank(target)||(base+="/"+target);var havParam=!1;if(null!=param)for(var k in param)if(null!=param[k]){havParam=!0;break}return havParam&&(base+="?"+_getJsonStr(param)),base}function _checkDomain(domain){if(_checkIsBlank(domain))return!1;for(var i=0;i<_domainWhiteList.length;i++)if(_domainWhiteList[i].toLowerCase()==domain.toLowerCase())return!0;return!1}function _checkIsBlank(s){return tbh5.checkIsBlank(s)}function _getServerHost(host,domain){return host.replace(_Domainholder,function(){return _checkDomain(domain)?domain:exports.uri.defaultDomain})}function _getJsonStr(j){var s="";if(null==j)return s;for(var k in j)null!=j[k]&&""!=j[k]&&(s+=k+"="+encodeURIComponent(j[k])+"&");return""!=s&&s.length-1==s.lastIndexOf("&")&&(s=s.substr(0,s.length-1)),s}var $=require("zepto"),config=require("./config"),tbh5=require("./h5_base");exports.uri={protocol:"http://",sysType:config.sysType||"m",defaultDomain:"taobao"};var _domainWhiteList=["taobao","tmall","etao","alibaba","alipay"],_Domainholder="${_serverDomain}";exports._serverHost=exports.uri.sysType+"."+_Domainholder+".com",exports.subUri={index:exports.uri.protocol+exports._serverHost},exports.ttQueryStr="";try{var defaultParams=JSON.parse(tbh5.get(tbh5.userInfoKey)||"{}")||{},sid=defaultParams.sid;null!=sid&&""!=sid&&(exports.ttQueryStr+="sid="+sid)}catch(e){}exports.renderURI=function(uri,target,param,path,domain){return _render(buildUrl(_getServerHost(uri,domain),target,param,path))},exports.renderDomain=function(target,param,path,domain){return _render(buildUrl(_getServerHost(exports.subUri.index,domain),target,param,path))},exports.renderServer=function(target,param,path,server){return _render(buildUrl(server,target,param,path))},exports.encode=function(v){return encodeURI(v)},exports.getStrParamFromJson=function(j){return _getJsonStr(j)},exports.createURI=function(name){return name==="home"?exports.uri.protocol+exports._serverHost:exports.uri.protocol+name+"."+exports._serverHost}});
define("http://a.tbcdn.cn/mw/webapp/fav/module/server/fav_url.js",["underscore","../../../../../base/utils/server/uriBroker","../../../../../base/utils/server/cdn","../../../../../base/utils/server/mtop_ajax","../../../../../base/utils/server/h5_base","zepto"],function(require,exports,module){var _=require("underscore"),uri=require("../../../../../base/utils/server/uriBroker"),cdn=require("../../../../../base/utils/server/cdn"),mtop_ajax=require("../../../../../base/utils/server/mtop_ajax"),tbh5=require("../../../../../base/utils/server/h5_base"),Zepto=require("zepto"),fav_dps={my:"mytaobao##fav",a:{cache:"itemcache"},shop:{cache:"itemcache"},shop_search:{cache:"itemcache"},home_wuliu:"wuliu##fav",home:"h5home##fav",im:"wangwang##fav",my:"mytaobao1##fav",my_2:"mytaobao2##fav",s:"search##fav",auction1_cart:"mycart##fav",rg:"apply##fav",api_querycolgood:{dps:"auction##fav",cache:"itemcache"},api_querycolgood_3th:{dps:"aucall##fav",cache:"itemcache"},api_querycolpromogood:{dps:"promotion1##fav",cache:"itemcache"},api_querycolshop:{dps:"shop##fav",cache:"itemcache"},api_querycolshop_3th:{dps:"shopall##fav",cache:"itemcache"},api_querycolactshop:{dps:"promotion2##fav",cache:"itemcache"},api_querycolnewgoodshop:{dps:"shopnew##fav",cache:"itemcache"},api_querycolgoodcatefilter_click:"category1##fav",api_querycolgoodcatefilter_slide:"category2##fav",api_querycolgoodcatefilter_tab:"auclist##fav",api_querycolgoodcatefilter:"auclist##fav",api_querycolgoodtagfilter:"mylist##fav",api_querycolshopcatfilter_click:"shopcat1##fav",api_querycolshopcatfilter_slide:"shopcat2##fav",api_querycolshopcatfilter_tab:"shopcat##fav",api_querycolshopcatfilter:"shopcat##fav",api_querycolshoptagfilter:"shoptag##fav",api_delcolshop:"delshop##fav",api_delcolgood:"delgood##fav",api_taojia_on:"taojiaon##fav",api_taojia_off:"taojiaoff##fav"};_.extend(uri.URL_CONSTANTS.dps,fav_dps);var apiType=tbh5.get("api_type")||"rest/h5Api.do",fav_path={fav_item:"favItem.htm",fav_shop:"favShop.htm",fav_log:"logUserAction.htm",api:apiType,rg:"wap/index.htm"};_.extend(uri.URL_CONSTANTS.path,fav_path),uri.defaultMtopParam={api:"com.taobao.wap.rest2.fav",v:"*"};var fav_url={};fav_url.ajax=function(module,param,callback,errorback){return mtop_ajax.get(fav_url.getUrl(module,param),param,callback,errorback)},fav_url.getUrl=function(module,param){return uri.getUrl(module,param)},fav_url.getImgUrl=function(path,pix){return pix=pix||90,cdn.getImg(path,pix,pix)},fav_url.getCommUrl=function(){var commUrls={};return commUrls.home=uri.getUrl("home",{}),commUrls.home_midd=uri.getUrl("home",{v:1,sprefer:"pmm301"}),commUrls.home_wuliu=uri.getUrl("home_wuliu",{status_id:5}),commUrls.home_kehu=uri.getUrl("home_kehu",{}),commUrls.home_anquan=uri.getUrl("home_anquan",{}),commUrls.home_help=uri.getUrl("home_help",{}),commUrls.info_jianyi=uri.getUrl("info_jianyi",{}),commUrls.fav=uri.getUrl("fav",{}),commUrls.my=uri.getUrl("my",{}),commUrls.im=uri.getUrl("im",{}),commUrls.s=uri.getUrl("s",{}),commUrls.cart=uri.getUrl("auction1_cart",{}),commUrls.login=uri.getUrl("login",{}),commUrls.login_out=uri.getUrl("login_out",{}),commUrls.u_reg=uri.getUrl("u_reg",{}),commUrls},fav_url.getItemUrl=function(itemId,tmall){var arg={itemId:itemId};return tmall&&tmall!="0"&&tmall!="false"&&(arg.domain="tmall"),uri.getUrl("a",arg)};var _logParam={logOnly:1};return fav_url.monitor=function(params){var dps=uri.getDps("api",params);Zepto.ajax({url:"logUserAction.htm",data:{t:(new Date).getTime(),dps:dps}})},fav_url});
define("http://a.tbcdn.cn/base/utils/server/uriBroker.js",["underscore","./uri","./h5_base"],function(require,exports,module){function _getPath(module){if(URL_CONSTANTS.path[module])return URL_CONSTANTS.path[module];var lastIndex_=module.lastIndexOf("_");return lastIndex_<0?"":_getPath(module.substring(0,lastIndex_))}function _rebuildPath(path,params){return path==URL_CONSTANTS.path["a"]&&(path=path.replace("ITEM_ID",function(){var itemId=params.itemId;return delete params.itemId,itemId})),path||""}function _getDpsParam(module){var dps=URL_CONSTANTS.dps[module];if(_.isString(dps))return dps;if(_.isObject(dps)){var cacheName=dps.cache;if(dps.dps)return URL_CONSTANTS[cacheName]=dps.dps,dps.dps;if(cacheName)return URL_CONSTANTS[cacheName]}return!module||module.lastIndexOf("_")<0?"":(module=module.substring(0,module.lastIndexOf("_")),_getDpsParam(module))}var _=require("underscore"),uri=require("./uri"),tbh5=require("./h5_base"),uriBroker={};return uriBroker.URL_CONSTANTS=URL_CONSTANTS={path:{home:"index.htm",home_wuliu:"trade/bought_item_lists.htm",home_kehu:"channel/act/other/kehufuwu.xhtml",home_anquan:"channel/act/other/jiaoyianquan.xhtml",home_help:"hannel/act/other/help.xhtml",my:"myTaobao.htm",a:"iITEM_ID.htm",s:"search.htm",im:"ww/ad_ww_lately_contacts.htm",shop:"shop/shop_index.htm",shop_search:"shop/shop_auction_search.htm",login:"login.htm",login_out:"logout.htm",u_reg:"reg/newUser.htm",fav:"h5proxy-fav.htm",auction1_cart:"cart/my_cart.htm",info_jianyi:"help/report.htm"},dps:{},app_param_key:tbh5.paramKey},uriBroker.getUrl=function(module,param){module=module.toLowerCase(),param=param||{};var domain=param.domain;domain?delete param.domain:domain="taobao";var _modules=module.split("_"),host=uri.createURI(_modules[0]);if(!host)throw"module param is not current,can't match any host";var path="",dps=_getDps(module,param);switch(_modules[0]){case"api":var _param={};_param.data=JSON.stringify(param),_.extend(_param,this.defaultMtopParam),param=_param,path=_getPath(module);break;default:path=_getPath(module),path=_rebuildPath(path,param)}return dps&&(param.dps=dps),uri.renderURI(host,"",param,path,domain)},uriBroker.getDps=_getDps=function(module,param){if(param.dps)return param.dps;var dps_key=module,method=param.method;return method&&(dps_key+="_"+method.toLowerCase()),param._3th&&(dps_key+="_3th",delete param._3th),param.trigerType&&(dps_key+="_"+param.trigerType,delete param.trigerType),_getDpsParam(dps_key)},uriBroker});
define("http://a.tbcdn.cn/base/utils/server/cdn.js",["./config"],function(require,exports,module){function _buildUrl(type,name,path,height,width,n){if(!name)return"http://a.tbcdn.cn/mw/s/common/icons/nopic/nopic-"+height+".png";if(-1!=name.indexOf("http://"))return name+fix(height,width);if(type==_logoType)return _getLogoHost()+_logoSubPath+name+fix(height,width);var machineNo=_chooseCDN(name,n);return _getImgHost(machineNo).replace("${machine}",machineNo)+_imgSubPath+name+fix(height,width)}function fix(height,width){return"_"+(height||80)+"x"+(width||80)+".jpg"}function _chooseCDN(name,n){var machineNo=-1;null!=n&&n.toString().match("[0-9]")&&(machineNo=n%_m);if(-1==machineNo)if(name.match("^i[0-9].*"))machineNo=parseInt(name.charAt(1))%_m;else{var reg=name.match("([^/]*).jpg");if(null!=reg&&""!=reg&&reg.length>1){var length=reg[1].length,code=reg[1].charCodeAt(0)+reg[1].charCodeAt(length-1);machineNo=code%_m}else machineNo=name.charCodeAt(0)%_m}return 0==machineNo&&(machineNo+=1),machineNo}function _getImgHost(){return _isTest()?_imgTestHost:_imgHost}function _getLogoHost(){return _isTest()?_logoTestHost:_logoHost}function _isTest(){return"waptest"==_sys}var config=require("./config"),_sys=config.sysType||"m",_placeHolder="${machine}",_imgSubPath="/bao/uploaded/",_imgTestHost="http://img0"+_placeHolder+".daily.taobaocdn.net",_imgHost="http://q.i0"+_placeHolder+".wimg.taobao.com",_logoTestHost="http://logo.daily.taobao.net",_logoHost="http://logo.taobaocdn.com",_logoSubPath="/shop-logo/",_m=4,_logoType=1,_imgType=2;exports.getImg=function(name,height,width,n){return _buildUrl(_imgType,name,_imgSubPath,height,width,n)},exports.getLogo=function(name,height,width,n){return _buildUrl(_logoType,name,_logoSubPath,height,width,n)}});
define("http://a.tbcdn.cn/mw/webapp/fav/model/goodslistModel.js",["backbone"],function(require,exports,module){var Backbone=require("backbone"),MODEL={};return MODEL.goodslistClass=Backbone.Model.extend({}),MODEL.Instance=new MODEL.goodslistClass,MODEL});
define("http://a.tbcdn.cn/mw/webapp/fav/view/goodslistView.js",["zepto","mu","backbone","../module/help","../model/goodslistModel","../model/paramModel","../module/server/fav_url","../module/favScroll","../module/_slider","../../../../base/modules/message/error","./goodslistViewMu"],function(require,exports,module){var $=require("zepto"),Mustache=require("mu"),Backbone=require("backbone"),help=require("../module/help"),goodslistModel=require("../model/goodslistModel"),paramModel=require("../model/paramModel"),fav_url=require("../module/server/fav_url"),favScroll=require("../module/favScroll"),slider=require("../module/_slider"),err=require("../../../../base/modules/message/error"),VIEW={};return VIEW.goodslistViewClass=Backbone.View.extend({model:goodslistModel.Instance,template:require("./goodslistViewMu"),el:"#content",events:{},initialize:function(){var self=this;self.model.bind("change:t",function(){var s=self.setHref(self.model.get("resultlist"));self.renderGoodsListView(s)})},setHref:function(s){var list=s.data.result.resultList,length=list.length;if(length>0)for(var i=0;i<length;i++)list[i].imghref=fav_url.getImgUrl(list[i].img),list[i].itemhref=fav_url.getItemUrl(list[i].numId),list[i].promotionPrice?list[i].isPromot=list[i].promotionPrice=="false"?!1:!0:list[i].isPromot=!1;else{var currentpage=s.data.result.currentPage;if(parseInt(currentpage)<=1)return!1}return s},renderGoodsListView:function(s){var selfTemp=this.template,container=$("#content"),childContainer=$("#content .list-goods"),currentPage=paramModel.Instance.get("param").currentPage;if(childContainer.length==0){container.html("");var el=this.make("div",{"class":"list-content",id:"J_"+this.model.get("m")},'<ul class="list-goods"></ul>');container.html(el)}return selfTemp==""&&(selfTemp=help.template(module.fileattr()[0],module.fileattr()[1]),this.template=selfTemp),s?selfTemp.charAt(0)!="!"?currentPage==1?(slider.destroy(),$("#content .list-goods").html(Mustache.to_html(selfTemp,s))):$("#content .list-goods").append(Mustache.to_html(selfTemp,s)):container.html(selfTemp.substring(1)):err.blank(),favScroll.refresh(),this}}),VIEW.Instance=new VIEW.goodslistViewClass,VIEW});
define("http://a.tbcdn.cn/base/libs/mustache/0.4.0/mu.js",["./mustache"],function(require,exports,module){function addFns(template,data){var ifs=getConditions(template),key="";for(var i=0;i<ifs.length;i++){key="if("+ifs[i]+")";if(data[key])continue;data[key]=buildFn(ifs[i])}}function getConditions(template){var ifregexp_ig=/\{{2,3}[\^#]?if\((.*?)\)\}{2,3}?/ig,ifregexp_i=/\{{2,3}[\^#]?if\((.*?)\)\}{2,3}?/i,gx=template.match(ifregexp_ig),ret=[];if(gx)for(var i=0;i<gx.length;i++)ret.push(gx[i].match(ifregexp_i)[1]);return ret}function buildFn(key){key=key.split("==");var res=function(){var ns=key[0].split("."),value=key[1],curData=this;for(var i=ns.length-1;i>-1;i--){var cns=ns.slice(i),d=curData;try{for(var j=0;j<cns.length-1;j++)d=d[cns[j]];if(cns[cns.length-1]in d)return d[cns[cns.length-1]].toString()===value?!0:!1}catch(err){}}return!1};return res}function findArray(o,depth){var k,v;for(k in o)v=o[k],v instanceof Array?addArrayIndex(v):typeof v=="object"&&depth<5&&findArray(v,depth+1)}function addArrayIndex(v){for(var i=0;i<v.length;i++)o=v[i],typeof o=="object"&&(i===0?o.__first__=!0:i==v.length-1?o.__last__=!0:o.__mid__=!0,o.__index__=i)}var Mustache=require("./mustache");return{to_html:function(template,data){return typeof data=="object"&&findArray(data,0),addFns(template,data),Mustache.to_html.apply(this,arguments)}}});
(function(a){typeof define=="function"?define("#mustache/0.4.0/mustache",[],a):typeof module!="undefined"?module.exports=a():this.Mustache=a()})(function(){var a=function(){var a={},b=function(){};return b.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":!0},context:{},render:function(a,b,c,d){d||(this.context=b,this.buffer=[]);if(!this.includes("",a)){if(d)return a;this.send(a);return}a=this.render_pragmas(a);var e=this.render_section(a,b,c);e===!1&&(e=this.render_tags(a,b,c,d));if(d)return e;this.sendLines(e)},send:function(a){a!==""&&this.buffer.push(a)},sendLines:function(a){if(a){var b=a.split("\n");for(var c=0;c<b.length;c++)this.send(b[c])}},render_pragmas:function(a){if(!this.includes("%",a))return a;var b=this,c=this.getCachedRegex("render_pragmas",function(a,b){return new RegExp(a+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+b,"g")});return a.replace(c,function(a,c,d){if(!b.pragmas_implemented[c])throw{message:"This implementation of mustache doesn't understand the '"+c+"' pragma"};b.pragmas[c]={};if(d){var e=d.split("=");b.pragmas[c][e[0]]=e[1]}return""})},render_partial:function(a,b,c){a=this.trim(a);if(!c||c[a]===undefined)throw{message:"unknown_partial '"+a+"'"};return typeof b[a]!="object"?this.render(c[a],b,c,!0):this.render(c[a],b[a],c,!0)},render_section:function(a,b,c){if(!this.includes("#",a)&&!this.includes("^",a))return!1;var d=this,e=this.getCachedRegex("render_section",function(a,b){return new RegExp("^([\\s\\S]*?)"+a+"(\\^|\\#)\\s*(.+)\\s*"+b+"\n*([\\s\\S]*?)"+a+"\\/\\s*\\3\\s*"+b+"\\s*([\\s\\S]*)$","g")});return a.replace(e,function(a,e,f,g,h,i){var j=e?d.render_tags(e,b,c,!0):"",k=i?d.render(i,b,c,!0):"",l,m=d.find(g,b);return f==="^"?!m||d.is_array(m)&&m.length===0?l=d.render(h,b,c,!0):l="":f==="#"&&(d.is_array(m)?l=d.map(m,function(a){return d.render(h,d.create_context(a),c,!0)}).join(""):d.is_object(m)?l=d.render(h,d.create_context(m),c,!0):typeof m=="function"?l=m.call(b,h,function(a){return d.render(a,b,c,!0)}):m?l=d.render(h,b,c,!0):l=""),j+l+k})},render_tags:function(a,b,c,d){var e=this,f=function(){return e.getCachedRegex("render_tags",function(a,b){return new RegExp(a+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+b+"+","g")})},g=f(),h=function(a,d,h){switch(d){case"!":return"";case"=":return e.set_delimiters(h),g=f(),"";case">":return e.render_partial(h,b,c);case"{":return e.find(h,b);default:return e.escape(e.find(h,b))}},i=a.split("\n");for(var j=0;j<i.length;j++)i[j]=i[j].replace(g,h,this),d||this.send(i[j]);if(d)return i.join("\n")},set_delimiters:function(a){var b=a.split(" ");this.otag=this.escape_regex(b[0]),this.ctag=this.escape_regex(b[1])},escape_regex:function(a){if(!arguments.callee.sRE){var b=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];arguments.callee.sRE=new RegExp("(\\"+b.join("|\\")+")","g")}return a.replace(arguments.callee.sRE,"\\$1")},find:function(a,b){function c(a){return a===!1||a===0||a}a=this.trim(a);var d;if(a.match(/([a-z_]+)\./ig)){var e=this.walk_context(a,b);c(e)&&(d=e)}else c(b[a])?d=b[a]:c(this.context[a])&&(d=this.context[a]);return typeof d=="function"?d.apply(b):d!==undefined?d:""},walk_context:function(a,b){var c=a.split("."),d=b[c[0]]!=undefined?b:this.context,e=d[c.shift()];while(e!=undefined&&c.length>0)d=e,e=e[c.shift()];return typeof e=="function"?e.apply(d):e},includes:function(a,b){return b.indexOf(this.otag+a)!=-1},escape:function(a){return a=String(a===null?"":a),a.replace(/&(?!\w+;)|["'<>\\]/g,function(a){switch(a){case"&":return"&amp;";case'"':return"&quot;";case"'":return"&#39;";case"<":return"&lt;";case">":return"&gt;";default:return a}})},create_context:function(a){if(this.is_object(a))return a;var b=".";this.pragmas["IMPLICIT-ITERATOR"]&&(b=this.pragmas["IMPLICIT-ITERATOR"].iterator);var c={};return c[b]=a,c},is_object:function(a){return a&&typeof a=="object"},is_array:function(a){return Object.prototype.toString.call(a)==="[object Array]"},trim:function(a){return a.replace(/^\s*|\s*$/g,"")},map:function(a,b){if(typeof a.map=="function")return a.map(b);var c=[],d=a.length;for(var e=0;e<d;e++)c.push(b(a[e]));return c},getCachedRegex:function(b,c){var d=a[this.otag];d||(d=a[this.otag]={});var e=d[this.ctag];e||(e=d[this.ctag]={});var f=e[b];return f||(f=e[b]=c(this.otag,this.ctag)),f}},{name:"mustache.js",version:"0.4.0-dev",to_html:function(a,c,d,e){var f=new b;e&&(f.send=e),f.render(a,c||{},d);if(!e)return f.buffer.join("\n")}}}();return a});
define("http://a.tbcdn.cn/mw/webapp/fav/module/help.js",["zepto","mu"],function(require,exports,module){var help={},$=require("zepto"),Mustache=require("mu"),_tempAJAX=function(url){};return help.template=function(filename,filepath){var t=(new Date).getTime(),url=filepath+filename+".mu",temp="";return $.ajax({async:!1,url:url+"?t="+t,dataType:"text",success:function(data){temp=data},error:function(){temp="!sorry 模板引入存在问题"}}),temp},help});
define("http://a.tbcdn.cn/mw/webapp/fav/model/paramModel.js",["backbone","zepto","./goodslistModel","./shoplistModel","../../../../base/utils/server/mtop_ajax","../../../../base/utils/server/h5_common","../module/server/fav_url","../../../../base/modules/message/error","../module/listLoading"],function(require,exports,module){var Backbone=require("backbone"),$=require("zepto"),goodslistModel=require("./goodslistModel"),shoplistModel=require("./shoplistModel"),mtopAjax=require("../../../../base/utils/server/mtop_ajax"),favComm=require("../../../../base/utils/server/h5_common"),favUrl=require("../module/server/fav_url"),err=require("../../../../base/modules/message/error"),listLoading=require("../module/listLoading"),MODEL={};return MODEL.paramModelClass=Backbone.Model.extend({initialize:function(){var self=this},url:function(){var params=this.get("param");return favUrl.getUrl("api",params)},getListData:function(){var self=this,url=self.url(),params=self.get("param"),t=(new Date).getTime(),_favComm=function(res){favComm.dealResponse(res,function(res){params.startRow=parseInt(res.data.result.lastRow)+1,self.set({param:params},{silent:!0}),self.get("nav")=="goods"?goodslistModel.Instance.set({resultlist:res,m:params.method,t:t}):shoplistModel.Instance.set({resultlist:res,m:params.method,t:t});var hasNextPage=res.data.result.havNextPage=="true";self.get("nav")=="goods"?goodslistModel.Instance.hasNextPage=hasNextPage:shoplistModel.Instance.hasNextPage=hasNextPage,$(window).trigger("touchstart")},function(error){err.busy({linkto:favUrl.getUrl("fav")}),console.log("业务报错"+error),console.log("重试按钮URL："+favUrl.getUrl("fav"))},"fav")};this.get("nav")=="goods"?goodslistModel.Instance.hasNextPage&&listLoading.show():shoplistModel.Instance.hasNextPage&&listLoading.show(),setTimeout(function(){mtopAjax.get(url,params,function(res){listLoading.hide(),_favComm(res)},function(error){listLoading.hide(),err.busy({linkto:favUrl.getUrl("fav")}),console.log("系统报错"+error),console.log("重试按钮URL："+favUrl.getUrl("fav"))})},1)}}),MODEL.Instance=new MODEL.paramModelClass,MODEL});
define("http://a.tbcdn.cn/mw/webapp/fav/model/shoplistModel.js",["backbone"],function(require,exports,module){var Backbone=require("backbone"),MODEL={};return MODEL.shoplistClass=Backbone.Model.extend({}),MODEL.Instance=new MODEL.shoplistClass,MODEL});
define("http://a.tbcdn.cn/base/utils/server/h5_common.js",["./uriBroker","./config","./h5_base"],function(require,exports,module){var uriBroker=require("./uriBroker"),config=require("./config"),tbh5=require("./h5_base"),toLogin=function(targetPath){var redirectURL=uriBroker.getUrl(targetPath);window.location.href=uriBroker.getUrl("login",{tpl_redirect_url:redirectURL})},toIndex=function(){window.location.href=config.indexPage||"http://m.taobao.com"};exports.dealResponse=function(resp,seccussHandle,bizErrorHandle,targetPath){var ret=resp.ret.toString().toUpperCase();ret.indexOf("SUCCESS::")>-1?seccussHandle(resp):(tbh5.set(tbh5.hrefHash,window.location.hash),ret.indexOf("-100::")>-1?targetPath?toLogin(targetPath):toLogin("home"):ret.indexOf("ILLEGAL_REQUEST::")>-1||ret.indexOf("ILLEGAL_SIGN::")>-1?addRequestFailedTimes()||toIndex():bizErrorHandle&&bizErrorHandle(ret))};var addRequestFailedTimes=function(){var times=parseInt(tbh5.get(tbh5.appRequestFailed)||"0");return 3<=times?(window.location.href="http://m.taobao.com?t=3",!0):(times+=1,tbh5.set(tbh5.appRequestFailed,times),!1)};exports.isSupportH5=function(){return window.localStorage=="undefined"?!1:window.applicationCache=="undefined"?!1:!0},exports.userLevel=function(rank){var x="1",z="2",g="3",j="4";return rank>=4&&rank<=10?x+"1":rank>=11&&rank<=40?x+"2":rank>=41&&rank<=90?x+"3":rank>=91&&rank<=150?x+"4":rank>=151&&rank<=250?x+"5":rank>=251&&rank<=500?z+"1":rank>=501&&rank<=1e3?z+"2":rank>=1001&&rank<=2e3?z+"3":rank>=2001&&rank<=5e3?z+"4":rank>=5001&&rank<=1e4?z+"5":rank>=10001&&rank<=2e4?g+"1":rank>=20001&&rank<=5e4?g+"2":rank>=50001&&rank<=1e5?g+"3":rank>=100001&&rank<=2e5?g+"4":rank>=200001&&rank<=5e5?g+"5":rank>=500001&&rank<=1e6?j+"1":rank>=1000001&&rank<=2e6?j+"2":rank>=2000001&&rank<=5e6?j+"3":rank>=5000001&&rank<=1e7?j+"4":rank>=10000001?j+"5":""}});
define("http://a.tbcdn.cn/base/modules/message/error.js",["zepto"],function(require,exports,module){var $=require("zepto"),_MSG={BUSY:"亲，由于系统繁忙，请稍后再试！",BLANK:"亲，这里没有东东哦"},_packBusy=function(msg,linkto){var template="",_msg="",_linkto="";return _msg=msg?msg:_MSG.BUSY,_linkto=linkto?linkto:"",template+='<div class="common-loading error">',template+='<img class="" src="http://a.tbcdn.cn/mw/webapp/fav/img/error.png"> ',template+="<p>"+_msg+"</p>",template+='<p><a href="'+_linkto+'" class="btn-grey-small">重试</a></p>',template+="</div>",template},_errorBusy=function(options){var setting={target:"#content",msg:_MSG.BUSY,template:_packBusy(),linkto:""};options&&($.extend(setting,options),setting.template=_packBusy(options.msg,setting.linkto)),$(setting.target).html(setting.template)},_packBlank=function(msg){var template="";return template+='<div class="no-content">',template+='<img src="http://a.tbcdn.cn/mw/webapp/fav/img/attention.png" /> ',msg?template+=msg:template+=_MSG.BLANK,template+="</div>",template},_errorBlank=function(options){var setting={target:"#content",msg:_MSG.BLANK,template:_packBlank()};options&&($.extend(setting,options),options.msg&&(setting.template=_packBlank(options.msg))),$(setting.target).html(setting.template)},err={};return err.busy=function(options){_errorBusy(options)},err.blank=function(options){_errorBlank(options)},err});
define("http://a.tbcdn.cn/mw/webapp/fav/module/listLoading.js",["zepto","backbone"],function(require,exports,module){var $=require("zepto"),Backbone=require("backbone"),$content=$("#content"),loadingTmpl='<div class="list-loading"><img class="loading" src="http://a.tbcdn.cn/mw/webapp/fav/img/loading.png" />正在加载，请稍候...</div>';return{show:function(){this.hide(),$content.append(loadingTmpl)},hide:function(){$content.find(".list-loading").remove()},error:function(){this.hide()}}});
define("http://a.tbcdn.cn/mw/webapp/fav/module/favScroll.js",["zepto","iscroll","./favSwipetop","./favlistDel"],function(require,exports,module){var $=require("zepto"),iScroll=require("iscroll"),swipeTop=require("./favSwipetop"),swipeAround=require("./favlistDel");return $.iScroll=function(options){var op={isInit:!0,wrap:"wrapper"},scrollClass;$.extend(op,options),scrollClass={initHeight:function(){var wrapper=document.getElementById(op.wrap),scroller=wrapper.children[0],sheightsc=Math.max(scroller.offsetHeight,scroller.scrollHeight),wHeight=window.innerHeight;wHeight=wHeight>sheightsc?sheightsc:wHeight,wrapper.style.height=wHeight+"px",wrapper.parentNode.style.height=wHeight+"px"},init:function(){document.addEventListener("touchmove",function(e){e.preventDefault()},!1);var that=this,touchm={};that.initHeight();var scrolln=that.scroll=new iScroll(op.wrap,{hScroll:!1,hScrollbar:!1,fixedScrollbar:!1,hideScrollbar:!0,onScrollStart:function(e){op.onScrollStart&&op.onScrollStart.call(this),touchm.sx=this.pointX,touchm.sy=this.pointY},onScrollMove:function(e){op.onScrollMove&&op.onScrollMove.call(this),touchm.mx=this.pointX,touchm.my=this.pointY,touchm.disx=Math.abs(touchm.mx-touchm.sx),touchm.disy=touchm.my-touchm.sy,touchm.disx-touchm.disy>0?touchm.disx>50&&(touchm.xmoved=!0):Math.abs(touchm.disy)>10&&(touchm.ymoved=!0),swipeTop&&(swipeTop.topCache.isScroll=!0)},onTouchEnd:function(e){op.onTouchEnd&&op.onTouchEnd.call(this);if(touchm.xmoved){touchm.xmoved=null;if(swipeAround){var odel=swipeAround.op,curel=e.target,li=$(curel).parents(".list-scrolla"),dBton;if(!li[0])return;if(li.parent().hasClass("hasdel"))return;dBton=li.parent().find(odel.extraEl);if(dBton.length<1)return;touchm.dBton&&$(touchm.dBton).animate({width:0},300,"ease-out",function(){$(this).addClass(odel.hideCls)}),touchm.dBton=dBton,dBton.hasClass(odel.hideCls)?(dBton.removeClass(odel.hideCls),dBton.css({width:0,overflow:"hidden"}),$(dBton).animate({width:60},300,"ease-in")):($(dBton).animate({width:0},300,"ease-out",function(){$(this).addClass(odel.hideCls)}),touchm.dBton=null)}}else if(swipeAround&&touchm.dBton){var odel=swipeAround.op,startcurel=e.target,dBtontemp=touchm.dBton[0];startcurel==dBtontemp||startcurel.parentNode==dBtontemp?touchm.dBton=null:($(touchm.dBton).animate({width:0},300,"ease-out",function(){$(this).addClass(odel.hideCls)}),touchm.dBton=null)}if(touchm.ymoved){var that=this;touchm.ymoved=null,swipeTop&&that.y>swipeTop.op.swipeTopGap&&swipeTop.showTop(that.y,"slide")}touchm.disx=0,touchm.disy=0},onScrollEnd:function(){swipeTop&&(swipeTop.topCache.isScroll=!1),op.onScrollEnd&&op.onScrollEnd.call(this)}});swipeTop&&swipeTop.init(scrolln),swipeAround&&swipeAround.setClearExOps({scrollObj:scrolln})},refresh:function(str){var that=this;that.initHeight(),that.scroll.refresh()},set:function(key,value){op[key]=value},get:function(key){var that=this;return that.scroll[key]},scrollTo:function(x,y,time){var that=this;that.scroll.scrollTo(x,y,time)}};if(op.isInit){var resize="onorientationchange"in window?"orientationchange":"resize",isAndroid=/android/gi.test(navigator.appVersion);window.addEventListener(resize,function(){setTimeout(function(){scrollClass.refresh()},isAndroid?500:0)},!1),scrollClass.init()}return scrollClass},$.iScroll({wrap:"J_Main"})});
(function(factory){typeof define=="function"?define("#iscroll/4.1.9/iscroll-debug",[],factory):window.iScroll=factory()})(function(require,exports,module){var m=Math,mround=function(r){return r>>0},vendor=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":/trident/i.test(navigator.userAgent)?"ms":"opera"in window?"O":"",isAndroid=/android/gi.test(navigator.appVersion),isIDevice=/iphone|ipad/gi.test(navigator.appVersion),isPlaybook=/playbook/gi.test(navigator.appVersion),isTouchPad=/hp-tablet/gi.test(navigator.appVersion),has3d="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,hasTouch="ontouchstart"in window&&!isTouchPad,hasTransform=vendor+"Transform"in document.documentElement.style,hasTransitionEnd=isIDevice||isPlaybook,nextFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){return setTimeout(callback,1)}}(),cancelFrame=function(){return window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}(),RESIZE_EV="onorientationchange"in window?"orientationchange":"resize",START_EV=hasTouch?"touchstart":"mousedown",MOVE_EV=hasTouch?"touchmove":"mousemove",END_EV=hasTouch?"touchend":"mouseup",CANCEL_EV=hasTouch?"touchcancel":"mouseup",WHEEL_EV=vendor=="Moz"?"DOMMouseScroll":"mousewheel",trnOpen="translate"+(has3d?"3d(":"("),trnClose=has3d?",0)":")",iScroll=function(el,options){var that=this,doc=document,i;that.wrapper=typeof el=="object"?el:doc.getElementById(el),that.wrapper.style.overflow="hidden",that.scroller=that.wrapper.children[0],that.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,hScrollbar:!0,vScrollbar:!0,fixedScrollbar:isAndroid,hideScrollbar:isIDevice,fadeScrollbar:isIDevice&&has3d,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(e){var nodeType=e.explicitOriginalTarget?e.explicitOriginalTarget.nodeName.toLowerCase():e.target?e.target.nodeName.toLowerCase():"";nodeType!="select"&&nodeType!="option"&&nodeType!="input"&&nodeType!="textarea"&&e.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null,hide:!1};for(i in options)that.options[i]=options[i];that.x=that.options.x,that.y=that.options.y,that.options.useTransform=hasTransform?that.options.useTransform:!1,that.options.hScrollbar=that.options.hScroll&&that.options.hScrollbar,that.options.vScrollbar=that.options.vScroll&&that.options.vScrollbar,that.options.zoom=that.options.useTransform&&that.options.zoom,that.options.useTransition=hasTransitionEnd&&that.options.useTransition,that.options.zoom&&isAndroid&&(trnOpen="translate(",trnClose=")"),that.scroller.style[vendor+"TransitionProperty"]=that.options.useTransform?"-"+vendor.toLowerCase()+"-transform":"top left",that.scroller.style[vendor+"TransitionDuration"]="0",that.scroller.style[vendor+"TransformOrigin"]="0 0",that.options.useTransition&&(that.scroller.style[vendor+"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)"),that.options.useTransform?that.scroller.style[vendor+"Transform"]=trnOpen+that.x+"px,"+that.y+"px"+trnClose:that.scroller.style.cssText+=";position:absolute;top:"+that.y+"px;left:"+that.x+"px",that.options.useTransition&&(that.options.fixedScrollbar=!0),that.refresh(),that._bind(RESIZE_EV,window),that._bind(START_EV),hasTouch||(that._bind("mouseout",that.wrapper),that.options.wheelAction!="none"&&that._bind(WHEEL_EV)),that.options.checkDOMChanges&&(that.checkDOMTime=setInterval(function(){that._checkDOMChanges()},500))};return iScroll.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(e){var that=this;switch(e.type){case START_EV:if(!hasTouch&&e.button!==0)return;that._start(e);break;case MOVE_EV:that._move(e);break;case END_EV:case CANCEL_EV:that._end(e);break;case RESIZE_EV:that._resize();break;case WHEEL_EV:that._wheel(e);break;case"mouseout":that._mouseout(e);break;case"webkitTransitionEnd":that._transitionEnd(e)}},_checkDOMChanges:function(){if(this.moved||this.zoomed||this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)return;this.refresh()},_scrollbar:function(dir){var that=this,doc=document,bar;if(!that[dir+"Scrollbar"]){that[dir+"ScrollbarWrapper"]&&(hasTransform&&(that[dir+"ScrollbarIndicator"].style[vendor+"Transform"]=""),that[dir+"ScrollbarWrapper"].parentNode.removeChild(that[dir+"ScrollbarWrapper"]),that[dir+"ScrollbarWrapper"]=null,that[dir+"ScrollbarIndicator"]=null);return}that[dir+"ScrollbarWrapper"]||(bar=doc.createElement("div"),that.options.scrollbarClass?bar.className=that.options.scrollbarClass+dir.toUpperCase():bar.style.cssText="position:absolute;z-index:100;"+(dir=="h"?"height:7px;bottom:1px;left:2px;right:"+(that.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(that.hScrollbar?"7":"2")+"px;top:2px;right:1px"),bar.style.cssText+=";pointer-events:none;-"+vendor+"-transition-property:opacity;-"+vendor+"-transition-duration:"+(that.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(that.options.hideScrollbar?"0":"1"),that.wrapper.appendChild(bar),that[dir+"ScrollbarWrapper"]=bar,bar=doc.createElement("div"),that.options.scrollbarClass||(bar.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);-"+vendor+"-background-clip:padding-box;-"+vendor+"-box-sizing:border-box;"+(dir=="h"?"height:100%":"width:100%")+";-"+vendor+"-border-radius:3px;border-radius:3px"),bar.style.cssText+=";pointer-events:none;-"+vendor+"-transition-property:-"+vendor+"-transform;-"+vendor+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);-"+vendor+"-transition-duration:0;-"+vendor+"-transform:"+trnOpen+"0,0"+trnClose,that.options.useTransition&&(bar.style.cssText+=";-"+vendor+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),that[dir+"ScrollbarWrapper"].appendChild(bar),that[dir+"ScrollbarIndicator"]=bar),dir=="h"?(that.hScrollbarSize=that.hScrollbarWrapper.clientWidth,that.hScrollbarIndicatorSize=m.max(mround(that.hScrollbarSize*that.hScrollbarSize/that.scrollerW),8),that.hScrollbarIndicator.style.width=that.hScrollbarIndicatorSize+"px",that.hScrollbarMaxScroll=that.hScrollbarSize-that.hScrollbarIndicatorSize,that.hScrollbarProp=that.hScrollbarMaxScroll/that.maxScrollX):(that.vScrollbarSize=that.vScrollbarWrapper.clientHeight,that.vScrollbarIndicatorSize=m.max(mround(that.vScrollbarSize*that.vScrollbarSize/that.scrollerH),8),that.vScrollbarIndicator.style.height=that.vScrollbarIndicatorSize+"px",that.vScrollbarMaxScroll=that.vScrollbarSize-that.vScrollbarIndicatorSize,that.vScrollbarProp=that.vScrollbarMaxScroll/that.maxScrollY),that._scrollbarPos(dir,!0)},_resize:function(){var that=this;setTimeout(function(){that.refresh()},isAndroid?500:0)},_pos:function(x,y){x=this.hScroll?x:0,y=this.vScroll?y:0,this.options.useTransform?this.scroller.style[vendor+"Transform"]=trnOpen+x+"px,"+y+"px"+trnClose+" scale("+this.scale+")":(x=mround(x),y=mround(y),this.scroller.style.left=x+"px",this.scroller.style.top=y+"px"),this.x=x,this.y=y,this._scrollbarPos("h"),this._scrollbarPos("v")},_scrollbarPos:function(dir,hidden){var that=this,pos=dir=="h"?that.x:that.y,size;if(!that[dir+"Scrollbar"])return;pos=that[dir+"ScrollbarProp"]*pos,pos<0?(that.options.fixedScrollbar||(size=that[dir+"ScrollbarIndicatorSize"]+mround(pos*3),size<8&&(size=8),that[dir+"ScrollbarIndicator"].style[dir=="h"?"width":"height"]=size+"px"),pos=0):pos>that[dir+"ScrollbarMaxScroll"]&&(that.options.fixedScrollbar?pos=that[dir+"ScrollbarMaxScroll"]:(size=that[dir+"ScrollbarIndicatorSize"]-mround((pos-that[dir+"ScrollbarMaxScroll"])*3),size<8&&(size=8),that[dir+"ScrollbarIndicator"].style[dir=="h"?"width":"height"]=size+"px",pos=that[dir+"ScrollbarMaxScroll"]+(that[dir+"ScrollbarIndicatorSize"]-size))),that[dir+"ScrollbarWrapper"].style[vendor+"TransitionDelay"]="0",that[dir+"ScrollbarWrapper"].style.opacity=hidden&&that.options.hideScrollbar?"0":"1",that[dir+"ScrollbarIndicator"].style[vendor+"Transform"]=trnOpen+(dir=="h"?pos+"px,0":"0,"+pos+"px")+trnClose},_start:function(e){var that=this,point=hasTouch?e.touches[0]:e,matrix,x,y,c1,c2;if(!that.enabled)return;that.options.onBeforeScrollStart&&that.options.onBeforeScrollStart.call(that,e),(that.options.useTransition||that.options.zoom)&&that._transitionTime(0),that.moved=!1,that.animating=!1,that.zoomed=!1,that.distX=0,that.distY=0,that.absDistX=0,that.absDistY=0,that.dirX=0,that.dirY=0,that.options.zoom&&hasTouch&&e.touches.length>1&&(c1=m.abs(e.touches[0].pageX-e.touches[1].pageX),c2=m.abs(e.touches[0].pageY-e.touches[1].pageY),that.touchesDistStart=m.sqrt(c1*c1+c2*c2),that.originX=m.abs(e.touches[0].pageX+e.touches[1].pageX-that.wrapperOffsetLeft*2)/2-that.x,that.originY=m.abs(e.touches[0].pageY+e.touches[1].pageY-that.wrapperOffsetTop*2)/2-that.y,that.options.onZoomStart&&that.options.onZoomStart.call(that,e));if(that.options.momentum){that.options.useTransform?(matrix=getComputedStyle(that.scroller,null)[vendor+"Transform"].replace(/[^0-9-.,]/g,"").split(","),x=matrix[4]*1,y=matrix[5]*1):(x=getComputedStyle(that.scroller,null).left.replace(/[^0-9-]/g,"")*1,y=getComputedStyle(that.scroller,null).top.replace(/[^0-9-]/g,"")*1);if(x!=that.x||y!=that.y)that.options.useTransition?that._unbind("webkitTransitionEnd"):cancelFrame(that.aniTime),that.steps=[],that._pos(x,y)}that.absStartX=that.x,that.absStartY=that.y,that.startX=that.x,that.startY=that.y,that.pointX=point.pageX,that.pointY=point.pageY,that.startTime=e.timeStamp||Date.now(),that.options.onScrollStart&&that.options.onScrollStart.call(that,e),that._bind(MOVE_EV),that._bind(END_EV),that._bind(CANCEL_EV)},_move:function(e){var that=this,point=hasTouch?e.touches[0]:e,deltaX=point.pageX-that.pointX,deltaY=point.pageY-that.pointY,newX=that.x+deltaX,newY=that.y+deltaY,c1,c2,scale,timestamp=e.timeStamp||Date.now();that.options.onBeforeScrollMove&&that.options.onBeforeScrollMove.call(that,e);if(that.options.zoom&&hasTouch&&e.touches.length>1){c1=m.abs(e.touches[0].pageX-e.touches[1].pageX),c2=m.abs(e.touches[0].pageY-e.touches[1].pageY),that.touchesDist=m.sqrt(c1*c1+c2*c2),that.zoomed=!0,scale=1/that.touchesDistStart*that.touchesDist*this.scale,scale<that.options.zoomMin?scale=.5*that.options.zoomMin*Math.pow(2,scale/that.options.zoomMin):scale>that.options.zoomMax&&(scale=2*that.options.zoomMax*Math.pow(.5,that.options.zoomMax/scale)),that.lastScale=scale/this.scale,newX=this.originX-this.originX*that.lastScale+this.x,newY=this.originY-this.originY*that.lastScale+this.y,this.scroller.style[vendor+"Transform"]=trnOpen+newX+"px,"+newY+"px"+trnClose+" scale("+scale+")",that.options.onZoom&&that.options.onZoom.call(that,e);return}that.pointX=point.pageX,that.pointY=point.pageY;if(newX>0||newX<that.maxScrollX)newX=that.options.bounce?that.x+deltaX/2:newX>=0||that.maxScrollX>=0?0:that.maxScrollX;if(newY>that.minScrollY||newY<that.maxScrollY)newY=that.options.bounce?that.y+deltaY/2:newY>=that.minScrollY||that.maxScrollY>=0?that.minScrollY:that.maxScrollY;that.distX+=deltaX,that.distY+=deltaY,that.absDistX=m.abs(that.distX),that.absDistY=m.abs(that.distY);if(that.absDistX<6&&that.absDistY<6)return;that.options.lockDirection&&(that.absDistX>that.absDistY+5?(newY=that.y,deltaY=0):that.absDistY>that.absDistX+5&&(newX=that.x,deltaX=0)),that.moved=!0,that._pos(newX,newY),that.dirX=deltaX>0?-1:deltaX<0?1:0,that.dirY=deltaY>0?-1:deltaY<0?1:0,timestamp-that.startTime>300&&(that.startTime=timestamp,that.startX=that.x,that.startY=that.y),that.options.onScrollMove&&that.options.onScrollMove.call(that,e)},_end:function(e){if(hasTouch&&e.touches.length!=0)return;var that=this,point=hasTouch?e.changedTouches[0]:e,target,ev,momentumX={dist:0,time:0},momentumY={dist:0,time:0},duration=(e.timeStamp||Date.now())-that.startTime,newPosX=that.x,newPosY=that.y,distX,distY,newDuration,snap,scale;that._unbind(MOVE_EV),that._unbind(END_EV),that._unbind(CANCEL_EV),that.options.onBeforeScrollEnd&&that.options.onBeforeScrollEnd.call(that,e);if(that.zoomed){scale=that.scale*that.lastScale,scale=Math.max(that.options.zoomMin,scale),scale=Math.min(that.options.zoomMax,scale),that.lastScale=scale/that.scale,that.scale=scale,that.x=that.originX-that.originX*that.lastScale+that.x,that.y=that.originY-that.originY*that.lastScale+that.y,that.scroller.style[vendor+"TransitionDuration"]="200ms",that.scroller.style[vendor+"Transform"]=trnOpen+that.x+"px,"+that.y+"px"+trnClose+" scale("+that.scale+")",that.zoomed=!1,that.refresh(),that.options.onZoomEnd&&that.options.onZoomEnd.call(that,e);return}if(!that.moved){hasTouch&&(that.doubleTapTimer&&that.options.zoom?(clearTimeout(that.doubleTapTimer),that.doubleTapTimer=null,that.options.onZoomStart&&that.options.onZoomStart.call(that,e),that.zoom(that.pointX,that.pointY,that.scale==1?that.options.doubleTapZoom:1),that.options.onZoomEnd&&setTimeout(function(){that.options.onZoomEnd.call(that,e)},200)):that.doubleTapTimer=setTimeout(function(){that.doubleTapTimer=null,target=point.target;while(target.nodeType!=1)target=target.parentNode;target.tagName!="SELECT"&&target.tagName!="INPUT"&&target.tagName!="TEXTAREA"&&(ev=document.createEvent("MouseEvents"),ev.initMouseEvent("click",!0,!0,e.view,1,point.screenX,point.screenY,point.clientX,point.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),ev._fake=!0,target.dispatchEvent(ev))},that.options.zoom?250:0)),that._resetPos(200),that.options.onTouchEnd&&that.options.onTouchEnd.call(that,e);return}if(duration<300&&that.options.momentum){momentumX=newPosX?that._momentum(newPosX-that.startX,duration,-that.x,that.scrollerW-that.wrapperW+that.x,that.options.bounce?that.wrapperW:0):momentumX,momentumY=newPosY?that._momentum(newPosY-that.startY,duration,-that.y,that.maxScrollY<0?that.scrollerH-that.wrapperH+that.y-that.minScrollY:0,that.options.bounce?that.wrapperH:0):momentumY,newPosX=that.x+momentumX.dist,newPosY=that.y+momentumY.dist;if(that.x>0&&newPosX>0||that.x<that.maxScrollX&&newPosX<that.maxScrollX)momentumX={dist:0,time:0};if(that.y>that.minScrollY&&newPosY>that.minScrollY||that.y<that.maxScrollY&&newPosY<that.maxScrollY)momentumY={dist:0,time:0}}if(momentumX.dist||momentumY.dist){newDuration=m.max(m.max(momentumX.time,momentumY.time),10),that.options.snap&&(distX=newPosX-that.absStartX,distY=newPosY-that.absStartY,m.abs(distX)<that.options.snapThreshold&&m.abs(distY)<that.options.snapThreshold?that.scrollTo(that.absStartX,that.absStartY,200):(snap=that._snap(newPosX,newPosY),newPosX=snap.x,newPosY=snap.y,newDuration=m.max(snap.time,newDuration))),that.scrollTo(mround(newPosX),mround(newPosY),newDuration),that.options.onTouchEnd&&that.options.onTouchEnd.call(that,e);return}if(that.options.snap){distX=newPosX-that.absStartX,distY=newPosY-that.absStartY,m.abs(distX)<that.options.snapThreshold&&m.abs(distY)<that.options.snapThreshold?that.scrollTo(that.absStartX,that.absStartY,200):(snap=that._snap(that.x,that.y),(snap.x!=that.x||snap.y!=that.y)&&that.scrollTo(snap.x,snap.y,snap.time)),that.options.onTouchEnd&&that.options.onTouchEnd.call(that,e);return}that._resetPos(200),that.options.onTouchEnd&&that.options.onTouchEnd.call(that,e)},_resetPos:function(time){var that=this,resetX=that.x>=0?0:that.x<that.maxScrollX?that.maxScrollX:that.x,resetY=that.y>=that.minScrollY||that.maxScrollY>0?that.minScrollY:that.y<that.maxScrollY?that.maxScrollY:that.y;if(resetX==that.x&&resetY==that.y){that.moved&&(that.moved=!1,that.options.onScrollEnd&&that.options.onScrollEnd.call(that)),that.hScrollbar&&that.options.hideScrollbar&&(vendor=="webkit"&&(that.hScrollbarWrapper.style[vendor+"TransitionDelay"]="300ms"),that.hScrollbarWrapper.style.opacity="0"),that.vScrollbar&&that.options.hideScrollbar&&(vendor=="webkit"&&(that.vScrollbarWrapper.style[vendor+"TransitionDelay"]="300ms"),that.vScrollbarWrapper.style.opacity="0");return}that.scrollTo(resetX,resetY,time||0)},_wheel:function(e){var that=this,wheelDeltaX,wheelDeltaY,deltaX,deltaY,deltaScale;if("wheelDeltaX"in e)wheelDeltaX=e.wheelDeltaX/12,wheelDeltaY=e.wheelDeltaY/12;else if("wheelDelta"in e)wheelDeltaX=wheelDeltaY=e.wheelDelta/12;else{if(!("detail"in e))return;wheelDeltaX=wheelDeltaY=-e.detail*3}if(that.options.wheelAction=="zoom"){deltaScale=that.scale*Math.pow(2,1/3*(wheelDeltaY?wheelDeltaY/Math.abs(wheelDeltaY):0)),deltaScale<that.options.zoomMin&&(deltaScale=that.options.zoomMin),deltaScale>that.options.zoomMax&&(deltaScale=that.options.zoomMax),deltaScale!=that.scale&&(!that.wheelZoomCount&&that.options.onZoomStart&&that.options.onZoomStart.call(that,e),that.wheelZoomCount++,that.zoom(e.pageX,e.pageY,deltaScale,400),setTimeout(function(){that.wheelZoomCount--,!that.wheelZoomCount&&that.options.onZoomEnd&&that.options.onZoomEnd.call(that,e)},400));return}deltaX=that.x+wheelDeltaX,deltaY=that.y+wheelDeltaY,deltaX>0?deltaX=0:deltaX<that.maxScrollX&&(deltaX=that.maxScrollX),deltaY>that.minScrollY?deltaY=that.minScrollY:deltaY<that.maxScrollY&&(deltaY=that.maxScrollY),that.scrollTo(deltaX,deltaY,0)},_mouseout:function(e){var t=e.relatedTarget;if(!t){this._end(e);return}while(t=t.parentNode)if(t==this.wrapper)return;this._end(e)},_transitionEnd:function(e){var that=this;if(e.target!=that.scroller)return;that._unbind("webkitTransitionEnd"),that._startAni()},_startAni:function(){var that=this,startX=that.x,startY=that.y,startTime=Date.now(),step,easeOut,animate;if(that.animating)return;if(!that.steps.length){that._resetPos(400);return}step=that.steps.shift(),step.x==startX&&step.y==startY&&(step.time=0),that.animating=!0,that.moved=!0;if(that.options.useTransition){that._transitionTime(step.time),that._pos(step.x,step.y),that.animating=!1,step.time?that._bind("webkitTransitionEnd"):that._resetPos(0);return}animate=function(){var now=Date.now(),newX,newY;if(now>=startTime+step.time){that._pos(step.x,step.y),that.animating=!1,that.options.onAnimationEnd&&that.options.onAnimationEnd.call(that),that._startAni();return}now=(now-startTime)/step.time-1,easeOut=m.sqrt(1-now*now),newX=(step.x-startX)*easeOut+startX,newY=(step.y-startY)*easeOut+startY,that._pos(newX,newY),that.animating&&(that.aniTime=nextFrame(animate))},animate()},_transitionTime:function(time){time+="ms",this.scroller.style[vendor+"TransitionDuration"]=time,this.hScrollbar&&(this.hScrollbarIndicator.style[vendor+"TransitionDuration"]=time),this.vScrollbar&&(this.vScrollbarIndicator.style[vendor+"TransitionDuration"]=time)},_momentum:function(dist,time,maxDistUpper,maxDistLower,size){var deceleration=6e-4,speed=m.abs(dist)/time,newDist=speed*speed/(2*deceleration),newTime=0,outsideDist=0;return dist>0&&newDist>maxDistUpper?(outsideDist=size/(6/(newDist/speed*deceleration)),maxDistUpper+=outsideDist,speed=speed*maxDistUpper/newDist,newDist=maxDistUpper):dist<0&&newDist>maxDistLower&&(outsideDist=size/(6/(newDist/speed*deceleration)),maxDistLower+=outsideDist,speed=speed*maxDistLower/newDist,newDist=maxDistLower),newDist*=dist<0?-1:1,newTime=speed/deceleration,{dist:newDist,time:mround(newTime)}},_offset:function(el){var left=-el.offsetLeft,top=-el.offsetTop;while(el=el.offsetParent)left-=el.offsetLeft,top-=el.offsetTop;return el!=this.wrapper&&(left*=this.scale,top*=this.scale),{left:left,top:top}},_snap:function(x,y){var that=this,i,l,page,time,sizeX,sizeY;page=that.pagesX.length-1;for(i=0,l=that.pagesX.length;i<l;i++)if(x>=that.pagesX[i]){page=i;break}page==that.currPageX&&page>0&&that.dirX<0&&page--,x=that.pagesX[page],sizeX=m.abs(x-that.pagesX[that.currPageX]),sizeX=sizeX?m.abs(that.x-x)/sizeX*500:0,that.currPageX=page,page=that.pagesY.length-1;for(i=0;i<page;i++)if(y>=that.pagesY[i]){page=i;break}return page==that.currPageY&&page>0&&that.dirY<0&&page--,y=that.pagesY[page],sizeY=m.abs(y-that.pagesY[that.currPageY]),sizeY=sizeY?m.abs(that.y-y)/sizeY*500:0,that.currPageY=page,time=mround(m.max(sizeX,sizeY))||200,{x:x,y:y,time:time}},_bind:function(type,el,bubble){(el||this.scroller).addEventListener(type,this,!!bubble)},_unbind:function(type,el,bubble){(el||this.scroller).removeEventListener(type,this,!!bubble)},destroy:function(){var that=this;that.scroller.style[vendor+"Transform"]="",that.hScrollbar=!1,that.vScrollbar=!1,that._scrollbar("h"),that._scrollbar("v"),that._unbind(RESIZE_EV,window),that._unbind(START_EV),that._unbind(MOVE_EV),that._unbind(END_EV),that._unbind(CANCEL_EV),that.options.hasTouch||(that._unbind("mouseout",that.wrapper),that._unbind(WHEEL_EV)),that.options.useTransition&&that._unbind("webkitTransitionEnd"),that.options.checkDOMChanges&&clearInterval(that.checkDOMTime),that.options.onDestroy&&that.options.onDestroy.call(that)},refresh:function(){var that=this,offset,i,l,els,pos=0,page=0;that.scale<that.options.zoomMin&&(that.scale=that.options.zoomMin),that.wrapperW=that.wrapper.clientWidth||1,that.wrapperH=that.wrapper.clientHeight||1,that.minScrollY=-that.options.topOffset||0,that.scrollerW=mround(that.scroller.offsetWidth*that.scale),that.scrollerH=mround((that.scroller.offsetHeight+that.minScrollY)*that.scale),that.maxScrollX=that.wrapperW-that.scrollerW,that.maxScrollY=that.wrapperH-that.scrollerH+that.minScrollY,that.dirX=0,that.dirY=0,that.options.onRefresh&&that.options.onRefresh.call(that),that.hScroll=that.options.hScroll&&that.maxScrollX<0,that.vScroll=that.options.vScroll&&(!that.options.bounceLock&&!that.hScroll||that.scrollerH>that.wrapperH),that.hScrollbar=that.hScroll&&that.options.hScrollbar,that.vScrollbar=that.vScroll&&that.options.vScrollbar&&that.scrollerH>that.wrapperH,offset=that._offset(that.wrapper),that.wrapperOffsetLeft=-offset.left,that.wrapperOffsetTop=-offset.top;if(typeof that.options.snap=="string"){that.pagesX=[],that.pagesY=[],els=that.scroller.querySelectorAll(that.options.snap);for(i=0,l=els.length;i<l;i++)pos=that._offset(els[i]),pos.left+=that.wrapperOffsetLeft,pos.top+=that.wrapperOffsetTop,that.pagesX[i]=pos.left<that.maxScrollX?that.maxScrollX:pos.left*that.scale,that.pagesY[i]=pos.top<that.maxScrollY?that.maxScrollY:pos.top*that.scale}else if(that.options.snap){that.pagesX=[];while(pos>=that.maxScrollX)that.pagesX[page]=pos,pos-=that.wrapperW,page++;that.maxScrollX%that.wrapperW&&(that.pagesX[that.pagesX.length]=that.maxScrollX-that.pagesX[that.pagesX.length-1]+that.pagesX[that.pagesX.length-1]),pos=0,page=0,that.pagesY=[];while(pos>=that.maxScrollY)that.pagesY[page]=pos,pos-=that.wrapperH,page++;that.maxScrollY%that.wrapperH&&(that.pagesY[that.pagesY.length]=that.maxScrollY-that.pagesY[that.pagesY.length-1]+that.pagesY[that.pagesY.length-1])}that._scrollbar("h"),that._scrollbar("v"),that.zoomed||(that.scroller.style[vendor+"TransitionDuration"]="0",that._resetPos(200))},scrollTo:function(x,y,time,relative){var that=this,step=x,i,l;that.stop(),step.length||(step=[{x:x,y:y,time:time,relative:relative}]);for(i=0,l=step.length;i<l;i++)step[i].relative&&(step[i].x=that.x-step[i].x,step[i].y=that.y-step[i].y),that.steps.push({x:step[i].x,y:step[i].y,time:step[i].time||0});that._startAni()},scrollToElement:function(el,time){var that=this,pos;el=el.nodeType?el:that.scroller.querySelector(el);if(!el)return;pos=that._offset(el),pos.left+=that.wrapperOffsetLeft,pos.top+=that.wrapperOffsetTop,pos.left=pos.left>0?0:pos.left<that.maxScrollX?that.maxScrollX:pos.left,pos.top=pos.top>that.minScrollY?that.minScrollY:pos.top<that.maxScrollY?that.maxScrollY:pos.top,time=time===undefined?m.max(m.abs(pos.left)*2,m.abs(pos.top)*2):time,that.scrollTo(pos.left,pos.top,time)},scrollToPage:function(pageX,pageY,time){var that=this,x,y;time=time===undefined?400:time,that.options.onScrollStart&&that.options.onScrollStart.call(that),that.options.snap?(pageX=pageX=="next"?that.currPageX+1:pageX=="prev"?that.currPageX-1:pageX,pageY=pageY=="next"?that.currPageY+1:pageY=="prev"?that.currPageY-1:pageY,pageX=pageX<0?0:pageX>that.pagesX.length-1?that.pagesX.length-1:pageX,pageY=pageY<0?0:pageY>that.pagesY.length-1?that.pagesY.length-1:pageY,that.currPageX=pageX,that.currPageY=pageY,x=that.pagesX[pageX],y=that.pagesY[pageY]):(x=-that.wrapperW*pageX,y=-that.wrapperH*pageY,x<that.maxScrollX&&(x=that.maxScrollX),y<that.maxScrollY&&(y=that.maxScrollY)),that.scrollTo(x,y,time)},disable:function(){this.stop(),this._resetPos(0),this.enabled=!1,this._unbind(MOVE_EV),this._unbind(END_EV),this._unbind(CANCEL_EV)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind("webkitTransitionEnd"):cancelFrame(this.aniTime),this.steps=[],this.moved=!1,this.animating=!1},zoom:function(x,y,scale,time){var that=this,relScale=scale/that.scale;if(!that.options.useTransform)return;that.zoomed=!0,time=time===undefined?200:time,x=x-that.wrapperOffsetLeft-that.x,y=y-that.wrapperOffsetTop-that.y,that.x=x-x*relScale+that.x,that.y=y-y*relScale+that.y,that.scale=scale,that.refresh(),that.x=that.x>0?0:that.x<that.maxScrollX?that.maxScrollX:that.x,that.y=that.y>that.minScrollY?that.minScrollY:that.y<that.maxScrollY?that.maxScrollY:that.y,that.scroller.style[vendor+"TransitionDuration"]=time+"ms",that.scroller.style[vendor+"Transform"]=trnOpen+that.x+"px,"+that.y+"px"+trnClose+" scale("+scale+")",that.zoomed=!1},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}},iScroll});
define("http://a.tbcdn.cn/mw/webapp/fav/module/favSwipetop.js",["zepto","iscroll","../../../../base/modules/swipetop/swipetop","../../../../base/modules/swipetop/swipetopTab","../../../../base/modules/taojia/taojia","./server/fav_url","../../../../base/utils/server/h5_common","../../../../base/utils/server/mtop_ajax"],function(require,exports,module){var $=require("zepto"),iScroll=require("iscroll"),swipetop=require("../../../../base/modules/swipetop/swipetop"),swipetopTab=require("../../../../base/modules/swipetop/swipetopTab"),taojia=require("../../../../base/modules/taojia/taojia"),favUrl=require("./server/fav_url"),favComm=require("../../../../base/utils/server/h5_common"),mtopAjax=require("../../../../base/utils/server/mtop_ajax");return new swipetop({isInit:!1,type:"goods",typeDesc:"宝贝分类",topEl:"swipetop",tabCont:"swipetop-cont",category:"J_favCategory",wrap:"J_scroller",lisel:"highlight",scrollArr:["swipetop-goods","swipetop-love"],taojia:taojia,apiMethods:{goodsCat:"queryColGoodCateFilter",goodsTag:"queryColGoodTagFilter",shopCat:"queryColShopCatFilter",shopTag:"queryColShopTagFilter"}},{getMethod:function(MethodType){var that=this,op=that.op;return op.apiMethods[op.type+MethodType]},setClearExOpts:function(exOptions){var that=this,op=that.op;if(op.type!=exOptions.type){var that=this,tempCache=that.topCache,isShow=tempCache.isShow;tempCache.isShow=!1,that.tabBody.set(0),$("#"+op.topEl+" .swipetop-ul li").removeAttr("ajax")}$.extend(op,exOptions)},postdata:function(n,method,tabType,eventType,seltype){var that=this,op=that.op,n=n?parseInt(n,10):0,tabo=document.getElementById(op.scrollArr[n]).firstElementChild,params={method:method,trigerType:eventType||"click"},url=function(){return favUrl.getUrl("api",params)};tabo.innerHTML='<p class="c-loading loader-dark"><span></span></p>',mtopAjax.get(url(),params,function(res){favComm.dealResponse(res,function(res){that.catagoryShow.call(that,res.data,n,tabType,seltype)},function(err){tabo.innerHTML='<p class="busy">系统繁忙，请稍后再试！<a class="btn-grey-small">重 试</a></p>',$(tabo).find(".btn-grey-small").bind("click",function(){that.postdata(n,method,tabType,eventType,seltype)})},"fav")},function(err){tabo.innerHTML='<p class="busy">系统繁忙，请稍后再试！<a class="btn-grey-small">重 试</a></p>',$(tabo).find(".btn-grey-small").bind("click",function(){that.postdata(n,method,tabType,eventType,seltype)})})},linka:function(method,str){var params={method:method,trigerType:str?str:"click"};favUrl.monitor(params)},catagoryShow:function(data,index,tabType,seltype){var that=this,op=that.op,type=op.type,arr=data.result,len=arr.length,tabo=document.getElementById(op.scrollArr[index]).firstElementChild,sdata="",tiptext=index!=0?"您没有设置标签":"没有分类",catagoryname;if(len<1)sdata="<p>"+tiptext+"</p>";else{sdata='<ul class="c-list-ext-group">';var href="#!"+type+"/"+(type=="goods"?"queryColGood":"queryColShop")+"-"+tabType+"|";index==0&&(sdata+="<li",seltype||(sdata+=' class="highlight"'),sdata+='><a href="#!'+type+'" ><label><em><img src="http://a.tbcdn.cn/mw/webapp/fav/img/icon/c-0.png" width="30" /></em><span>全部分类</span></label></a></li>');for(var i=0;i<len;i++){catagoryname=arr[i].value;var idName=arr[i].id;index==1&&(idName=catagoryname),sdata+="<li",seltype&&seltype==idName&&(sdata+=' class="highlight"'),sdata+='><a href="'+href+idName+"-1-0"+'" ><label>',index==0&&(sdata+='<em><img src="http://a.tbcdn.cn/mw/webapp/fav/img/icon/c-',sdata+=arr[i].id+'.png" width="30" /></em>'),sdata+="<span>",sdata+=(catagoryname.length>16?catagoryname.substring(0,16)+"..":catagoryname)+"("+arr[i].count+")</span></label></a></li>"}sdata+="</ul>"}catagoryname=null,tabo.innerHTML=sdata,this["tab"+index].refresh();var lisel=op.lisel;$(tabo).find("li."+lisel)[0]&&(that.swipetoplisel=$(tabo).find("li."+lisel))},swipeDown:function(scrol){var that=this,op=that.op,tagType,firstLi=$("#"+op.topEl+" .c-tab li.cur");firstLi.text(op.typeDesc),op.allType&&op.allType.indexOf("|")!=-1&&(tagType=op.allType.split("|"),tagType[0]!="cateId"&&(firstLi=firstLi.next(),that.tabBody.set(1),$("#"+op.topEl+" .swipetop-ul li").removeAttr("ajax")));if(!firstLi.attr("ajax")){var typen=tagType&&tagType[0]=="tag";that.postdata(typen?1:0,that.getMethod(typen?"Tag":"Cat"),typen?"tag":"cateId",scrol,tagType&&tagType[1]),firstLi.attr("ajax",!0)}else that.linka(that.getMethod("Cat"),scrol)},tiggerFunc:function(){var that=this,op=that.op;document.getElementById(op.tabCont).onclick=function(e){var curEl=e.target,swipetoplisel=that.swipetoplisel,favScroll=op.favScroll,lisel=op.lisel;curEl=$(curEl).parents("li");if(!curEl[0])return;curEl.hasClass(lisel)||(curEl.addClass(lisel),swipetoplisel&&swipetoplisel[0]&&swipetoplisel.removeClass(lisel),that.swipetoplisel=curEl),that.hideTop("noAnimate","swipeBack"),favScroll&&favScroll.scrollTo(0,0)},$(op.scrollArr).each(function(n,item){that["tab"+n]=new iScroll(item,{hideScrollbar:!1,scrollbarClass:"swipeScrollbar"})}),that.tabBody=new swipetopTab({touchEl:".c-tab",cls:"cur",otherCallback:function(n){var typen=n&&n!=0?"Tag":"Cat",tabn=n&&n!=0?"tag":"cateId",allType=op.allType,tagType=allType&&allType.indexOf("|")!=-1?allType.split("|"):null;that.postdata(n,that.getMethod(typen),tabn,null,tagType&&tagType[1])},otherlinka:function(n){var typen=n&&n!=0?"Tag":"Cat";that.linka(that.getMethod(typen),"tab")}})}})});
define("http://a.tbcdn.cn/base/modules/swipetop/swipetop.js",["zepto","./swipetopTouch"],function(require,exports,module){var $=require("zepto"),swipetopTouch=require("./swipetopTouch");return $.swipeTop=function(options,self){var doc=document,op={isInit:!0,wrap:"",topEl:"ttype",header:"header",shade:"J_shade",hShade:"h-Shade",scrollArr:null,favScroll:null,swipeTopGap:60,ease:"ease",easetime:500,opacity:.1,isSwipeDown:!1,toptabHeight:50,headerHeight:50,surplusHeight:80};options&&$.extend(op,options),self&&$.extend(this,self),this.op=op,this.wrap=doc.getElementById(op.wrap);var tempwt=doc.getElementById(op.topEl);this.swipeTop=tempwt?$(tempwt):null,this.header=doc.getElementById(op.header),this.shade=$(doc.getElementById(op.shade)),this.hShade=$(doc.getElementById(op.hShade)),this.wrap.style.cssText="position:relative";var header=$(this.header);divt=$(document.createElement("div")),divt.css({height:op.headerHeight}),header.after(divt),this.notop=!1,this.swipeTop?(header.addClass("header"),header.appendTo(this.swipeTop)):(this.swipeTop=header,this.swipeTop.css({position:"absolute","z-index":118}),this.notop=!0),this.topCache={isSlip:0,isShow:!1,shadeShow:!1,isScroll:!1},op.isInit&&this.init()},$.extend($.swipeTop.prototype,{setOp:function(key,value){if(typeof key=="string")this.op[key]=value;else for(var k in key)this.op[k]=key[k]},createShade:function(){var that=this,op=that.op,swipeTop=that.swipeTop,header=that.header,shade,hShade,doc=document;doc.getElementById(op.shade)||(shade=$(doc.createElement("div")),shade.attr("id","J_shade"),shade.addClass("J_shade"),shade.appendTo(swipeTop.parent()),that.shade=shade,that.shadeTouch(shade)),!doc.getElementById(op.hShade)&&!that.notop&&(hShade=$(doc.createElement("div")),hShade.attr("id","h-Shade"),hShade.addClass("h_shade"),hShade.appendTo(header),hShade.css("height",op.headerHeight),that.hShade=hShade,that.shadeTouch(hShade))},init:function(scrolls){var that=this,op=that.op;op.favScroll=scrolls||null,that.initHeight(1),that.triggerEvent();var resize="onorientationchange"in window?"orientationchange":"resize",isAndroid=/android/gi.test(navigator.appVersion);op.scrollArr&&window.addEventListener(resize,function(){setTimeout(function(){that.initHeight();if(op.scrollArr.length>0){var nitem=null;$(op.scrollArr).each(function(n,item){nitem=$("#"+item),nitem.hasClass("none")?nitem.parent().prev().find("li:not(.sel)").removeAttr("ajax"):that["tab"+n]&&that["tab"+n].refresh()})}},isAndroid?500:0)},!1),document.addEventListener("touchmove",function(e){var bounce=document.body.getAttribute("bounce");if(bounce){e.preventDefault();return}},!1)},initHeight:function(n){var that=this,op=that.op,swipeTop=that.swipeTop,win=$(window),m=that.getScroll(),tempCache=that.topCache,isShow=tempCache.isShow,toptabHeight=op.toptabHeight,headerHeight=op.headerHeight,surplusHeight=op.surplusHeight,bodyHeight=win.height();bodyHeight=bodyHeight>380?380:bodyHeight;var newHeight=bodyHeight-surplusHeight+headerHeight,ntop=this.ntop=-newHeight,nstep=this.nstep=newHeight;that.notop&&(newHeight=headerHeight,ntop=this.ntop=-50,this.op.isSwipeDown=!1);var cssJson={height:newHeight,width:"100%"},temptop=ntop,transy=headerHeight,mingun=Math.min(headerHeight,m);n||(m>0&&tempCache.isSlip==1&&(transy+=mingun,m>headerHeight&&(temptop+=m-headerHeight)),isShow&&(transy=nstep+mingun)),cssJson.top=temptop,cssJson["-webkit-transform"]="translate(0,"+transy+"px)",swipeTop.css(cssJson)},showShade:function(){var that=this,hShade=that.hShade;that.topCache.shadeShow||that.showSingleShade(),hShade[0].style.cssText="opacity:"+that.op.opacity+";display:block"},showSingleShade:function(){var that=this,shade=this.shade;shade[0].style.cssText="opacity:"+that.op.opacity+";display:block"},editCategory:function(str){var that=this,header=$(that.header.firstElementChild);if(header.length==0)return;str=="remove"?header.removeClass("c-inav-down"):str=="add"&&header.addClass("c-inav-down")},editScroll:function(bool){var that=this,favScroll=that.op.favScroll;if(!favScroll){var nbody=document.body;bool?nbody.removeAttribute("bounce"):nbody.setAttribute("bounce",1);return}favScroll.enabled=bool},getScroll:function(n){var that=this,favScroll=that.op.favScroll,result=0;return favScroll?result=favScroll.y:result=document.body.scrollTop,result=n||result,Math.abs(result)},swipeAni:function(str,callback){var that=this,op=that.op,swipeTop=that.swipeTop,top=str||0;top+="px",swipeTop.animate({translateY:top},op.easetime,op.ease,function(){callback&&callback.call(this)})},hidetab:function(str){var that=this,op=that.op;if(that.tab0&&that.tabBody&&op.scrollArr){var ind=that.tabBody.index,scrol=$("#"+op.scrollArr[ind]);str?scrol.removeClass("none"):scrol.addClass("none")}},hideTop:function(str){var that=this,op=that.op,wrap=that.wrap,swipeTop=that.swipeTop,shade=that.shade,hShade=that.hShade,ntop=that.ntop,headerHeight=op.headerHeight,tdis=parseInt(swipeTop.css("top"),10)-ntop+headerHeight,tempCache=that.topCache;str&&str=="noAnimate"?(swipeTop.css({"-webkit-transform":"translate(0,"+headerHeight+"px)",top:ntop}),that.hidetab()):tdis>headerHeight?swipeTop.width()==0?swipeTop.css({"-webkit-transform":"translate(0,"+headerHeight+"px)",top:ntop}):that.swipeAni(headerHeight,function(){this.style.top=ntop+"px",that.hidetab()}):that.swipeAni(headerHeight,function(){that.hidetab()}),shade[0].style.display="none",that.editScroll(!0),tempCache.isSlip=2,tempCache.shadeShow||(hShade[0].style.display="none",tempCache.isShow=!1,that.editCategory("remove")),tempCache.shadeShow=!1;if(str&&str=="taojia")return;var taojia=op.taojia;taojia&&(taojia.st()==2?taojia.circlHide():taojia.taojiaShow())},showTop:function(n,scrol){var doc=document,that=this,op=that.op,wrap=that.wrap,swipeTop=that.swipeTop,ntop=that.ntop,tempCache=that.topCache,isShow=tempCache.isShow,istop=n&&typeof n=="number"?!0:!1,nstep=that.nstep;that.createShade();if(!isShow){that.editScroll(!1);var fy=that.getScroll(n),headerHeight=op.headerHeight,transy=Math.min(op.headerHeight,fy);istop&&(nstep-=headerHeight),that.swipeAni(nstep+transy),tempCache.isShow=!0,that.editCategory("add"),that.showShade(),that.swipeDown&&that.swipeDown(scrol),op.taojia&&op.taojia.taojiaHide(),tempCache.shadeShow&&(tempCache.shadeShow=!1),that.hidetab(!0)}else that.hideTop()},tapDown:function(){var that=this,swipeTop=that.swipeTop,tempCache=that.topCache,op=that.op,ntop=that.ntop,headerHeight=op.headerHeight,header=that.header;if(tempCache.isScroll)return;var offy=that.getScroll(),toph=offy+ntop,temptop=toph-headerHeight,transy=headerHeight+Math.min(headerHeight,offy);if(tempCache.isSlip==1){that.hideTop("taojia");return}toph>ntop&&offy>headerHeight&&swipeTop.css("top",temptop),toph>ntop&&that.swipeAni(transy),that.createShade(),that.showSingleShade(),tempCache.isSlip=1,tempCache.shadeShow=!0,that.editScroll(!1)},shadeTouch:function(item){if(!item)return;var that=this;new swipetopTouch({el:item,limitDirection:"up",noTouchFun:function(){that.hideTop()},touchend:function(){that.hideTop()}})},triggerEvent:function(){var that=this;that.tiggerFunc&&that.tiggerFunc()}}),$.swipeTop});
define("http://a.tbcdn.cn/base/modules/swipetop/swipetopTouch.js",["zepto"],function(require,exports,module){var $=require("zepto");return $.swipeTopTouch=function(options){var op={el:null,direction:"y",limitDirection:"",limitLen:20,noTouchFun:null,touchmove:null,touchend:null};$.extend(op,options);if(!op.el)return;this.el=$(op.el)[0],this.op=op,this.isAndroid=/android/gi.test(navigator.appVersion),this._isTouch="ontouchstart"in window,this._touchstart="ontouchstart",this._touchmove="ontouchmove",this._touchend="ontouchend",this._isTouch||(this._touchstart="onmousedown",this._touchmove="onmousemove",this._touchend="onmouseup"),this.init()},$.extend($.swipeTopTouch.prototype,{init:function(){var that=this;that.el[that._touchstart]=function(e){that.start.call(that,e)}},getXY:function(e){var touchs=this._isTouch?e.touches[0]:e;return{x:touchs.pageX,y:touchs.pageY}},start:function(e){var that=this;that._coord=that.getXY(e),that.el[that._touchmove]=function(e){that.move.call(that,e)},that.el[that._touchend]=function(e){that.end.call(that,e)}},move:function(e){var that=this,op=that.op,dire=op.direction.toLowerCase();that._moveCoord=that.getXY(e);var newdisX=that._moveCoord.x-that._coord.x,newdisY=that._moveCoord.y-that._coord.y;dire=="x"?Math.abs(newdisX)-Math.abs(newdisY)>10&&(e.preventDefault(),that._movestart=!0):dire=="y"&&Math.abs(newdisY)-Math.abs(newdisX)>10&&(e.preventDefault(),that._movestart=!0,op.touchmove&&op.touchmove())},end:function(e){var that=this,op=that.op,dire=op.direction.toLowerCase(),limitDire=op.limitDirection.toLowerCase(),limitLen=op.limitLen,distance,isSure=!1;if(that._movestart){e.preventDefault(),distance=dire=="x"?that._moveCoord.x-that._coord.x:that._moveCoord.y-that._coord.y;switch(limitDire){case"down":case"left":distance>limitLen&&(isSure=!0);break;case"up":case"right":distance<-limitLen&&(isSure=!0);break;default:Math.abs(distance)>limitLen&&(isSure=!0)}isSure&&op.touchend&&op.touchend(e),that._movestart=!1,distance=null,isSure=null}else op.noTouchFun&&(e.preventDefault(),setTimeout(op.noTouchFun,that.isAndroid?500:0));that.el[that._touchmove]=null,that.el[that._touchend]=null,that._coord={},that._moveCoord={}}}),$.swipeTopTouch});
define("http://a.tbcdn.cn/base/modules/swipetop/swipetopTab.js",["zepto"],function(require,exports,module){var $=require("zepto");return $.swipeTopTab=function(options){var op=this.op={cls:"sel",hideCls:"none",tag:"li",otherCallback:null};$.extend(op,options),this.index=0,this.init()},$.extend($.swipeTopTab.prototype,{init:function(){var that=this,touchEl=$(that.op.touchEl),childs=that.childs=touchEl.find(that.op.tag),len=childs.length;if(len<2)return null;for(var i=0;i<len;i++)childs[i].si=i;if(!touchEl[0])return;touchEl[0].onclick=function(e){e.preventDefault(),that.set.call(that,e)}},set:function(e){var that=this,op=that.op,touchEl=$(op.touchEl),childs=that.childs,nextEl=touchEl.next(),nextChilds=nextEl.children(),isHand=typeof e=="number",curEl=isHand?childs[e]:e.target,newIndex=parseInt(curEl.si,10),cursel=childs[that.index];if(curEl.tagName.toLowerCase()!=op.tag)return;if(curEl==cursel)return;$(cursel).removeClass(op.cls),$(nextChilds[that.index]).addClass(op.hideCls),$(curEl).addClass(op.cls),$(nextChilds[newIndex]).removeClass(op.hideCls),that.index=newIndex;if(isHand)return;$(curEl).attr("ajax")?op.otherlinka&&op.otherlinka(newIndex):op.otherCallback&&($(curEl).attr("ajax",!0),op.otherCallback(newIndex))}}),$.swipeTopTab});
define("http://a.tbcdn.cn/base/modules/taojia/taojia.js",["zepto"],function(require,exports,module){var $=require("zepto"),TaoJia={},swipeTopSingle=null,timer=null,isCircle=!1;arr=[];var _generate=function(urls){var div='<div class="taojia" id="J_Taojia"><div class="taojia-icon on" data-time="0"></div><div class="taojia-main" data-total="" data-totalNew="" ><div class="circlbg"></div><ul class="icons"><li class="search"><a data-url="'+urls.s+'">1</a><span class="bg"></span></li><li class="car"><a data-url="'+urls.cart+'">2</a><span class="bg"></span></li><li class="individ"><a data-url="'+urls.my+'">3</a><span class="bg"></span></li><li class="ww"><a data-url="'+urls.im+'">4</a><span class="bg"></span></li><li class="logis"><a data-url="'+urls.home_wuliu+'">5</a><span class="bg"></span></li><li class="more"><a data-url="http://m.taobao.com">6</a><span class="bg"></span></li></ul><div class="biglogo on"><a data-url="'+urls.home+'">大logo</a><span class="biglogobg"></span></div></div></div>';$("#J_Container").append(div)},_switched=function(monitor){function circlHide2(){$("#J_Taojia .taojia-icon").removeClass("hide").addClass("on"),$("#J_Taojia .taojia-main").find(".show").removeClass("show"),$("#J_Taojia .taojia-main").find(".o").removeClass("o"),$("#J_Taojia .taojia-main").removeClass("show")}$(window).bind("resize",function(){$("#J_Taojia").css({left:"10px",bottom:"10px"})}),$("#J_Taojia .taojia-icon").click(function(){if(swipeTopSingle&&swipeTopSingle.topCache.isScroll)return;monitor&&monitor(TaoJia.st());var t=(new Date).getTime(),t2=Number($(this).attr("data-time"));t-t2>=600&&($(this).attr("data-time",t),swipeTopSingle&&swipeTopSingle.tapDown(),TaoJia.st()==1?TaoJia.circlBg(1):TaoJia.st()==2&&TaoJia.circlBg(0))}),$("#J_Taojia .biglogo a").click(function(e){var _Href=$(this).attr("data-url");timer=setTimeout(function(){circlHide2(),swipeTopSingle&&swipeTopSingle.tapDown(),window.location.href=_Href},500)}),$("#J_Taojia .icons a").click(function(e){var _Href=$(this).attr("data-url");timer=setTimeout(function(){circlHide2(),swipeTopSingle&&swipeTopSingle.tapDown(),window.location.href=_Href},500)})};return TaoJia.circlBg=function(st,str){function taojiaIconShow(){taojiaTouch.removeClass("hide").addClass("on")}function taojiaIconHide(){taojiaTouch.removeClass("on").addClass("hide")}function circlShow(){timer=setTimeout(circlAllShow,0),timer=setTimeout(circlBgShow,0),timer=setTimeout(circlIconShow,100),timer=setTimeout(circlLogoShow,300)}function circlHide(){timer=setTimeout(circlIconHide,0),timer=setTimeout(circlLogoHide,0),timer=setTimeout(circlBgHide,400),timer=setTimeout(circlAllHide,400)}function circlAllShow(){taojiaCircle.addClass("show")}function circlAllHide(){taojiaCircle.removeClass("show")}function circlBgShow(){circlBg.addClass("show")}function circlBgHide(){circlBg.removeClass("show")}function circlLogoShow(){circlLogo.addClass("show")}function circlLogoHide(){circlLogo.removeClass("show")}function circlIconShow(){var timer=null,speed=25,timer=setInterval(function(){var oIconShow=$("#J_Taojia .icons").find(".show"),oLi=$("#J_Taojia .icons li"),oA=$("#J_Taojia .icons").find("a"),oBgLi=$("#J_Taojia .backgrounds li"),oLS=oIconShow.size(),oLA=oA.size();oLS<=0?($(oLi[oLA-1]).removeClass("hide").addClass("show"),$(oBgLi[oLA-1]).removeClass("o").addClass("gray"),oA.removeClass("on")):oLS>0&&oLS<oLA?($(oLi[oLA-oLS-1]).removeClass("hide").addClass("show"),$(oBgLi[oLA-oLS-1]).removeClass("o").addClass("gray"),$(oBgLi[oLA-oLS-1]).siblings("li").removeClass("gray"),oA.removeClass("on")):oLS==oLA&&(oBgLi.removeClass("gray"),clearInterval(timer))},speed)}function circlIconHide(){var speed=25;timer=setInterval(function(){var oIconHIde=$("#J_Taojia .icons").find(".hide"),oLi=$("#J_Taojia .icons li"),oA=$("#J_Taojia .icons").find("a"),oBgLi=$("#J_Taojia .backgrounds li"),oLS=oIconHIde.size(),oLA=oA.size();oLS<=0?($(oLi[0]).removeClass("show").addClass("hide"),$(oBgLi[0]).removeClass("o").addClass("gray")):oLS>0&&oLS<oLA?($(oLi[oLS]).removeClass("show").addClass("hide"),$(oBgLi[oLS]).removeClass("o").addClass("gray"),$(oBgLi[oLS]).siblings("li").removeClass("gray")):oLS==oLA&&(oBgLi.removeClass("gray"),clearInterval(timer))},speed)}function circlHide2(){var timer=null,speed=20;timer=setTimeout(function(){taojiaTouch.removeClass("hide").addClass("on"),taojiaCircle.find(".show").removeClass("show"),taojiaCircle.find(".o").removeClass("o"),taojiaCircle.removeClass("show")},speed)}var taojiaDiv=$("#J_Taojia");taojiaTouch=taojiaDiv.find(".taojia-icon"),taojiaCircle=taojiaDiv.find(".taojia-main"),circlBg=taojiaDiv.find(".circlbg"),circlLogo=taojiaDiv.find(".biglogo"),taojiaLogo=taojiaDiv.find(".biglogo").find("a"),taojiaIcons=taojiaDiv.find(".icons").find("a"),taojiaIconBg=taojiaDiv.find(".backgrounds").find("li"),timer=null,num=0,$("body").hasClass("ios")?st==1?(circlShow(),taojiaIconHide()):st==0&&(circlHide(),taojiaIconShow()):st==1?(circlAllShow(),taojiaIconHide()):st==0&&(circlAllHide(),taojiaIconShow())},TaoJia.initialize=function(urls,obj,ios,monitor){_generate(urls),_switched(monitor),swipeTopSingle=obj,ios&&$("body").addClass("ios")},TaoJia.taojiaHide=function(){$("#J_Taojia").hide(),TaoJia.circlBg(0,"C")},TaoJia.taojiaShow=function(){$("#J_Taojia").show()},TaoJia.circlHide=function(){TaoJia.circlBg(0,"C")},TaoJia.st=function(){if($("#J_Taojia").attr("style")=="none")return 0;if($("#J_Taojia .taojia-icon").hasClass("on"))return 1;if($("#J_Taojia .taojia-icon").hasClass("hide"))return 2},TaoJia});
define("http://a.tbcdn.cn/mw/webapp/fav/module/favlistDel.js",["zepto","../../../../base/utils/tip/tip","./server/fav_url","../../../../base/utils/server/h5_common","../../../../base/utils/server/mtop_ajax"],function(require,exports,module){var $=require("zepto"),tip=require("../../../../base/utils/tip/tip"),favUrl=require("./server/fav_url"),favComm=require("../../../../base/utils/server/h5_common"),mtopAjax=require("../../../../base/utils/server/mtop_ajax");return{op:{hideCls:"none",extraEl:".operate",extra:null},setClearExOps:function(opt){var that=this;$.extend(that.op,opt)},init:function(str){if(!str)return null;var that=this;document.getElementById(str).onclick=function(ev){that.extra.call(that,ev)}},extra:function(e){var that=this,op=that.op,tempobj=e.target,tag=tempobj.tagName.toLowerCase();if(tag!="span"||!$(tempobj).hasClass("btn-grey-small"))return;delBton=$(tempobj).hasClass(op.extraEl)?tempobj:tempobj.parentNode,li=delBton.parentNode,parent=li.parentNode,method=op.type&&op.type=="shop"?"delColShop":"delColGood",params={method:method,id:li.getAttribute("itemid")},url=function(){return favUrl.getUrl("api",params)},$(delBton).addClass(op.hideCls),mtopAjax.get(url(),params,function(res){favComm.dealResponse(res,function(res){$(li).css({overflow:"hidden"}),$(li).animate({opacity:0},300,"ease-out",function(){$(li).animate({height:0},300,"ease-out",function(){this.innerHTML="",this.parentNode.removeChild(this),parent.children[0]?op.scrollObj.refresh():op.postdata&&op.postdata()})})},function(err){tip({title:err}),$(delBton).css({width:60}).removeClass(op.hideCls)},"fav")},function(err){tip({title:"系统错误"}),$(delBton).css({width:60}).removeClass(op.hideCls)})}}});
define("http://a.tbcdn.cn/base/utils/tip/tip.js",["zepto"],function(require,exports,module){var $=require("zepto");return $.tips=function(options){this.op={dir:"center",anitime:500,timeout:1e3,isShow:!0},typeof options=="string"?this.op.title=options:$.extend(this.op,options);var tips=document.createElement("div");tips.id="tips",tips.style.cssText="background-color:#000;-webkit-border-radius:6px;-webkit-box-shadow:0 0 2px #000;color:#fff;padding:8px 10px;line-height:18px;display:inline-block;position:absolute;opacity:0;z-index:10;";switch(this.op.dir){case"bottom":tips.style.bottom="20px";break;case"top":tips.style.top="20px";break;default:tips.style.top="50%"}document.body.appendChild(tips),this._tips=$(tips),this.op.isShow&&this.show()},$.extend($.tips.prototype,{show:function(){var that=this,op=that.op,tips=that._tips;tips.html(op.title);var maxWidth=$(window).width()-60,maxHeight=$(window).height()-60,objWidth=tips.width(),objHeight=tips.height();objWidth>maxWidth&&(objWidth=maxWidth,tips.css("width",objWidth-20)),objHeight>maxHeight&&(objHeight=maxHeight,tips.css("height",objHeight-20)),tips.css({left:"50%",marginLeft:-Math.floor(objWidth/2),marginTop:-Math.floor(objHeight/2)}),tips.animate({opacity:.8},op.anitime,"ease-in",function(){tips.timer=setTimeout(function(){that.hide()},op.timeout)})},hide:function(){var that=this,tips=that._tips;clearInterval(tips.timer),tips.timer=null,tips.animate({opacity:0},that.op.anitime,"ease-out",function(){tips.empty(),tips.remove()})}}),$.tip=function(options){return new $.tips(options)},$.tip});
define("http://a.tbcdn.cn/mw/webapp/fav/module/_slider.js",["../../../../base/modules/slider/slider"],function(require,exports,module){var slider=require("../../../../base/modules/slider/slider");return slider});
define("http://a.tbcdn.cn/base/modules/slider/slider.js",["zepto"],function(require,exports,module){var $=require("zepto");return $.touchSlider=function(options,container){this.op={container:".slider",wrap:".slider-outer",wrapUl:".slider-wrap",wrapStatus:".slider-status",margin:0,cls:"sel",prev:null,next:null,lazy:"dataimg",anitime:500,easeing:"ease",isLoop:!1,isPlay:!1,bounce:!0,inter:5e3},container&&(this.op.container=container),$.extend(this.op,options);if($(this.op.container).length==0)return null;this.init()},$.extend($.touchSlider.prototype,{init:function(){var op=this.op;this._container=$(op.container),this._prev=op.prev&&this._container.find(op.prev)[0],this._next=op.prev&&this._container.find(op.next)[0],this._wrap=this._container.find(op.wrap);if(this._wrap.length==0)return null;var wul=this._wul=this._container.find(op.wrapUl);if(wul.length==0)return null;var childs=this._childs=wul.children();if(childs.length==0)return null;var step=this._step=this._wrap.width(),len=this._len=childs.length;this._wrapStatus=this._container.find(op.wrapStatus),this._cls=op.cls;var single=childs[0].offsetWidth,margin=op.margin,status=this._status=Math.floor(this._step/single),allWidth=single*this._len;if(status<1)return null;status>1&&(op.isLoop=!1),op.isLoop&&(allWidth=single*(len+2),this.op.bounce=!0),margin&&typeof margin=="number"&&(allWidth+=(this._len-1)*margin,this._step+=margin);var pages=this._pages=Math.ceil(len/status);if(this._wrapStatus.length>0){var temp="",childstu=this._wrapStatus.children();if(childstu.length==0){for(var i=0;i<pages;i++)temp+="<span"+(i==0?" class="+this._cls+"":"")+"></span>";this._wrapStatus.html(temp)}}this.getImg();if(pages<=1)return this._prev&&(this._prev.style.display="none"),this._next&&(this._next.style.display="none"),this._wrapStatus.hide(),null;wul.css("width",allWidth),op.isLoop&&($(childs[0].cloneNode(!0)).appendTo(wul),$(childs[len-1].cloneNode(!0)).css({position:"relative",left:-step*(len+2)}).appendTo(wul),this._childs=wul.children());var isTouch=this.isTouch="ontouchstart"in window;this._touchstart="ontouchstart",this._touchmove="ontouchmove",this._touchend="ontouchend",isTouch||(this._touchstart="onmousedown",this._touchmove="onmousemove",this._touchend="onmouseup"),this.eventInit()},eventInit:function(){var that=this;that._coord={},that._moveCoord={},that._cmax=0,that._cmin=-(that._pages-1)*that._step,that._left=0,that._current=0,that._wrapStatus.length>0&&(that._statusChild=that._wrapStatus.children(),that._selChild=that._statusChild[that._current]),that._minpage=0,that._maxpage=that._pages-1,that._isScroll=!1,that._movestart=!1,that._playTimer=null,that._start=that._bindself(that.start,that),that._move=that._bindself(that.move,that),that._end=that._bindself(that.end,that),that.increaseEvent()},getImg:function(n){var that=this,loop=that.op.isLoop,lazy=that.op.lazy,status=that._status,childs=that._childs,len=childs.length,m=n&&parseInt(n,10)||0,imgarr,selector="img["+lazy+"]";if(!lazy)return;if(m<0)imgarr=$(childs[len+m]).find(selector).add($(childs[len+m-2]).find(selector));else if(status>1){var start=m*status;imgarr=$(childs[start]).find(selector);if(start<len-1){var alen=Math.min((m+1)*status,len);for(var i=start+1;i<alen;i++)imgarr=imgarr.add($(childs[i]).find(selector))}}else imgarr=$(childs[m]).find(selector);if(imgarr.length==0)return;var src,nobj;imgarr.each(function(n,item){nobj=$(item),src=nobj.attr(lazy),src&&(nobj.attr("src",src),nobj.removeAttr(lazy))})},getXY:function(e){var touchs=e.changedTouches?e.changedTouches[0]:e;return{x:touchs.clientX,y:touchs.clientY}},start:function(e){var that=this;if(that._isScroll)return;that.stop(),that._coord=that.getXY(e),that._wrap[0][that._touchmove]=that._move,that.isTouch?that._wrap[0][that._touchend]=that._end:document[that._touchend]=that._end},move:function(e){var that=this;that._moveCoord=that.getXY(e);var newdisx=that._moveCoord.x-that._coord.x,newdisy=that._moveCoord.y-that._coord.y,current=0,_current=that._current;if(Math.abs(newdisx)>Math.abs(newdisy)){that._left=-_current*that._step+newdisx;if(that.op.bounce||that._left>=that._cmin&&that._left<=that._cmax)current=newdisx>0&&_current-1||_current+1,that.getImg(current),that._wul.css("left",that._left);that._movestart=!0,e.preventDefault()}},end:function(e){var that=this;if(that._movestart){e.preventDefault();var distance=that.getXY(e).x-that._coord.x;distance<-10?that.next():distance>10&&that.prev(),that._movestart=!1}else that.begin();that._wrap[0][that._touchmove]=null,that.isTouch?that._wrap[0][that._touchend]=null:document[that._touchend]=null,that._coord={},that._moveCoord={},distance=null},prev:function(e){e&&e.preventDefault&&e.preventDefault();var that=this;that._current-=1,that._current<that._minpage&&(that.op.isLoop?that._current=that._minpage-1:that._current=that._minpage),this.touchf()},next:function(e){e&&e.preventDefault&&e.preventDefault();var that=this;that._current+=1,that._current>that._maxpage&&(that.op.isLoop?that._current=that._maxpage+1:that._current=that._maxpage),that.touchf()},touchf:function(str){var that=this,op=that.op,leftt=parseInt(this._wul.css("left"),10),leftend=-that._current*that._step;that._isScroll=!0,that.stop(),leftt=leftt||0,leftt==leftend?that._isScroll=!1:(that.getImg(that._current),that._wul.animate({left:-that._current*that._step},op.anitime,op.easeing,function(){op.isLoop&&(that._current>=that._maxpage+1?that._current=0:that._current<=that._minpage-1&&(that._current=that._maxpage),$(this).css("left",-that._current*that._step)),that.update(),!op.isLoop&&that._current==that._maxpage?that.op.isPlay=!1:that.begin(),that._isScroll=!1,that._prev&&that._next&&that.updateArrow()}))},update:function(){var that=this;that._statusChild&&that._selChild&&($(that._selChild).removeClass(that._cls),$(that._statusChild[that._current]).addClass(that._cls),that._selChild=that._statusChild[that._current])},updateArrow:function(){var that=this;if(!that._prev&&!that._next)return;if(that.op.isLoop)return;that._current<=0?$(that._prev).addClass("none"):$(that._prev).removeClass("none"),that._current>=that._maxpage?$(that._next).addClass("none"):$(that._next).removeClass("none")},_bindself:function(func,that){return function(e){func.call(that,e)}},begin:function(){var that=this,op=that.op;op.isPlay&&(that.stop(),that._playTimer=setInterval(function(){that.next()},op.inter))},stop:function(){var that=this,op=that.op;op.isPlay&&that._playTimer&&(clearInterval(that._playTimer),that._playTimer=null)},increaseEvent:function(){var that=this,op=that.op;that._wrap[0][that._touchstart]=that._start,op.isPlay&&that.begin(),that._prev&&(that._prev.onclick=function(e){that.prev.call(that,e)}),that._next&&(that._next.onclick=function(e){that.next.call(that,e)}),that._prev&&that._next&&that.updateArrow()},destroy:function(){var that=this;that._container[0].removeAttribute("isLoad");if(that._pages<=1)return;that._wrap[0][this._touchstart]=null,that._prev&&(that._prev.onclick=null),that._next&&(that._next.onclick=null)}}),$.touchSlider.cache=[],$.fn.slider=function(options){return this.each(function(n,item){item.getAttribute("isLoad")||(item.setAttribute("isLoad",!0),$.touchSlider.cache.push(new $.touchSlider(options,item)))})},$.touchSlider.destroy=function(){var cache=$.touchSlider.cache,len=cache.length;if(len<1)return;for(var i=0;i<len;i++)cache[i].destroy();$.touchSlider.cache=[]},$.touchSlider});
define("http://a.tbcdn.cn/mw/webapp/fav/view/goodslistViewMu.js",[],'{{#data}}{{#result}}{{#resultList}}<li class="list-item {{#if(status==0)}} hasdel {{/if(status==0)}}" itemid="{{numId}}"><a href="{{itemhref}}" class="list-scrolla"><div class="p"><img src="{{imghref}}"  alt="商品图片" /></div><div class="d"><h5 class="d-title{{#if(status==0)}} silver {{/if(status==0)}}">{{title}}</h5>{{#if(status==1)}}<p class="d-price">{{^isPromot}}<em class="h">&yen;{{price}}</em>{{/isPromot}}{{#isPromot}}<em class="h">&yen;{{promotionPrice}}</em> <del class="silver">{{price}}</del>{{/isPromot}}</p>{{#isPromot}}<p class="d-sp silver">[限时打折]</p>{{/isPromot}}{{/if(status==1)}}{{#if(status==0)}} <p>已下架</p> {{/if(status==0)}}</div></a><div class="operate{{#if(status==1)}} none {{/if(status==1)}}"><span class="btn-grey-small">删 除</span></div></li>{{/resultList}}{{/result}}{{/data}}');
define("http://a.tbcdn.cn/mw/webapp/fav/view/shoplistView.js",["zepto","mu","backbone","../module/help","../model/shoplistModel","../module/server/fav_url","../module/favScroll.js","../module/_rank","../model/paramModel","../module/_slider","../../../../base/modules/message/error","./shoplistViewMu"],function(require,exports,module){var $=require("zepto"),Mustache=require("mu"),Backbone=require("backbone"),help=require("../module/help"),shoplistModel=require("../model/shoplistModel"),fav_url=require("../module/server/fav_url"),favScroll=require("../module/favScroll.js"),rank=require("../module/_rank"),paramModel=require("../model/paramModel"),slider=require("../module/_slider"),err=require("../../../../base/modules/message/error"),VIEW={};return VIEW.shoplistViewClass=Backbone.View.extend({model:shoplistModel.Instance,template:require("./shoplistViewMu"),el:"#content",events:{},initialize:function(){var self=this;self.model.bind("change:t",function(){var s=self.setHref(self.model.get("resultlist"));self.renderShopListView(s)})},setHref:function(s){var list=s.data.result.resultList,length=list.length;if(length>0)for(var i=0;i<length;i++){list[i].shophref=fav_url.getUrl("shop",{shop_id:list[i].numId}),list[i].imghref=fav_url.getImgUrl(list[i].img,40),list[i].rank=="0"?list[i].isRank=!1:(list[i].rankimg=rank.seller(list[i].rank),list[i].isRank=!0),list[i].isNewGoods=list[i].newGoddsCount=="0"?!1:!0,list[i].isMall=list[i].mall=="false"?!1:!0;if(list[i].isNewGoods){var newLength=list[i].newGoods.length;newLength=newLength>6?6:newLength;for(var j=0;j<newLength;j++)list[i].newGoods[j].newImghref=list[i].newGoods[j].pic+"_70x70.jpg",list[i].newGoods[j].newhref=fav_url.getItemUrl(list[i].newGoods[j].itemId,list[i].isMall);newLength==6&&(list[i].newGoods[5].newImghref="http://img01.taobaocdn.com/tps/i1/T1.0y8XnpmXXXXXXXX-68-68.png",list[i].newGoods[5].newhref=fav_url.getUrl("shop_search",{suid:list[i].ownerId,sort:"oldstarts"}))}}else{var currentpage=s.data.result.currentPage;if(parseInt(currentpage)<=1)return!1}return s},renderShopListView:function(s){var selfTemp=this.template,container=$("#content"),childContainer=$("#content .list-shop"),pageCurrent=paramModel.Instance.get("param").currentPage;if(childContainer.length==0){container.html("");var el=this.make("div",{"class":"list-content"},'<div class="list-shop"></div>');container.html(el)}return selfTemp==""&&(selfTemp=help.template(module.fileattr()[0],module.fileattr()[1]),this.template=selfTemp),s?selfTemp.charAt(0)!="!"?pageCurrent==1?$("#content .list-shop").html(Mustache.to_html(selfTemp,s)):$("#content .list-shop").append(Mustache.to_html(selfTemp,s)):container.html(selfTemp.substring(1)):err.blank(),$(".slider").slider({margin:10,prev:".prev",next:".next"}),favScroll.refresh(),this}}),VIEW.Instance=new VIEW.shoplistViewClass,VIEW});
define("http://a.tbcdn.cn/mw/webapp/fav/module/_rank.js",["../../../../base/modules/rank/rank"],function(require,exports,module){var rank=require("../../../../base/modules/rank/rank");return rank});
define("http://a.tbcdn.cn/base/modules/rank/rank.js",["zepto","../../utils/server/h5_common"],function(require,exports,module){var $=require("zepto"),common=require("../../utils/server/h5_common"),_rank=function(data,role){var rankCode="",arr="",grade="",num="",img="";return rankCode=common.userLevel(data),rankCode==""?!1:(arr=rankCode.split(""),grade=arr[0],num=arr[1],img=_pack(role,grade,num),img)},_pack=function(role,grade,num){var host="http://a.tbcdn.cn/mw/base/modules/rank/",url="";return url="img/"+role+"_"+grade+"_"+num+".gif",url=host+url,url},rank={};return rank.buyer=function(data){return _rank(data,"c")},rank.seller=function(data){return _rank(data,"b")},rank});
define("http://a.tbcdn.cn/mw/webapp/fav/view/shoplistViewMu.js",[],'{{#data}}{{#result}}{{#resultList}}<li class="list-item" itemid="{{numId}}"><a href="{{shophref}}" title="" class="list-scrolla"><div class="p"><img src="{{imghref}}" alt="店铺图片" class="p-pic" /></div><div class="d"><h5 class="d-title">{{title}}</h5>{{#if(mall==true)}}<p class="d-icon"><img src="http://a.tbcdn.cn/mw/s/hi/tbtouch/icons/trade/mall.png" alt="图标" /></p>{{/if(mall==true)}}{{#if(mall==false)}}{{#if(isRank==true)}}<p class="d-icon"><img src="{{rankimg}}" alt="信用图标" /></p>{{/if(isRank==true)}}{{#if(isRank==false)}}<p class="d-icon silver">[暂无信用]</p>{{/if(isRank==false)}}{{/if(mall==false)}}{{#promotion}}<p class="d-sp">{{desc}}</p>{{/promotion}}</div></a><div class="operate none"><span class="btn-grey-small">删 除</span></div>{{#isNewGoods}}<section class="newlist slider"><p class="d-new">新上宝贝({{newGoddsCount}})</p><div class="slider-outer"><ul class="slider-wrap">{{#newGoods}}<li><a href="{{newhref}}"><img src="{{newImghref}}" alt="新品图片" /></a></li>{{/newGoods}}</ul></div><div class="prev"></div><div class="next"></div></section>{{/isNewGoods}}</li>{{/resultList}}{{/result}}{{/data}}');
define("http://a.tbcdn.cn/mw/webapp/fav/view/paramView.js",["zepto","mu","backbone","../module/help","../model/paramModel","../model/subparamModel","../model/goodslistModel","../model/shoplistModel","../module/favSwipetop","../module/favScroll.js","../module/server/fav_url","./paramViewMu"],function(require,exports,module){var $=require("zepto"),Mustache=require("mu"),Backbone=require("backbone"),help=require("../module/help"),paramModel=require("../model/paramModel"),subparamModel=require("../model/subparamModel"),goodslistModel=require("../model/goodslistModel"),shoplistModel=require("../model/shoplistModel"),swipeTopSingle=require("../module/favSwipetop"),favScroll=require("../module/favScroll.js"),favUrl=require("../module/server/fav_url"),VIEW={};return VIEW.paramViewClass=Backbone.View.extend({model:paramModel.Instance,template:require("./paramViewMu"),el:"#header",events:{"click #header .fav-nav ul li a":"mcur","click #J_favCategory":"catagoryShow","click #J_favMytaobao":"toMytaobao"},initialize:function(){var self=this;self.model.bind("change:nav",function(model,s){self.renderMain()},self),self.model.bind("change:param",function(model,s){console.log("paramModel 已经更改 前：",self.model.previousAttributes(),"新增内容：",self.model.changedAttributes()),self.model.getListData()},self)},mcur:function(e){var self=this;this.tab(e,function(selfTarget,self){selfTarget.text()=="宝贝收藏"?self.model.set({nav:"goods"}):self.model.set({nav:"shop"})})},tab:function(e,callback){var self=this,selfTarget=$(e.target).parent();selfTarget.hasClass("cur")?console.log("什么都不做"):(selfTarget.addClass("cur"),selfTarget.siblings().removeClass("cur"),typeof callback=="function"&&callback)},catagoryShow:function(e){e.preventDefault(),swipeTopSingle.showTop()},toMytaobao:function(e){e.preventDefault(),window.location.href=favUrl.getCommUrl().my},cat:function(){},renderMain:function(){var selfTemp=this.template,container=$("#header");selfTemp==""&&(selfTemp=help.template(module.fileattr()[0],module.fileattr()[1]),this.template=selfTemp);if(selfTemp.charAt(0)!="!"){var data={nav:this.model.get("nav"),myTaobao:this.model.get("myTaobao")};console.log("data",data),container.html(Mustache.to_html(selfTemp,data))}else container.html(selfTemp.substring(1));return this}}),VIEW.Instance=new VIEW.paramViewClass,VIEW});
define("http://a.tbcdn.cn/mw/webapp/fav/model/subparamModel.js",["backbone"],function(require,exports,module){var Backbone=require("backbone"),MODEL={};return MODEL.subparamModelClass=Backbone.Model.extend({}),MODEL.Instance=new MODEL.subparamModelClass,MODEL});
define("http://a.tbcdn.cn/mw/webapp/fav/view/paramViewMu.js",[],'<div class="c-inav"><section><button class="back"><span><em></em></span><a href="{{myTaobao}}">我的淘宝</a></button></section><section><button class="main"><a class="{{#if(nav==goods)}}highlight{{/if(nav==goods)}}"  href="#!goods/queryColGood-1" title="">宝贝收藏</a><a class="{{#if(nav==shop)}}highlight{{/if(nav==shop)}}" href="#!shop/queryColShop-1" title="">店铺收藏</a></button></section><section><button id="J_favCategory" class="other"><nav>分类</nav></button></section></div>');
define("http://a.tbcdn.cn/mw/webapp/fav/view/subparamView.js",["zepto","mu","backbone","../module/help","../model/subparamModel","./subparamViewMu"],function(require,exports,module){var $=require("zepto"),Mustache=require("mu"),Backbone=require("backbone"),help=require("../module/help"),subparamModel=require("../model/subparamModel"),VIEW={};return VIEW.subparamViewClass=Backbone.View.extend({model:subparamModel.Instance,template:require("./subparamViewMu"),el:"#J_SubParam",events:{"click #J_SubParam ul li a":"scur"},initialize:function(){var self=this;console.log("subparamView 初始化"),self.model.bind("change:subparam",function(){self.renderSubparamView(self.model.get("subparam"))})},scur:function(e){},renderSubparamView:function(s){var selfTemp=this.template,container=$("#J_SubParam");return selfTemp==""&&(selfTemp=help.template(module.fileattr()[0],module.fileattr()[1]),this.template=selfTemp),selfTemp.charAt(0)!="!"?container.html(Mustache.to_html(selfTemp,s)):container.html(selfTemp.substring(1)),this}}),VIEW.Instance=new VIEW.subparamViewClass,VIEW});
define("http://a.tbcdn.cn/mw/webapp/fav/view/subparamViewMu.js",[],'{{#if(nav==goods)}}<ul class="tab-2"><li {{#if(method==queryColGood)}} class="cur" {{/if(method==queryColGood)}}><a href="#!goods/queryColGood{{href}}" title="">全部</a></li><li {{#if(method==queryColPromoGood)}} class="cur" {{/if(method==queryColPromoGood)}}><a href="#!goods/queryColPromoGood{{href}}" title="">促销</a></li></ul>{{/if(nav==goods)}}{{#if(nav==shop)}}<ul class="tab-3"><li {{#if(method==queryColShop)}} class="cur" {{/if(method==queryColShop)}}><a href="#!shop/queryColShop{{href}}" title="">全部</a></li><li {{#if(method==queryColNewGoodShop)}}class="cur"{{/if(method==queryColNewGoodShop)}}><a href="#!shop/queryColNewGoodShop{{href}}" title="">新品</a></li><li {{#if(method==queryColActShop)}}class="cur"{{/if(method==queryColActShop)}}><a href="#!shop/queryColActShop{{href}}" title="">促销</a></li></ul>{{/if(nav==shop)}}');
define("http://a.tbcdn.cn/mw/webapp/fav/module/initialize.js",["../../../../base/modules/overturn/overturn","../../../../base/modules/taojia/taoplus","../../../../base/utils/server/h5_base","../../../../base/utils/server/mtop_ajax","../module/favSwipetop","./favScroll","./favlistDel","./lazyload","./server/fav_url","./_footer"],function(require,exports,module){var overturn=require("../../../../base/modules/overturn/overturn"),taoplus=require("../../../../base/modules/taojia/taoplus"),tbh5=require("../../../../base/utils/server/h5_base"),mtopAjax=require("../../../../base/utils/server/mtop_ajax"),swipeTopSingle=require("../module/favSwipetop"),favScroll=require("./favScroll"),listDel=require("./favlistDel"),lazyload=require("./lazyload"),fav_url=require("./server/fav_url"),footer=require("./_footer"),init=function(){var urls=fav_url.getCommUrl(),_ios=tbh5.getUserProFromStorage("platform")=="ios"?!0:!1;overturn.init(),swipeTopSingle.setOp("taojia",taoplus),taoplus.initialize({onShow:function(){swipeTopSingle.tapDown()},onHide:function(){swipeTopSingle.tapDown()}}),window.addEventListener("touchmove",function(e){e.preventDefault()},!1),footer.init(urls,favScroll),listDel.init("content"),setTimeout(scrollTo,0,0,1)};return init});
define("http://a.tbcdn.cn/base/modules/overturn/overturn.js",["zepto","../../utils/orient/orient"],function(require,exports,module){var $=require("zepto"),orient=require("../../utils/orient/orient"),_init=function(){orient.landscape(function(){$("body").addClass("landscape"),$("#J_Sub").show(),$("#J_Sub").animate({opacity:1},1e3)}),orient.portrait(function(){$("#J_Sub").animate({opacity:0},1e3,function(){$("#J_Sub").hide(),$("body").removeClass("landscape")})});var currentOrient=orient.get();currentOrient&&currentOrient!=0&&currentOrient!=180?$("body").addClass("landscape"):$("body").removeClass("landscape")},overturn={};return overturn.init=function(){_init()},overturn});
define("http://a.tbcdn.cn/base/utils/orient/orient.js",[],function(require,exports,module){var orientationEvent="onorientationchange"in window?"orientationchange":"resize",currentOrientation=window.orientation,_onHandle=function(angle,callback){window.addEventListener(orientationEvent,function(){_switcher(angle,callback)},!1)},_switcher=function(angle,callback){var orientation=window.orientation;if(angle=="landscape"){(orientation==90||orientation==-90)&&callback();return}if(angle=="portrait"){(orientation==0||orientation==180)&&callback();return}},orient={};return orient.landscape=function(callback){_onHandle("landscape",callback)},orient.portrait=function(callback){_onHandle("portrait",callback)},orient.get=function(){return window.orientation},orient});
define("http://a.tbcdn.cn/base/modules/taojia/taoplus.js",["zepto"],function(require,exports,module){var $=require("zepto"),TaoJia={initialize:function(opt){if($("body").attr("notshow"))return!1;var that=this,timer=null;that._opt=opt;var _environment={init:function(){var _checkSysType="m";return window.location.host=="localhost"||window.location.host.match(".*\\.waptest\\.(taobao|tmall|etao|alibaba|alipay|aliyun)\\.com.*")?_checkSysType="waptest":window.location.host.match(".*\\.wapa\\.(taobao|tmall|etao|alibaba|alipay|aliyun)\\.com.*")&&(_checkSysType="wapa"),_checkSysType}};window.navigator.userAgent.indexOf("Chrome")!=-1&&$("body > div").addClass("chrome");var dom={_css:function(){window.navigator.userAgent.indexOf("UC")!=-1?$("head").append('<link rel="stylesheet" type="text/css" href="http://a.tbcdn.cn/mw/base/styles/component/taoplus/css/taoplus_uc.css" />'):$("head").append('<link rel="stylesheet" type="text/css" href="http://a.tbcdn.cn/mw/base/styles/component/taoplus/css/taoplus.css" />')},_generate:function(){var _checkSysType=_environment.init(),urls={};urls.s="http://s."+_checkSysType+".taobao.com/search.htm",urls.cart="http://cart."+_checkSysType+".taobao.com/my_cart.htm",urls.my="http://my."+_checkSysType+".taobao.com/my_taobao.htm",urls.im="http://im."+_checkSysType+".taobao.com/ww/ad_ww_lately_contacts.htm",urls.home_wuliu="http://tm."+_checkSysType+".taobao.com/order_list.htm?statusId=5",urls.home="http://"+_checkSysType+".taobao.com";var div='<div class="taoplus" id="J_Taojia"><div class="taoplus-btn on" data-time="0"><div class="taoplus-btn-iconbox"><ul><li>t</li><li id="J_btnmsg">w</li><li>t</li></ul></div></div><div class="taoplus-main" data-total="" data-totalNew="" ><div class="circlbg"><span>o</span></div><ul class="icons"><li class="search"><a data-url="'+urls.s+'">s</a><span class="bg"><span>p</span></span></li><li class="car"><a data-url="'+urls.cart+'">u</a><span class="bg"><span>p</span></span></li><li class="individ"><a data-url="'+urls.my+'">r</a><span class="bg">p</span></li><li class="ww"><a data-url="'+urls.im+'">w</a><span class="bg">p</span></li><li class="logis"><a data-url="'+urls.home_wuliu+'">q</a><span class="bg">p</span></li><li class="more"><a data-url="'+urls.home+'">ooo</a><span class="bg">p</span></li></ul><div class="biglogo"><a data-url="http://m.taobao.com">x</a><span class="biglogobg"></span></div></div></div>';$("body > div").append(div)}};dom._css(),dom._generate();var init={btn:$("#J_Taojia .taoplus-btn"),main:$("#J_Taojia .taoplus-main"),_browser:function(){var ua=navigator.userAgent,filter=["iPhone OS ","Android "],platform={iphone:!1,adnroid:!1},version="",vArray=[];for(var i=0;i<filter.length;i++){var index=ua.indexOf(filter[i]);if(index>-1){switch(i){case 0:platform.iphone=!0;break;case 1:platform.adnroid=!0}var len=filter[i].length;version=ua.substr(index+len,6),vArray=version.split(/_|\./)}}return{iphone:platform.iphone,android:platform.adnroid,version:vArray}}(),_slide:function(){function Scroll(event){init.btn.css({opacity:"1","-webkit-transition":"opacity 3s linear "})}function touchMove(event){init.btn.css({opacity:"0",top:window.innerHeight+window.scrollY-80+"px","-webkit-transition":"none"})}init._browser.iphone&&$("body > div").addClass("ios");if(init._browser.iphone&&Number(init._browser.version[0]+"."+init._browser.version[1])<5||init._browser.android&&Number(init._browser.version[0]+"."+init._browser.version[1])<=2.1)window.addEventListener("scroll",Scroll,!1),document.addEventListener("touchmove",touchMove,!1)},_maintop:function(){function mainTop(){init.main.css({top:window.innerHeight+window.scrollY-230})}mainTop(),$(window).bind("scroll touchend resize",function(){mainTop()})},_msg:function(){function getwwmsg(){$("#J_btnmsg")[0].className="wwaction",$("#J_btnmsg").html("w"),$("#J_Taojia").find(".taoplus-btn-iconbox ul").addClass("btnact"),console.log("来旺旺消息了，扑通扑通扑通")}function getlogismsg(){$("#J_btnmsg")[0].className="logisaction",$("#J_btnmsg").html("q"),$("#J_Taojia").find(".taoplus-btn-iconbox ul").addClass("btnact"),console.log("来物流消息了，扑通扑通扑通")}var _checkSysType=_environment.init(),ajaxurl="http://"+_checkSysType+".taobao.com/indexHeaderAjax.htm?callback=?";$.ajax({url:ajaxurl,type:"post",dataType:"json",success:function(json){var result=json.result,totalMsgCount=json.totalMsgCount,taobaoRadioMsgCount=json.taobaoRadioMsgCount,wwMsgCout=json.wwMsgCout,logisticsMsgCount=json.logisticsMsgCount;if(result){var oDiv=$("#J_Taojia"),ww=oDiv.find(".ww a"),logis=oDiv.find(".logis a");wwMsgCout>0&&(wwMsgCout>=10?ww.append('<strong class="num">N</strong>'):ww.append('<strong class="num">'+wwMsgCout+"</strong>")),logisticsMsgCount&&(logisticsMsgCount>=10?logis.append('<strong class="num">N</strong>'):logis.append('<strong class="num">'+logisticsMsgCount+"</strong>"));var strcookie=document.cookie;if(!strcookie||strcookie.indexOf("wwmsg=")==-1)document.cookie="wwmsg=0&",document.cookie="logismsg=0&",strcookie=document.cookie;console.log(strcookie.match(/wwmsg=\d+/)[0].split("=")[1]);var wwmsg=Number(strcookie.match(/wwmsg=\d+/)[0].split("=")[1]),logismsg=Number(strcookie.match(/logismsg=\d+/)[0].split("=")[1]);wwmsg!=wwMsgCout&&logismsg==logisticsMsgCount&&(document.cookie="wwmsg="+wwMsgCout+"&",getwwmsg(),that.getmsg()),logismsg!=logisticsMsgCount&&wwmsg==wwMsgCout&&(document.cookie="logismsg="+logisticsMsgCount+"&",getlogismsg(),that.getmsg());if(logismsg!=logisticsMsgCount&&wwmsg!=wwMsgCout){var timer=null;document.cookie="logismsg="+logisticsMsgCount+"&",getlogismsg(),that.getmsg(),timer=setTimeout(function(){document.cookie="wwmsg="+wwMsgCout+"&",getwwmsg(),that.getmsg()},6e3)}}},error:function(xhr,type){console.log("网络连接失败")}})}};init._slide(),init._maintop(),init._msg(),that._switched()},getmsg:function(){var oDiv=$("#J_Taojia").find(".taoplus-btn-iconbox ul"),msg=$("#J_btnmsg"),timer=null,i=1,fn=function(){i<3?oDiv.animate({left:-i*49},500,"linear",function(){i++,window.scrollTo(1),setTimeout(fn,2e3)}):oDiv.css("left",0)};setTimeout(fn,2e3)},shopcar:function(img){var that=this,src=img,img='<div class="taoplus-goimg"><img src="'+src+'"/></div>',taojia=$("#J_Taojia"),gocar='<div class="taoplus-gocar">u</div>',timer=null;$("#J_btnmsg").html("u"),$("#J_btnmsg")[0].className="caraction",that.getmsg(),taojia.append(img,gocar),timer=setTimeout(function(){$(".taoplus-gocar").css({right:"250px",opacity:"0"})},1800),timer=setTimeout(function(){$(".taoplus-gocar").remove(),$(".taoplus-goimg").remove()},2500)},_switched:function(){var that=this,init={taojiaTouch:$("#J_Taojia").find(".taoplus-btn"),taojiaLogo:$("#J_Taojia").find(".biglogo").find("a"),taojiaIcons:$("#J_Taojia").find(".icons").find("a"),btn:function(){init.taojiaTouch.click(function(){var t=(new Date).getTime(),t2=Number($(this).attr("data-time"));t-t2>=600&&($(this).attr("data-time",t),that.st()==1?(that.circlBg(1),that._opt.onShow&&that._opt.onShow()):that.st()==2&&(that.circlBg(0),that._opt.onHide&&that._opt.onHide()))}),init.taojiaIcons.click(function(e){var self=$(this),_Href=self.attr("data-url"),name=self.attr("name");timer=setTimeout(function(){that.circlHide2(),that._opt.onIconClick&&that._opt.onIconClick(name),window.location.href=_Href},500)}),init.taojiaLogo.click(function(e){var _Href=$(this).attr("data-url");timer=setTimeout(function(){that.circlHide2(),TaoJia._opt.onLogoClick&&TaoJia._opt.onLogoClick(),window.location.href=_Href},500)})}};init.btn()},circlBg:function(st){var that=this,init={taojiaDiv:$("#J_Taojia"),taojiaTouch:$("#J_Taojia").find(".taoplus-btn"),taojiaCircle:$("#J_Taojia").find(".taoplus-main"),circlBg:$("#J_Taojia").find(".circlbg"),circlLogo:$("#J_Taojia").find(".biglogo"),taojiaLogo:$("#J_Taojia").find(".biglogo").find("a"),taojiaIcons:$("#J_Taojia").find(".icons").find("a"),taojiaIconBg:$("#J_Taojia").find(".backgrounds").find("li"),timer:null,num:0,taojiaIconShow:function(){init.taojiaTouch.removeClass("hide").addClass("on")},taojiaIconHide:function(){init.taojiaTouch.removeClass("on").addClass("hide")},circlShow:function(){timer=setTimeout(init.circlAllShow,0),timer=setTimeout(init.circlBgShow,0),timer=setTimeout(init.circlIconShow,100),timer=setTimeout(init.circlLogoShow,200)},circlHide:function(){timer=setTimeout(init.circlIconHide,0),timer=setTimeout(init.circlLogoHide,0),timer=setTimeout(init.circlBgHide,300),timer=setTimeout(init.circlAllHide,400)},circlAllShow:function(){init.taojiaCircle.addClass("show")},circlAllHide:function(){init.taojiaCircle.removeClass("show")},circlBgShow:function(){init.circlBg.addClass("show")},circlBgHide:function(){init.circlBg.removeClass("show")},circlLogoShow:function(){init.circlLogo.addClass("show")},circlLogoHide:function(){init.circlLogo.removeClass("show")},circlIconShow:function(){var timer=null,speed=25,timer=setInterval(function(){var oIconShow=$("#J_Taojia .icons").find(".show"),oLi=$("#J_Taojia .icons li"),oA=$("#J_Taojia .icons").find("a"),oBgLi=$("#J_Taojia .backgrounds li"),oLS=oIconShow.size(),oLA=oA.size();oLS<=0?($(oLi[oLA-1]).removeClass("hide").addClass("show"),$(oBgLi[oLA-1]).removeClass("o").addClass("gray"),oA.removeClass("on")):oLS>0&&oLS<oLA?($(oLi[oLA-oLS-1]).removeClass("hide").addClass("show"),$(oBgLi[oLA-oLS-1]).removeClass("o").addClass("gray"),$(oBgLi[oLA-oLS-1]).siblings("li").removeClass("gray"),oA.removeClass("on")):oLS==oLA&&(oBgLi.removeClass("gray"),clearInterval(timer))},speed)},circlIconHide:function(){var speed=25;timer=setInterval(function(){var oIconHIde=$("#J_Taojia .icons").find(".hide"),oLi=$("#J_Taojia .icons li"),oA=$("#J_Taojia .icons").find("a"),oBgLi=$("#J_Taojia .backgrounds li"),oLS=oIconHIde.size(),oLA=oA.size();oLS<=0?($(oLi[0]).removeClass("show").addClass("hide"),$(oBgLi[0]).removeClass("o").addClass("gray")):oLS>0&&oLS<oLA?($(oLi[oLS]).removeClass("show").addClass("hide"),$(oBgLi[oLS]).removeClass("o").addClass("gray"),$(oBgLi[oLS]).siblings("li").removeClass("gray")):oLS==oLA&&(oBgLi.removeClass("gray"),clearInterval(timer))},speed)},circlHide2:function(){var timer=null,speed=20;timer=setTimeout(function(){init.taojiaTouch.removeClass("hide").addClass("on"),init.taojiaCircle.find(".show").removeClass("show"),init.taojiaCircle.find(".o").removeClass("o"),init.taojiaCircle.removeClass("show")},speed)}};$($("body > div")[0]).hasClass("ios")?st==1?(init.circlShow(),init.taojiaIconHide()):st==0&&(init.circlHide(),init.taojiaIconShow()):st==1?(init.circlAllShow(),init.taojiaIconHide()):st==0&&(init.circlAllHide(),init.taojiaIconShow())},st:function(){var init={btn:$("#J_Taojia .taoplus-btn"),taojia:$("#J_Taojia"),st:function(){if(init.taojia.attr("style")=="none")return 0;if(init.btn.hasClass("on"))return 1;if(init.btn.hasClass("hide"))return 2}};return init.st()},taojiaHide:function(){$("#J_Taojia").hide(),this.circlBg(0)},taojiaShow:function(){$("#J_Taojia").show()},circlHide:function(){this.circlBg(0)},circlHide2:function(){var taojiaTouch=$("#J_Taojia").find(".taoplus-btn"),taojiaCircle=$("#J_Taojia").find(".taoplus-main"),timer=null,speed=20;timer=setTimeout(function(){taojiaTouch.removeClass("hide").addClass("on"),taojiaCircle.find(".show").removeClass("show"),taojiaCircle.find(".o").removeClass("o"),taojiaCircle.removeClass("show")},speed)}};return TaoJia});
define("http://a.tbcdn.cn/mw/webapp/fav/module/lazyload.js",["zepto"],function(require,exports,module){function inViewport(el){var top=window.pageYOffset,btm=window.pageYOffset+window.innerHeight,elTop=$(el).offset().top;return elTop>=top&&elTop<=btm}var $=require("zepto");return{start:function(){$(window).on("touchstart",function(){$("img.lazy").each(function(){var $this=$(this);if(!inViewport(this))return;var img=new Image,original=$this.data("original");img.onload=function(){$this.attr("src",original).removeClass("lazy")},original&&(img.src=original)})}).trigger("touchstart")}}});
define("http://a.tbcdn.cn/mw/webapp/fav/module/_footer.js",["../../../../base/modules/footer/footer_app"],function(require,exports,module){var footer=require("../../../../base/modules/footer/footer_app");return footer});
define("http://a.tbcdn.cn/base/modules/footer/footer_app.js",["zepto","../../utils/server/h5_base"],function(require,exports,module){var $=require("zepto"),tbh5=require("../../utils/server/h5_base"),_template="",_pack=function(urls){_template+='<section class="footer-t">',_template+='<p class="user-info ';var _isLogin=tbh5.isLogin();return _isLogin?_template+="out":_template+="in",_template+='">',_isLogin?_template+='<span><a href="'+urls.my+'">'+tbh5.getUserProFromStorage("nick")+'</a></span> <span><a href="'+urls.login_out+'">退出</a>':_template+='<span><a href="'+urls.login+'">登录</a><span><a href="'+urls.u_reg+'">注册</a></span>',_template+="</p>",_template+='<p class="gotop"><a id="J_GoTop" href="#">top<b></b></a></p>',_template+="</section>",_template+='<nav class="footer-l">',_template+='<a href="'+urls.home_midd+'" title="">标准版</a><a href="http://www.taobao.com/index.php?from=wap&sprefer=pmm302" title="">电脑版</a>',_template+="</nav>",_template+='<p class="copyright">&copy;2012 浙B2-20080224<a class="cr-sv" href="'+urls.home_kehu+'" id="J_service">客服</a></p>',_template},_init=function(urls,scrolls){var template=_pack(urls);$("#footer").html(template),$("#J_GoTop").click(function(e){e.preventDefault(),scrolls&&scrolls.scrollTo(0,0,1e3)})},footer={};return footer.init=function(urls,scrolls){_init(urls,scrolls)},footer});
define("http://a.tbcdn.cn/mw/webapp/fav/module/loadingNormal.js",["../../../../base/modules/message/loading"],function(require,exports,module){var loadingNormal=require("../../../../base/modules/message/loading");return loadingNormal});
define("http://a.tbcdn.cn/base/modules/message/loading.js",["zepto"],function(require,exports,module){var $=require("zepto"),_pack=function(ID){var template="";return template+="<div",ID&&(template+=' id="'+ID+'"'),template+=' class="common-loading normal">',template+='<p class="c-loading"><span></span></p>',template+="</div>",template},_slice=function(ID){var newID="";return newID=ID.slice(1),newID},_loadingShow=function(options){var setting={ID:"#J_LoadingNormal",template:_pack(_slice("#J_LoadingNormal")),target:""};if(options.target==""||!options.target){console.log("错误：loading组件的target未设置（必选），请检查调用");return}options&&$.extend(setting,options),options.ID&&(setting.template=_pack(_slice(setting.ID))),$(setting.target).html(setting.template)},_loadingHide=function(options){var setting={ID:"#J_LoadingNormal"};options&&$.extend(setting,options),$(setting.ID).remove()},loading={};return loading.show=function(options){_loadingShow(options)},loading.hide=function(options){_loadingHide(options)},loading});